; generated by ARM C/C++ Compiler, 5.03 [Build 24]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o.\MEDIA_USB_KEY\stm32f4xx_it.o --asm_dir=.\listing\ --list_dir=.\listing\ --depend=.\MEDIA_USB_KEY\stm32f4xx_it.d --cpu=Cortex-M4 --apcs=interwork -I.\Libraries -I.\Utilities -I.\Libraries\CMSIS\ST\STM32F4xx\Include -I.\inc -I.\src -I.\Libraries\STM32F4xx_StdPeriph_Driver -I.\Libraries\STM32_USB_HOST_Library -I.\Libraries\STM32_USB_OTG_Driver -I.\Utilities\STM32F4-Discovery -I.\Libraries\CMSIS -I.\Utilities\Third_Party\fat_fs -IC:\Keil4\ARM\RV31\INC -IC:\Keil4\ARM\CMSIS\Include -IC:\Keil4\ARM\Inc\ST\STM32F4xx -D__MICROLIB -DUSE_STDPERIPH_DRIVER -DUSE_USB_OTG_FS -DSTM32F4XX -DMEDIA_USB_KEY -D__FPU_PRESENT=0 --omf_browse=.\MEDIA_USB_KEY\stm32f4xx_it.crf src\stm32f4xx_it.c]
                          THUMB

                          AREA ||i.BusFault_Handler||, CODE, READONLY, ALIGN=1

                  BusFault_Handler PROC
                  |L1.0|
;;;137      */
;;;138    void BusFault_Handler(void)
000000  e7fe              B        |L1.0|
;;;139    {
;;;140      /* Go to infinite loop when Bus Fault exception occurs */
;;;141      while (1)
;;;142      {
;;;143      }
;;;144    }
;;;145    
                          ENDP


                          AREA ||i.DebugMon_Handler||, CODE, READONLY, ALIGN=1

                  DebugMon_Handler PROC
;;;172      */
;;;173    void DebugMon_Handler(void)
000000  4770              BX       lr
;;;174    {
;;;175    }
;;;176    
                          ENDP


                          AREA ||i.EXTI0_IRQHandler||, CODE, READONLY, ALIGN=2

                  EXTI0_IRQHandler PROC
;;;1152     */
;;;1153   void EXTI0_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1154   {
;;;1155     /* Checks whether the User Button EXTI line is asserted*/
;;;1156     if (EXTI_GetITStatus(EXTI_Line0) != RESET) 
000002  2001              MOVS     r0,#1
000004  f7fffffe          BL       EXTI_GetITStatus
000008  b158              CBZ      r0,|L3.34|
;;;1157     { 
;;;1158       if (Command_index == 1)
00000a  4808              LDR      r0,|L3.44|
00000c  7803              LDRB     r3,[r0,#0]  ; Command_index
00000e  2100              MOVS     r1,#0
;;;1159       {
;;;1160         RepeatState = 0;
000010  4a07              LDR      r2,|L3.48|
000012  2b01              CMP      r3,#1                 ;1158
000014  d001              BEQ      |L3.26|
;;;1161         /* Switch to play command */
;;;1162         Command_index = 0;
;;;1163       }
;;;1164       else if (Command_index == 0)
000016  7803              LDRB     r3,[r0,#0]  ; Command_index
000018  b10b              CBZ      r3,|L3.30|
                  |L3.26|
00001a  7011              STRB     r1,[r2,#0]            ;1160
00001c  e000              B        |L3.32|
                  |L3.30|
;;;1165       {
;;;1166         /* Switch to record command */
;;;1167         Command_index = 1;
00001e  2101              MOVS     r1,#1
                  |L3.32|
000020  7001              STRB     r1,[r0,#0]
                  |L3.34|
;;;1168     //    XferCplt = 1;
;;;1169     //    EVAL_AUDIO_Stop(CODEC_PDWN_SW);
;;;1170       }
;;;1171       else
;;;1172       {
;;;1173         RepeatState = 0;
;;;1174         /* Switch to play command */
;;;1175         Command_index = 0; 
;;;1176       }
;;;1177     } 
;;;1178     /* Clears the EXTI's line pending bit.*/ 
;;;1179     EXTI_ClearITPendingBit(EXTI_Line0);
000022  e8bd4010          POP      {r4,lr}
000026  2001              MOVS     r0,#1
000028  f7ffbffe          B.W      EXTI_ClearITPendingBit
;;;1180   }
;;;1181   
                          ENDP

                  |L3.44|
                          DCD      Command_index
                  |L3.48|
                          DCD      RepeatState

                          AREA ||i.EXTI1_IRQHandler||, CODE, READONLY, ALIGN=2

                  EXTI1_IRQHandler PROC
;;;1068     */
;;;1069   void EXTI1_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1070   {
;;;1071     /* Check the clic on the accelerometer to Pause/Resume Playing */
;;;1072     if(EXTI_GetITStatus(EXTI_Line1) != RESET)
000002  2002              MOVS     r0,#2
000004  f7fffffe          BL       EXTI_GetITStatus
000008  2800              CMP      r0,#0
00000a  d00f              BEQ      |L4.44|
;;;1073     {
;;;1074       if( Count==1)
00000c  4808              LDR      r0,|L4.48|
00000e  7883              LDRB     r3,[r0,#2]  ; Count
000010  2200              MOVS     r2,#0
;;;1075       {
;;;1076         PauseResumeStatus = 1;
000012  2101              MOVS     r1,#1
000014  2b01              CMP      r3,#1                 ;1074
000016  d006              BEQ      |L4.38|
;;;1077         Count = 0;
;;;1078       }
;;;1079       else
;;;1080       {
;;;1081         PauseResumeStatus = 0;
000018  7042              STRB     r2,[r0,#1]
;;;1082         Count = 1;
00001a  7081              STRB     r1,[r0,#2]
                  |L4.28|
;;;1083       }
;;;1084       /* Clear the EXTI line 1 pending bit */
;;;1085       EXTI_ClearITPendingBit(EXTI_Line1);
00001c  e8bd4010          POP      {r4,lr}
000020  2002              MOVS     r0,#2
000022  f7ffbffe          B.W      EXTI_ClearITPendingBit
                  |L4.38|
000026  7041              STRB     r1,[r0,#1]            ;1076
000028  7082              STRB     r2,[r0,#2]            ;1077
00002a  e7f7              B        |L4.28|
                  |L4.44|
;;;1086     }
;;;1087   }
00002c  bd10              POP      {r4,pc}
;;;1088   
                          ENDP

00002e  0000              DCW      0x0000
                  |L4.48|
                          DCD      ||.data||

                          AREA ||i.HardFault_Handler||, CODE, READONLY, ALIGN=1

                  HardFault_Handler PROC
                  |L5.0|
;;;111      */
;;;112    void HardFault_Handler(void)
000000  e7fe              B        |L5.0|
;;;113    {
;;;114      /* Go to infinite loop when Hard Fault exception occurs */
;;;115      while (1)
;;;116      {
;;;117      }
;;;118    }
;;;119    
                          ENDP


                          AREA ||i.MemManage_Handler||, CODE, READONLY, ALIGN=1

                  MemManage_Handler PROC
                  |L6.0|
;;;124      */
;;;125    void MemManage_Handler(void)
000000  e7fe              B        |L6.0|
;;;126    {
;;;127      /* Go to infinite loop when Memory Manage exception occurs */
;;;128      while (1)
;;;129      {
;;;130      }
;;;131    }
;;;132    
                          ENDP


                          AREA ||i.NMI_Handler||, CODE, READONLY, ALIGN=1

                  NMI_Handler PROC
;;;81       */
;;;82     void NMI_Handler(void)
000000  b510              PUSH     {r4,lr}
;;;83     {
;;;84       /* This interrupt is generated when HSE clock fails */
;;;85     
;;;86       if (RCC_GetITStatus(RCC_IT_CSS) != RESET)
000002  2080              MOVS     r0,#0x80
000004  f7fffffe          BL       RCC_GetITStatus
000008  2800              CMP      r0,#0
00000a  d00b              BEQ      |L7.36|
;;;87       {
;;;88         /* At this stage: HSE, PLL are disabled (but no change on PLL config) and HSI
;;;89            is selected as system clock source */
;;;90     
;;;91         /* Enable HSE */
;;;92         RCC_HSEConfig(RCC_HSE_ON);
00000c  2001              MOVS     r0,#1
00000e  f7fffffe          BL       RCC_HSEConfig
;;;93     
;;;94         /* Enable HSE Ready and PLL Ready interrupts */
;;;95         RCC_ITConfig(RCC_IT_HSERDY | RCC_IT_PLLRDY, ENABLE);
000012  2101              MOVS     r1,#1
000014  2018              MOVS     r0,#0x18
000016  f7fffffe          BL       RCC_ITConfig
;;;96     
;;;97         /* Clear Clock Security System interrupt pending bit */
;;;98         RCC_ClearITPendingBit(RCC_IT_CSS);
00001a  e8bd4010          POP      {r4,lr}
00001e  2080              MOVS     r0,#0x80
000020  f7ffbffe          B.W      RCC_ClearITPendingBit
                  |L7.36|
;;;99     
;;;100        /* Once HSE clock recover, the HSERDY interrupt is generated and in the RCC ISR
;;;101           routine the system clock will be reconfigured to its previous state (before
;;;102           HSE clock failure) */
;;;103      }
;;;104    }
000024  bd10              POP      {r4,pc}
;;;105    
                          ENDP


                          AREA ||i.OTG_FS_IRQHandler||, CODE, READONLY, ALIGN=2

                  OTG_FS_IRQHandler PROC
;;;1198     */
;;;1199   void OTG_FS_IRQHandler(void)
000000  4801              LDR      r0,|L8.8|
;;;1200   {
;;;1201     USBH_OTG_ISR_Handler(&USB_OTG_Core);
000002  f7ffbffe          B.W      USBH_OTG_ISR_Handler
;;;1202   }
;;;1203   #endif /* MEDIA_USB_KEY */
                          ENDP

000006  0000              DCW      0x0000
                  |L8.8|
                          DCD      USB_OTG_Core

                          AREA ||i.PendSV_Handler||, CODE, READONLY, ALIGN=1

                  PendSV_Handler PROC
;;;181      */
;;;182    void PendSV_Handler(void)
000000  4770              BX       lr
;;;183    {
;;;184    }
;;;185    
                          ENDP


                          AREA ||i.RCC_IRQHandler||, CODE, READONLY, ALIGN=1

                  RCC_IRQHandler PROC
;;;1219     */
;;;1220   void RCC_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1221   {
;;;1222     if(RCC_GetITStatus(RCC_IT_HSERDY) != RESET)
000002  2008              MOVS     r0,#8
000004  f7fffffe          BL       RCC_GetITStatus
000008  b148              CBZ      r0,|L10.30|
;;;1223     { 
;;;1224       /* Clear HSERDY interrupt pending bit */
;;;1225       RCC_ClearITPendingBit(RCC_IT_HSERDY);
00000a  2008              MOVS     r0,#8
00000c  f7fffffe          BL       RCC_ClearITPendingBit
;;;1226   
;;;1227       /* Check if the HSE clock is still available */
;;;1228       if (RCC_GetFlagStatus(RCC_FLAG_HSERDY) != RESET)
000010  2031              MOVS     r0,#0x31
000012  f7fffffe          BL       RCC_GetFlagStatus
000016  b110              CBZ      r0,|L10.30|
;;;1229       { 
;;;1230         /* Enable PLL: once the PLL is ready the PLLRDY interrupt is generated */ 
;;;1231         RCC_PLLCmd(ENABLE);     
000018  2001              MOVS     r0,#1
00001a  f7fffffe          BL       RCC_PLLCmd
                  |L10.30|
;;;1232       }
;;;1233     }
;;;1234   
;;;1235     if(RCC_GetITStatus(RCC_IT_PLLRDY) != RESET)
00001e  2010              MOVS     r0,#0x10
000020  f7fffffe          BL       RCC_GetITStatus
000024  2800              CMP      r0,#0
000026  d00c              BEQ      |L10.66|
;;;1236     { 
;;;1237       /* Clear PLLRDY interrupt pending bit */
;;;1238       RCC_ClearITPendingBit(RCC_IT_PLLRDY);
000028  2010              MOVS     r0,#0x10
00002a  f7fffffe          BL       RCC_ClearITPendingBit
;;;1239   
;;;1240       /* Check if the PLL is still locked */
;;;1241       if (RCC_GetFlagStatus(RCC_FLAG_PLLRDY) != RESET)
00002e  2039              MOVS     r0,#0x39
000030  f7fffffe          BL       RCC_GetFlagStatus
000034  2800              CMP      r0,#0
000036  d004              BEQ      |L10.66|
;;;1242       { 
;;;1243         /* Select PLL as system clock source */
;;;1244         RCC_SYSCLKConfig(RCC_SYSCLKSource_PLLCLK);
000038  e8bd4010          POP      {r4,lr}
00003c  2002              MOVS     r0,#2
00003e  f7ffbffe          B.W      RCC_SYSCLKConfig
                  |L10.66|
;;;1245       }
;;;1246     }
;;;1247   }
000042  bd10              POP      {r4,pc}
;;;1248   
                          ENDP


                          AREA ||i.SVC_Handler||, CODE, READONLY, ALIGN=1

                  SVC_Handler PROC
;;;163      */
;;;164    void SVC_Handler(void)
000000  4770              BX       lr
;;;165    {
;;;166    }
;;;167    
                          ENDP


                          AREA ||i.SysTick_Handler||, CODE, READONLY, ALIGN=2

                  SysTick_Handler PROC
;;;321      */
;;;322    void SysTick_Handler(void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;323    {
;;;324    	extern __IO uint16_t ADC3ConvertedValue;
;;;325    	extern u32 tick;
;;;326    	extern st_conf conf;
;;;327    	
;;;328     //  проверка состояния датчика приближений - 
;;;329    	
;;;330    	if ((PORT_PRIBL->IDR & PIN_PRIBL)==0)
000004  4efd              LDR      r6,|L12.1020|
000006  6830              LDR      r0,[r6,#0]
;;;331    		kol_pribl_vikl++;
;;;332    	else
;;;333    		kol_pribl_vkl++;
000008  4afd              LDR      r2,|L12.1024|
00000a  4ffe              LDR      r7,|L12.1028|
00000c  07c0              LSLS     r0,r0,#31             ;330
00000e  d064              BEQ      |L12.218|
000010  8810              LDRH     r0,[r2,#0]  ; kol_pribl_vkl
000012  1c40              ADDS     r0,r0,#1
000014  8010              STRH     r0,[r2,#0]
                  |L12.22|
;;;334    	
;;;335    	if (kol_pribl_vkl>=conf.tm_antidreb)
000016  f8dfc3f0          LDR      r12,|L12.1032|
;;;336    	{
;;;337    			sost_pribl=1;
;;;338    			PORT_PER_NIZ->BSRRH = PIN_PER_NIZ;  	// off  PIN_PER_NIZ
00001a  4bfc              LDR      r3,|L12.1036|
00001c  f8b28000          LDRH     r8,[r2,#0]            ;335  ; kol_pribl_vkl
000020  f89c0004          LDRB     r0,[r12,#4]           ;335  ; conf
000024  1599              ASRS     r1,r3,#22
000026  4dfa              LDR      r5,|L12.1040|
000028  2400              MOVS     r4,#0                 ;337
;;;339    			PORT_PER_VERH->BSRRL = PIN_PER_VERH;	// on PIN_PER_VERH
00002a  f44f7a00          MOV      r10,#0x200
00002e  f04f0901          MOV      r9,#1                 ;337
000032  4540              CMP      r0,r8                 ;335
000034  d806              BHI      |L12.68|
000036  f8859000          STRB     r9,[r5,#0]            ;337
00003a  8359              STRH     r1,[r3,#0x1a]         ;338
00003c  f8a3a018          STRH     r10,[r3,#0x18]
;;;340    			kol_pribl_vkl=0;
000040  8014              STRH     r4,[r2,#0]
;;;341    		  kol_pribl_vikl=0;
000042  803c              STRH     r4,[r7,#0]
                  |L12.68|
;;;342    	} 
;;;343    	
;;;344    	if (kol_pribl_vikl>=conf.tm_antidreb)
000044  f8b78000          LDRH     r8,[r7,#0]  ; kol_pribl_vikl
000048  4540              CMP      r0,r8
00004a  d805              BHI      |L12.88|
;;;345    	{
;;;346    			sost_pribl=0;
00004c  702c              STRB     r4,[r5,#0]
;;;347    			PORT_PER_NIZ->BSRRL = PIN_PER_NIZ;  	// on  PIN_PER_NIZ
00004e  8319              STRH     r1,[r3,#0x18]
;;;348    			PORT_PER_VERH->BSRRH = PIN_PER_VERH;	// off PIN_PER_VERH
000050  f8a3a01a          STRH     r10,[r3,#0x1a]
;;;349    			kol_pribl_vkl=0;
000054  8014              STRH     r4,[r2,#0]
;;;350    			kol_pribl_vikl=0;
000056  803c              STRH     r4,[r7,#0]
                  |L12.88|
;;;351    	}
;;;352    
;;;353    	
;;;354    	// проверка кнопок-состояния переключателей группы калибровок
;;;355    	// on 	GPIO_PORT[Led]->BSRRL = GPIO_PIN[Led];
;;;356    	// off  GPIO_PORT[Led]->BSRRH = GPIO_PIN[Led];    
;;;357    //	conf.tek_gr_kal
;;;358    
;;;359    		if ((PORT_K1->IDR & PIN_K1)==0)
000058  6832              LDR      r2,[r6,#0]
;;;360    			kol_gr1_vkl++;
00005a  4bee              LDR      r3,|L12.1044|
00005c  0612              LSLS     r2,r2,#24             ;359
00005e  d403              BMI      |L12.104|
000060  881a              LDRH     r2,[r3,#0]  ; kol_gr1_vkl
000062  f1020201          ADD      r2,r2,#1
000066  801a              STRH     r2,[r3,#0]
                  |L12.104|
;;;361    
;;;362    		if ((PORT_K2->IDR & PIN_K2)==0)
000068  6832              LDR      r2,[r6,#0]
00006a  0596              LSLS     r6,r2,#22
;;;363    			kol_gr2_vkl++;
00006c  4aea              LDR      r2,|L12.1048|
00006e  d402              BMI      |L12.118|
000070  8816              LDRH     r6,[r2,#0]  ; kol_gr2_vkl
000072  1c76              ADDS     r6,r6,#1
000074  8016              STRH     r6,[r2,#0]
                  |L12.118|
;;;364    
;;;365    		if (kol_gr1_vkl>=conf.tm_antidreb)
;;;366    		{
;;;367    				conf.tek_gr_kal=0;
;;;368    	 // gr 1
;;;369    			PORT_L1->BSRRL = PIN_L1;  	// on  PIN_L1
000076  f8dfa384          LDR      r10,|L12.1020|
00007a  881f              LDRH     r7,[r3,#0]            ;365  ; kol_gr1_vkl
00007c  2640              MOVS     r6,#0x40
00007e  f10a0a08          ADD      r10,r10,#8
;;;370    			PORT_L2->BSRRH = PIN_L2;	// off PIN_L2
000082  f10a0802          ADD      r8,r10,#2
000086  42b8              CMP      r0,r7                 ;365
000088  d807              BHI      |L12.154|
00008a  f88c4003          STRB     r4,[r12,#3]           ;367
00008e  f8aa6000          STRH     r6,[r10,#0]           ;369
000092  f8a81000          STRH     r1,[r8,#0]
;;;371    
;;;372    				kol_gr1_vkl=0;
000096  801c              STRH     r4,[r3,#0]
;;;373    				kol_gr2_vkl=0;
000098  8014              STRH     r4,[r2,#0]
                  |L12.154|
;;;374    		}		
;;;375    
;;;376    		if (kol_gr2_vkl>=conf.tm_antidreb)
00009a  8817              LDRH     r7,[r2,#0]  ; kol_gr2_vkl
00009c  42b8              CMP      r0,r7
00009e  d808              BHI      |L12.178|
;;;377    		{
;;;378    				conf.tek_gr_kal=1;
0000a0  4fd9              LDR      r7,|L12.1032|
0000a2  f8879003          STRB     r9,[r7,#3]
;;;379    				 // gr 2
;;;380    			PORT_L1->BSRRH = PIN_L1;  	// off  PIN_L1
0000a6  f8a86000          STRH     r6,[r8,#0]
;;;381    			PORT_L2->BSRRL = PIN_L2;	// on PIN_L2
0000aa  f8aa1000          STRH     r1,[r10,#0]
;;;382    				kol_gr1_vkl=0;
0000ae  801c              STRH     r4,[r3,#0]
;;;383    				kol_gr2_vkl=0;
0000b0  8014              STRH     r4,[r2,#0]
                  |L12.178|
;;;384    		}				
;;;385    	
;;;386    	/*
;;;387    	  RCC_AHB1PeriphClockCmd(GPIO_CLK[Led], ENABLE);
;;;388    
;;;389    
;;;390      GPIO_InitStructure.GPIO_Pin = GPIO_PIN[Led];
;;;391      GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
;;;392      GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
;;;393      GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
;;;394      GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
;;;395      GPIO_Init(GPIO_PORT[Led], &GPIO_InitStructure);
;;;396    	*/
;;;397    	
;;;398    			// проверяем реле на срабатывание
;;;399    	test_rele(fz[0], 0);	
0000b2  4eda              LDR      r6,|L12.1052|
0000b4  2100              MOVS     r1,#0
0000b6  8830              LDRH     r0,[r6,#0]  ; fz
0000b8  f7fffffe          BL       test_rele
;;;400    	
;;;401    	
;;;402    	// раз в 10 мс
;;;403    	// находим среднее значение
;;;404    	summa[0]+=ADC3ConvertedValue;
0000bc  4ad8              LDR      r2,|L12.1056|
0000be  48d9              LDR      r0,|L12.1060|
0000c0  8811              LDRH     r1,[r2,#0]  ; summa
0000c2  8800              LDRH     r0,[r0,#0]  ; ADC3ConvertedValue
;;;405    	 
;;;406    //		summa[0]+=100;
;;;407    	kol_average++;
0000c4  4bd8              LDR      r3,|L12.1064|
0000c6  4408              ADD      r0,r0,r1              ;404
0000c8  b281              UXTH     r1,r0                 ;404
0000ca  8011              STRH     r1,[r2,#0]            ;404
0000cc  7818              LDRB     r0,[r3,#0]  ; kol_average
0000ce  1c40              ADDS     r0,r0,#1
0000d0  b2c0              UXTB     r0,r0
0000d2  7018              STRB     r0,[r3,#0]
;;;408    	
;;;409    	if (kol_average==10)
0000d4  280a              CMP      r0,#0xa
0000d6  d004              BEQ      |L12.226|
0000d8  e0cf              B        |L12.634|
                  |L12.218|
0000da  8838              LDRH     r0,[r7,#0]            ;331  ; kol_pribl_vikl
0000dc  1c40              ADDS     r0,r0,#1              ;331
0000de  8038              STRH     r0,[r7,#0]            ;331
0000e0  e799              B        |L12.22|
                  |L12.226|
;;;410    	{			
;;;411    	
;;;412    		average[0]=summa[0]/kol_average;
0000e2  fbb1f0f0          UDIV     r0,r1,r0
0000e6  49d1              LDR      r1,|L12.1068|
;;;413    		kol_average=0;
;;;414    		summa[0]=0;
;;;415    		
;;;416    		
;;;417    		// раз в 100 мс
;;;418    		// вычисляем физическую величину
;;;419    		
;;;420    		if (conf.tek_gr_kal==0)
0000e8  4fc7              LDR      r7,|L12.1032|
0000ea  8008              STRH     r0,[r1,#0]            ;412
0000ec  701c              STRB     r4,[r3,#0]            ;413
0000ee  8014              STRH     r4,[r2,#0]            ;414
0000f0  78f9              LDRB     r1,[r7,#3]  ; conf
0000f2  2900              CMP      r1,#0
;;;421    				if (sost_pribl==0)
;;;422    					fz[0]=fiz_vel(average[0],&conf.gr_kal1.tabl1);
;;;423    				else
;;;424    					fz[0]=fiz_vel(average[0],&conf.gr_kal1.tabl2);
;;;425    		else
;;;426    				if (sost_pribl==0)
0000f4  7829              LDRB     r1,[r5,#0]  ; sost_pribl
0000f6  d028              BEQ      |L12.330|
0000f8  2900              CMP      r1,#0
;;;427    					fz[0]=fiz_vel(average[0],&conf.gr_kal2.tabl1);
;;;428    				else
;;;429    					fz[0]=fiz_vel(average[0],&conf.gr_kal2.tabl2);
0000fa  4639              MOV      r1,r7
0000fc  d02c              BEQ      |L12.344|
0000fe  3196              ADDS     r1,r1,#0x96
                  |L12.256|
000100  f7fffffe          BL       fiz_vel
000104  8030              STRH     r0,[r6,#0]            ;427
;;;430    			
;;;431    	
;;;432    	// находим среднее значение по скользящей средней
;;;433    		fz_average[0]=moving_average(fz[0],0);
000106  b280              UXTH     r0,r0
000108  2100              MOVS     r1,#0
00010a  f7fffffe          BL       moving_average
00010e  49c8              LDR      r1,|L12.1072|
;;;434    
;;;435    		// time max
;;;436    		if (time_max>=conf.time_max) {
000110  4abd              LDR      r2,|L12.1032|
000112  4ec8              LDR      r6,|L12.1076|
000114  8008              STRH     r0,[r1,#0]            ;433
000116  8952              LDRH     r2,[r2,#0xa]  ; conf
000118  8933              LDRH     r3,[r6,#8]  ; time_max
00011a  429a              CMP      r2,r3
00011c  d802              BHI      |L12.292|
;;;437    				max[0]=0;
00011e  4ac6              LDR      r2,|L12.1080|
000120  8014              STRH     r4,[r2,#0]
;;;438    				time_max=0;  }
000122  8134              STRH     r4,[r6,#8]
                  |L12.292|
;;;439    		time_max++;
000124  8932              LDRH     r2,[r6,#8]  ; time_max
;;;440    		// detect max
;;;441    		if (fz_average[0]>max[0])
000126  f8df8310          LDR      r8,|L12.1080|
00012a  1c52              ADDS     r2,r2,#1              ;439
00012c  8132              STRH     r2,[r6,#8]            ;439
00012e  f8b81000          LDRH     r1,[r8,#0]  ; max
000132  4288              CMP      r0,r1
000134  d901              BLS      |L12.314|
;;;442    			max[0]=fz_average[0];
000136  f8a80000          STRH     r0,[r8,#0]
                  |L12.314|
;;;443    
;;;444    		
;;;445    		if (number_buff)
00013a  48c0              LDR      r0,|L12.1084|
;;;446    			Buf_adc_zap2[por++]=por; //fz_average[0];			
;;;447    		else
;;;448    			Buf_adc_zap1[por++]=por; //fz_average[0];
00013c  49c0              LDR      r1,|L12.1088|
00013e  7800              LDRB     r0,[r0,#0]            ;445  ; number_buff
000140  2800              CMP      r0,#0                 ;445
000142  8808              LDRH     r0,[r1,#0]  ; por
000144  d00a              BEQ      |L12.348|
000146  4abf              LDR      r2,|L12.1092|
000148  e009              B        |L12.350|
                  |L12.330|
00014a  2900              CMP      r1,#0                 ;421
00014c  49ae              LDR      r1,|L12.1032|
00014e  d001              BEQ      |L12.340|
000150  3146              ADDS     r1,r1,#0x46           ;424
000152  e7d5              B        |L12.256|
                  |L12.340|
000154  311e              ADDS     r1,r1,#0x1e           ;422
000156  e7d3              B        |L12.256|
                  |L12.344|
000158  316e              ADDS     r1,r1,#0x6e           ;427
00015a  e7d1              B        |L12.256|
                  |L12.348|
00015c  4aba              LDR      r2,|L12.1096|
                  |L12.350|
;;;449    		
;;;450    		if (por==999)
00015e  4fb8              LDR      r7,|L12.1088|
000160  f8220010          STRH     r0,[r2,r0,LSL #1]     ;448
000164  1c40              ADDS     r0,r0,#1              ;448
000166  8008              STRH     r0,[r1,#0]            ;448
000168  8839              LDRH     r1,[r7,#0]  ; por
00016a  f24030e7          MOV      r0,#0x3e7
00016e  4281              CMP      r1,r0
000170  d100              BNE      |L12.372|
;;;451    			por=999;
000172  8038              STRH     r0,[r7,#0]
                  |L12.372|
;;;452    	
;;;453    	del++;
000174  49b5              LDR      r1,|L12.1100|
;;;454    	if (del==10)
;;;455    	{		
;;;456    		del=0;
;;;457    		tick++;
000176  f8dfb2d8          LDR      r11,|L12.1104|
00017a  8808              LDRH     r0,[r1,#0]            ;453  ; del
00017c  1c40              ADDS     r0,r0,#1              ;453
00017e  b280              UXTH     r0,r0                 ;453
000180  8008              STRH     r0,[r1,#0]            ;453
000182  280a              CMP      r0,#0xa               ;454
000184  d161              BNE      |L12.586|
000186  800c              STRH     r4,[r1,#0]            ;456
000188  f8db0000          LDR      r0,[r11,#0]  ; tick
;;;458    		time_label=tick;
00018c  49b1              LDR      r1,|L12.1108|
00018e  1c40              ADDS     r0,r0,#1              ;457
000190  f8cb0000          STR      r0,[r11,#0]  ; tick
000194  8008              STRH     r0,[r1,#0]
;;;459    		
;;;460    		rtc_Get(&DT1);
000196  48a7              LDR      r0,|L12.1076|
000198  300c              ADDS     r0,r0,#0xc
00019a  f7fffffe          BL       rtc_Get
;;;461    		
;;;462    		if (DT1.Seconds==0)
00019e  f8dfa294          LDR      r10,|L12.1076|
0001a2  f10a0a0c          ADD      r10,r10,#0xc
0001a6  f89a1006          LDRB     r1,[r10,#6]  ; DT1
0001aa  b971              CBNZ     r1,|L12.458|
;;;463    		{
;;;464    			number_buff^=1;
0001ac  48a3              LDR      r0,|L12.1084|
0001ae  7802              LDRB     r2,[r0,#0]  ; number_buff
0001b0  f0820201          EOR      r2,r2,#1
0001b4  7002              STRB     r2,[r0,#0]
;;;465    			DT_zap=DT1;
0001b6  48a8              LDR      r0,|L12.1112|
0001b8  68f2              LDR      r2,[r6,#0xc]  ; DT1
0001ba  6002              STR      r2,[r0,#0]  ; DT_zap
0001bc  8a32              LDRH     r2,[r6,#0x10]  ; DT1
0001be  8082              STRH     r2,[r0,#4]
0001c0  7181              STRB     r1,[r0,#6]
;;;466    			
;;;467    			buffering=1;
0001c2  49a6              LDR      r1,|L12.1116|
0001c4  f8819000          STRB     r9,[r1,#0]
;;;468    			por=0;
0001c8  803c              STRH     r4,[r7,#0]
                  |L12.458|
;;;469    		}
;;;470    			
;;;471    	 if (tick%2==0)
0001ca  f89b0000          LDRB     r0,[r11,#0]  ; tick
0001ce  465f              MOV      r7,r11
0001d0  07c0              LSLS     r0,r0,#31
;;;472    	 {
;;;473    		 STM_EVAL_LEDOn(LED3);		 
;;;474    	 }
;;;475    	 else
;;;476    	 {
;;;477    		 STM_EVAL_LEDOff(LED3);	 
0001d2  f04f0001          MOV      r0,#1
0001d6  d009              BEQ      |L12.492|
0001d8  f7fffffe          BL       STM_EVAL_LEDOff
                  |L12.476|
;;;478    	 }
;;;479    	 
;;;480    // indicate_lin(0,(u16)fz_average[0], 4096);
;;;481    // indicate(1,(u16)(fz_average[0]/10));
;;;482    	 if (tk_null==1)
0001dc  7830              LDRB     r0,[r6,#0]  ; tk_null
0001de  2801              CMP      r0,#1
0001e0  d007              BEQ      |L12.498|
;;;483    	 {
;;;484    		 indicate_err(1);   	// tek
;;;485    		 indicate_err(2);			// lineika 
;;;486    		 indicate_err(3);			// maximum
;;;487    	//	 indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes);								//	time	
;;;488    	 }
;;;489    	 else
;;;490    	 {		
;;;491    	 if ((avariya==1)&((tick%2)==0))
0001e2  489f              LDR      r0,|L12.1120|
0001e4  7800              LDRB     r0,[r0,#0]  ; avariya
0001e6  2801              CMP      r0,#1
0001e8  d00d              BEQ      |L12.518|
0001ea  e00f              B        |L12.524|
                  |L12.492|
0001ec  f7fffffe          BL       STM_EVAL_LEDOn
0001f0  e7f4              B        |L12.476|
                  |L12.498|
0001f2  2001              MOVS     r0,#1                 ;484
0001f4  f7fffffe          BL       indicate_err
0001f8  2002              MOVS     r0,#2                 ;485
0001fa  f7fffffe          BL       indicate_err
0001fe  2003              MOVS     r0,#3                 ;486
000200  f7fffffe          BL       indicate_err
000204  e021              B        |L12.586|
                  |L12.518|
000206  7838              LDRB     r0,[r7,#0]  ; tick
000208  07c0              LSLS     r0,r0,#31
00020a  d027              BEQ      |L12.604|
                  |L12.524|
;;;492    	 {
;;;493    			ind_blank_all();   	
;;;494    		}
;;;495    		else
;;;496    		{
;;;497    		 // dop usrednenie na vivod indicatorov???
;;;498    		 indicate(1,(u16)(u16)(fz_average[0]),3);   																// tek
00020c  4e88              LDR      r6,|L12.1072|
00020e  2203              MOVS     r2,#3
000210  2001              MOVS     r0,#1
000212  8831              LDRH     r1,[r6,#0]  ; fz_average
000214  f7fffffe          BL       indicate
;;;499    
;;;500    			if (conf.tek_gr_kal==0)
000218  487b              LDR      r0,|L12.1032|
00021a  78c1              LDRB     r1,[r0,#3]  ; conf
00021c  2900              CMP      r1,#0
;;;501    					if (sost_pribl==0)
;;;502    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max1, (u16) conf.lin.kol_st);			// lineika 
;;;503    					else
;;;504    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max2, (u16) conf.lin.kol_st);			// lineika 
;;;505    			else
;;;506    					if (sost_pribl==0)
00021e  7829              LDRB     r1,[r5,#0]  ; sost_pribl
000220  d01f              BEQ      |L12.610|
;;;507    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max3, (u16) conf.lin.kol_st);			// lineika 
;;;508    					else
;;;509    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max4, (u16) conf.lin.kol_st);			// lineika 
000222  7d03              LDRB     r3,[r0,#0x14]  ; conf
000224  b319              CBZ      r1,|L12.622|
000226  8b82              LDRH     r2,[r0,#0x1c]  ; conf
                  |L12.552|
000228  8831              LDRH     r1,[r6,#0]            ;507  ; fz_average
00022a  2002              MOVS     r0,#2                 ;507
00022c  f7fffffe          BL       indicate_lin
;;;510    		 
;;;511    		 indicate(3,(u16)(max[0]),3);														// maximum
000230  2203              MOVS     r2,#3
000232  f8b81000          LDRH     r1,[r8,#0]  ; max
000236  4610              MOV      r0,r2
000238  f7fffffe          BL       indicate
;;;512    		 indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes);								//	time		 
00023c  f89a2005          LDRB     r2,[r10,#5]  ; DT1
000240  f89a1004          LDRB     r1,[r10,#4]  ; DT1
000244  2004              MOVS     r0,#4
000246  f7fffffe          BL       indicate_time
                  |L12.586|
;;;513    		}
;;;514    	 }	
;;;515     }	 
;;;516    		
;;;517    	if ((tick%60)==0)
00024a  f8db0000          LDR      r0,[r11,#0]  ; tick
00024e  213c              MOVS     r1,#0x3c
000250  fbb0f2f1          UDIV     r2,r0,r1
000254  fb010012          MLS      r0,r1,r2,r0
000258  b158              CBZ      r0,|L12.626|
00025a  e00e              B        |L12.634|
                  |L12.604|
00025c  f7fffffe          BL       ind_blank_all
000260  e7f3              B        |L12.586|
                  |L12.610|
000262  7d03              LDRB     r3,[r0,#0x14]         ;504  ; conf
000264  b109              CBZ      r1,|L12.618|
000266  8b02              LDRH     r2,[r0,#0x18]         ;504  ; conf
000268  e7de              B        |L12.552|
                  |L12.618|
00026a  8ac2              LDRH     r2,[r0,#0x16]         ;502  ; conf
00026c  e7dc              B        |L12.552|
                  |L12.622|
00026e  8b42              LDRH     r2,[r0,#0x1a]         ;507  ; conf
000270  e7da              B        |L12.552|
                  |L12.626|
;;;518    	{
;;;519    		minute++;
000272  487c              LDR      r0,|L12.1124|
000274  8801              LDRH     r1,[r0,#0]  ; minute
000276  1c49              ADDS     r1,r1,#1
000278  8001              STRH     r1,[r0,#0]
                  |L12.634|
;;;520    	}
;;;521    	}	
;;;522    	
;;;523    	if (new_komand)
00027a  487b              LDR      r0,|L12.1128|
00027c  7800              LDRB     r0,[r0,#0]  ; new_komand
00027e  2800              CMP      r0,#0
000280  d06f              BEQ      |L12.866|
;;;524    	{
;;;525    		u16 tmp=0;
;;;526    	
;;;527    		// wrt_conf
;;;528    		if ((RxBuffer[2]=='w')&(RxBuffer[3]=='r')&(RxBuffer[4]=='t')&(RxBuffer[5]=='_')&(RxBuffer[6]=='c')&(RxBuffer[7]=='o')&(RxBuffer[8]=='n')&(RxBuffer[9]=='f'))
000282  4a7a              LDR      r2,|L12.1132|
000284  7890              LDRB     r0,[r2,#2]  ; RxBuffer
000286  2877              CMP      r0,#0x77
000288  d046              BEQ      |L12.792|
00028a  2000              MOVS     r0,#0
                  |L12.652|
00028c  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
00028e  2972              CMP      r1,#0x72
000290  d044              BEQ      |L12.796|
000292  2100              MOVS     r1,#0
                  |L12.660|
000294  4008              ANDS     r0,r0,r1
000296  7911              LDRB     r1,[r2,#4]  ; RxBuffer
000298  2974              CMP      r1,#0x74
00029a  d041              BEQ      |L12.800|
00029c  2100              MOVS     r1,#0
                  |L12.670|
00029e  4008              ANDS     r0,r0,r1
0002a0  7951              LDRB     r1,[r2,#5]  ; RxBuffer
0002a2  295f              CMP      r1,#0x5f
0002a4  d03e              BEQ      |L12.804|
0002a6  2100              MOVS     r1,#0
                  |L12.680|
0002a8  4008              ANDS     r0,r0,r1
0002aa  7991              LDRB     r1,[r2,#6]  ; RxBuffer
0002ac  2963              CMP      r1,#0x63
0002ae  d03b              BEQ      |L12.808|
0002b0  2100              MOVS     r1,#0
                  |L12.690|
0002b2  4008              ANDS     r0,r0,r1
0002b4  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
0002b6  296f              CMP      r1,#0x6f
0002b8  d038              BEQ      |L12.812|
0002ba  2100              MOVS     r1,#0
                  |L12.700|
0002bc  4008              ANDS     r0,r0,r1
0002be  7a11              LDRB     r1,[r2,#8]  ; RxBuffer
0002c0  296e              CMP      r1,#0x6e
0002c2  d035              BEQ      |L12.816|
0002c4  2100              MOVS     r1,#0
                  |L12.710|
0002c6  4008              ANDS     r0,r0,r1
0002c8  4968              LDR      r1,|L12.1132|
0002ca  7a49              LDRB     r1,[r1,#9]  ; RxBuffer
0002cc  2966              CMP      r1,#0x66
0002ce  d031              BEQ      |L12.820|
0002d0  2100              MOVS     r1,#0
                  |L12.722|
;;;529    		{
;;;530    			u16 i=0;
;;;531    			u8 errors=0;
;;;532    			
;;;533    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
;;;534    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
;;;535    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
;;;536    	
;;;537    		
;;;538    			for (i = 0; i < rxsize-10; i += 2)
;;;539    			{
;;;540    			  tmp1=RxBuffer[i+10];
;;;541    				tmp2=RxBuffer[i+11];
;;;542    				tmp3=0;
;;;543    				if (tmp1>'9')	
;;;544    						tmp3=(tmp1-0x37)<<4;
;;;545    				else
;;;546    						tmp3=(tmp1-0x30)<<4;
;;;547    	
;;;548    				if (tmp2>'9')	
;;;549    						tmp3+=(tmp2-0x37);
;;;550    				else
;;;551    						tmp3+=(tmp2-0x30);				
;;;552    				*(__IO uint8_t *) (BKPSRAM_BASE + (i>>1)) = tmp3;//*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i);
;;;553    				if (*(__IO uint8_t *) (BKPSRAM_BASE + (i>>1)) != tmp3)
;;;554    						errors=1;
;;;555    			}
;;;556    
;;;557    			if (errors==0)
;;;558    			{
;;;559    			TxBuffer[0]='w';
;;;560    			TxBuffer[1]='r';	
;;;561    			TxBuffer[2]='t';
;;;562    			TxBuffer[3]='_';					
;;;563    			TxBuffer[4]='c';		
;;;564    			TxBuffer[5]='o';	
;;;565    			TxBuffer[6]='n';	
;;;566    			TxBuffer[7]='f';	
;;;567    			TxBuffer[8]='_';	
;;;568    			TxBuffer[9]='o';
;;;569    			TxBuffer[10]='k';	
;;;570    			}
;;;571    			else
;;;572    			{
;;;573    				TxBuffer[0]='w';
;;;574    				TxBuffer[1]='r';	
;;;575    				TxBuffer[2]='t';
;;;576    				TxBuffer[3]='_';					
;;;577    				TxBuffer[4]='c';		
;;;578    				TxBuffer[5]='o';	
;;;579    				TxBuffer[6]='n';	
;;;580    				TxBuffer[7]='f';	
;;;581    				TxBuffer[8]='_';	
;;;582    				TxBuffer[9]='e';
;;;583    				TxBuffer[10]='r';	
;;;584    			}
;;;585    	
;;;586    			txsize=11;
;;;587    			tekper=0;
0002d2  f8dfb19c          LDR      r11,|L12.1136|
0002d6  f8df919c          LDR      r9,|L12.1140|
0002da  4f67              LDR      r7,|L12.1144|
0002dc  f8dfa19c          LDR      r10,|L12.1148|
0002e0  4208              TST      r0,r1                 ;528
0002e2  d073              BEQ      |L12.972|
0002e4  2600              MOVS     r6,#0                 ;530
0002e6  46b0              MOV      r8,r6                 ;531
0002e8  4632              MOV      r2,r6                 ;533
0002ea  f2405125          MOV      r1,#0x525             ;533
0002ee  4648              MOV      r0,r9                 ;533
0002f0  f7fffffe          BL       USART_ITConfig
0002f4  2201              MOVS     r2,#1                 ;534
0002f6  f2406126          MOV      r1,#0x626             ;534
0002fa  4648              MOV      r0,r9                 ;534
0002fc  f7fffffe          BL       USART_ITConfig
000300  2201              MOVS     r2,#1                 ;535
000302  2108              MOVS     r1,#8                 ;535
000304  485e              LDR      r0,|L12.1152|
000306  f7fffffe          BL       GPIO_WriteBit
00030a  f8dfc178          LDR      r12,|L12.1156|
00030e  4b5e              LDR      r3,|L12.1160|
000310  495e              LDR      r1,|L12.1164|
000312  f8dfe158          LDR      lr,|L12.1132|
000316  e034              B        |L12.898|
                  |L12.792|
000318  2001              MOVS     r0,#1                 ;528
00031a  e7b7              B        |L12.652|
                  |L12.796|
00031c  2101              MOVS     r1,#1                 ;528
00031e  e7b9              B        |L12.660|
                  |L12.800|
000320  2101              MOVS     r1,#1                 ;528
000322  e7bc              B        |L12.670|
                  |L12.804|
000324  2101              MOVS     r1,#1                 ;528
000326  e7bf              B        |L12.680|
                  |L12.808|
000328  2101              MOVS     r1,#1                 ;528
00032a  e7c2              B        |L12.690|
                  |L12.812|
00032c  2101              MOVS     r1,#1                 ;528
00032e  e7c5              B        |L12.700|
                  |L12.816|
000330  2101              MOVS     r1,#1                 ;528
000332  e7c8              B        |L12.710|
                  |L12.820|
000334  2101              MOVS     r1,#1                 ;528
000336  e7cc              B        |L12.722|
                  |L12.824|
000338  eb0e0006          ADD      r0,lr,r6              ;540
00033c  7a82              LDRB     r2,[r0,#0xa]          ;540
00033e  f88c2000          STRB     r2,[r12,#0]           ;540
000342  7ac0              LDRB     r0,[r0,#0xb]          ;541
000344  7018              STRB     r0,[r3,#0]            ;541
000346  2a39              CMP      r2,#0x39              ;543
000348  700c              STRB     r4,[r1,#0]            ;542
00034a  ea4f1202          LSL      r2,r2,#4              ;546
00034e  d901              BLS      |L12.852|
000350  f5a2725c          SUB      r2,r2,#0x370          ;544
                  |L12.852|
000354  700a              STRB     r2,[r1,#0]            ;546
000356  2839              CMP      r0,#0x39              ;548
000358  b2d2              UXTB     r2,r2                 ;551
00035a  4410              ADD      r0,r0,r2              ;551
00035c  d902              BLS      |L12.868|
00035e  3837              SUBS     r0,r0,#0x37           ;549
000360  e001              B        |L12.870|
                  |L12.866|
000362  e35b              B        |L12.2588|
                  |L12.868|
000364  3830              SUBS     r0,r0,#0x30           ;551
                  |L12.870|
000366  7008              STRB     r0,[r1,#0]            ;551
000368  b2c2              UXTB     r2,r0                 ;552
00036a  4849              LDR      r0,|L12.1168|
00036c  eb000056          ADD      r0,r0,r6,LSR #1       ;552
000370  7002              STRB     r2,[r0,#0]            ;552
000372  7800              LDRB     r0,[r0,#0]            ;553
000374  780a              LDRB     r2,[r1,#0]            ;553  ; tmp3
000376  4290              CMP      r0,r2                 ;553
000378  d001              BEQ      |L12.894|
00037a  f04f0801          MOV      r8,#1                 ;554
                  |L12.894|
00037e  1cb6              ADDS     r6,r6,#2              ;538
000380  b2b6              UXTH     r6,r6                 ;538
                  |L12.898|
000382  4844              LDR      r0,|L12.1172|
000384  8800              LDRH     r0,[r0,#0]            ;538  ; rxsize
000386  380a              SUBS     r0,r0,#0xa            ;538
000388  4286              CMP      r6,r0                 ;538
00038a  dbd5              BLT      |L12.824|
00038c  2077              MOVS     r0,#0x77              ;528
00038e  2163              MOVS     r1,#0x63              ;528
000390  226e              MOVS     r2,#0x6e              ;528
000392  2366              MOVS     r3,#0x66              ;528
000394  f1b80f00          CMP      r8,#0                 ;557
000398  7038              STRB     r0,[r7,#0]            ;573
00039a  d07d              BEQ      |L12.1176|
00039c  2672              MOVS     r6,#0x72              ;574
00039e  707e              STRB     r6,[r7,#1]            ;574
0003a0  2074              MOVS     r0,#0x74              ;575
0003a2  70b8              STRB     r0,[r7,#2]            ;575
0003a4  205f              MOVS     r0,#0x5f              ;576
0003a6  70f8              STRB     r0,[r7,#3]            ;576
0003a8  7139              STRB     r1,[r7,#4]            ;577
0003aa  216f              MOVS     r1,#0x6f              ;578
0003ac  7179              STRB     r1,[r7,#5]            ;578
0003ae  71ba              STRB     r2,[r7,#6]            ;579
0003b0  71fb              STRB     r3,[r7,#7]            ;580
0003b2  7238              STRB     r0,[r7,#8]            ;581
0003b4  2065              MOVS     r0,#0x65              ;582
0003b6  7278              STRB     r0,[r7,#9]            ;582
0003b8  72be              STRB     r6,[r7,#0xa]          ;583
                  |L12.954|
0003ba  200b              MOVS     r0,#0xb               ;586
0003bc  f8aa0000          STRH     r0,[r10,#0]           ;586
0003c0  f8ab4000          STRH     r4,[r11,#0]
;;;588    			USART_SendData(USART2, 0x3A);
0003c4  213a              MOVS     r1,#0x3a
0003c6  4648              MOV      r0,r9
0003c8  f7fffffe          BL       USART_SendData
                  |L12.972|
;;;589    		}
;;;590    
;;;591    		// who?
;;;592    		if ((RxBuffer[2]=='w')&(RxBuffer[3]=='h')&(RxBuffer[4]=='o')&(RxBuffer[5]=='?'))
0003cc  4e27              LDR      r6,|L12.1132|
0003ce  78b0              LDRB     r0,[r6,#2]  ; RxBuffer
0003d0  2877              CMP      r0,#0x77
0003d2  d07d              BEQ      |L12.1232|
0003d4  2000              MOVS     r0,#0
                  |L12.982|
0003d6  78f1              LDRB     r1,[r6,#3]  ; RxBuffer
0003d8  2968              CMP      r1,#0x68
0003da  d07a              BEQ      |L12.1234|
0003dc  2100              MOVS     r1,#0
                  |L12.990|
0003de  4008              ANDS     r0,r0,r1
0003e0  7931              LDRB     r1,[r6,#4]  ; RxBuffer
0003e2  296f              CMP      r1,#0x6f
0003e4  d076              BEQ      |L12.1236|
0003e6  2100              MOVS     r1,#0
                  |L12.1000|
0003e8  4008              ANDS     r0,r0,r1
0003ea  7971              LDRB     r1,[r6,#5]  ; RxBuffer
0003ec  293f              CMP      r1,#0x3f
0003ee  d072              BEQ      |L12.1238|
0003f0  2100              MOVS     r1,#0
                  |L12.1010|
0003f2  4208              TST      r0,r1
;;;593    		{
;;;594    			
;;;595    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
;;;596    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
;;;597    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
;;;598    			
;;;599    			TxBuffer[0]='u';
;;;600    			TxBuffer[1]='s';	
0003f4  f04f0873          MOV      r8,#0x73
0003f8  d06e              BEQ      |L12.1240|
0003fa  e04e              B        |L12.1178|
                  |L12.1020|
                          DCD      0x40020810
                  |L12.1024|
                          DCD      kol_pribl_vkl
                  |L12.1028|
                          DCD      kol_pribl_vikl
                  |L12.1032|
                          DCD      conf
                  |L12.1036|
                          DCD      0x40020000
                  |L12.1040|
                          DCD      sost_pribl
                  |L12.1044|
                          DCD      kol_gr1_vkl
                  |L12.1048|
                          DCD      kol_gr2_vkl
                  |L12.1052|
                          DCD      ||fz||
                  |L12.1056|
                          DCD      summa
                  |L12.1060|
                          DCD      ADC3ConvertedValue
                  |L12.1064|
                          DCD      kol_average
                  |L12.1068|
                          DCD      average
                  |L12.1072|
                          DCD      fz_average
                  |L12.1076|
                          DCD      ||.data||
                  |L12.1080|
                          DCD      max
                  |L12.1084|
                          DCD      number_buff
                  |L12.1088|
                          DCD      por
                  |L12.1092|
                          DCD      Buf_adc_zap2
                  |L12.1096|
                          DCD      Buf_adc_zap1
                  |L12.1100|
                          DCD      ||del||
                  |L12.1104|
                          DCD      tick
                  |L12.1108|
                          DCD      time_label
                  |L12.1112|
                          DCD      DT_zap
                  |L12.1116|
                          DCD      buffering
                  |L12.1120|
                          DCD      avariya
                  |L12.1124|
                          DCD      minute
                  |L12.1128|
                          DCD      new_komand
                  |L12.1132|
                          DCD      RxBuffer
                  |L12.1136|
                          DCD      tekper
                  |L12.1140|
                          DCD      0x40004400
                  |L12.1144|
                          DCD      TxBuffer
                  |L12.1148|
                          DCD      txsize
                  |L12.1152|
                          DCD      0x40020c00
                  |L12.1156|
                          DCD      tmp1
                  |L12.1160|
                          DCD      tmp2
                  |L12.1164|
                          DCD      tmp3
                  |L12.1168|
                          DCD      0x40024000
                  |L12.1172|
                          DCD      rxsize
                  |L12.1176|
000498  e2c2              B        |L12.2592|
                  |L12.1178|
00049a  2200              MOVS     r2,#0                 ;595
00049c  f2405125          MOV      r1,#0x525             ;595
0004a0  4648              MOV      r0,r9                 ;595
0004a2  f7fffffe          BL       USART_ITConfig
0004a6  2201              MOVS     r2,#1                 ;596
0004a8  f2406126          MOV      r1,#0x626             ;596
0004ac  4648              MOV      r0,r9                 ;596
0004ae  f7fffffe          BL       USART_ITConfig
0004b2  2201              MOVS     r2,#1                 ;597
0004b4  2108              MOVS     r1,#8                 ;597
0004b6  48fe              LDR      r0,|L12.2224|
0004b8  f7fffffe          BL       GPIO_WriteBit
0004bc  2075              MOVS     r0,#0x75              ;599
0004be  7038              STRB     r0,[r7,#0]            ;599
0004c0  f8878001          STRB     r8,[r7,#1]
;;;601    			TxBuffer[2]='o';
0004c4  206f              MOVS     r0,#0x6f
0004c6  70b8              STRB     r0,[r7,#2]
;;;602    			TxBuffer[3]='_';					
0004c8  215f              MOVS     r1,#0x5f
0004ca  70f9              STRB     r1,[r7,#3]
;;;603    			TxBuffer[4]='a';		
0004cc  2061              MOVS     r0,#0x61
0004ce  e004              B        |L12.1242|
                  |L12.1232|
0004d0  e2b6              B        |L12.2624|
                  |L12.1234|
0004d2  e2b7              B        |L12.2628|
                  |L12.1236|
0004d4  e2b8              B        |L12.2632|
                  |L12.1238|
0004d6  e2b9              B        |L12.2636|
                  |L12.1240|
0004d8  e014              B        |L12.1284|
                  |L12.1242|
0004da  7138              STRB     r0,[r7,#4]
;;;604    			TxBuffer[5]='r';	
0004dc  2072              MOVS     r0,#0x72
0004de  7178              STRB     r0,[r7,#5]
;;;605    			TxBuffer[6]='m';	
0004e0  206d              MOVS     r0,#0x6d
0004e2  71b8              STRB     r0,[r7,#6]
;;;606    			TxBuffer[7]='_';	
0004e4  71f9              STRB     r1,[r7,#7]
;;;607    			TxBuffer[8]='k';	
0004e6  206b              MOVS     r0,#0x6b
0004e8  7238              STRB     r0,[r7,#8]
;;;608    			TxBuffer[9]='e';
0004ea  2065              MOVS     r0,#0x65
0004ec  7278              STRB     r0,[r7,#9]
;;;609    			TxBuffer[10]='y';	
0004ee  2079              MOVS     r0,#0x79
0004f0  72b8              STRB     r0,[r7,#0xa]
;;;610    	
;;;611    			txsize=11;
0004f2  200b              MOVS     r0,#0xb
0004f4  f8aa0000          STRH     r0,[r10,#0]
;;;612    			tekper=0;
0004f8  f8ab4000          STRH     r4,[r11,#0]
;;;613    			USART_SendData(USART2, 0x3A);
0004fc  213a              MOVS     r1,#0x3a
0004fe  4648              MOV      r0,r9
000500  f7fffffe          BL       USART_SendData
                  |L12.1284|
;;;614    		}
;;;615    	
;;;616    		// restart
;;;617    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='e')&(RxBuffer[4]=='s')&(RxBuffer[5]=='t')&(RxBuffer[6]=='a')&(RxBuffer[7]=='r')&(RxBuffer[8]=='t'))
000504  78b0              LDRB     r0,[r6,#2]  ; RxBuffer
000506  2872              CMP      r0,#0x72
000508  d07e              BEQ      |L12.1544|
00050a  2000              MOVS     r0,#0
                  |L12.1292|
00050c  78f1              LDRB     r1,[r6,#3]  ; RxBuffer
00050e  2965              CMP      r1,#0x65
000510  d07b              BEQ      |L12.1546|
000512  2100              MOVS     r1,#0
                  |L12.1300|
000514  4008              ANDS     r0,r0,r1
000516  7931              LDRB     r1,[r6,#4]  ; RxBuffer
000518  2973              CMP      r1,#0x73
00051a  d077              BEQ      |L12.1548|
00051c  2100              MOVS     r1,#0
                  |L12.1310|
00051e  4008              ANDS     r0,r0,r1
000520  7971              LDRB     r1,[r6,#5]  ; RxBuffer
000522  2974              CMP      r1,#0x74
000524  d073              BEQ      |L12.1550|
000526  2100              MOVS     r1,#0
                  |L12.1320|
000528  4008              ANDS     r0,r0,r1
00052a  79b1              LDRB     r1,[r6,#6]  ; RxBuffer
00052c  2961              CMP      r1,#0x61
00052e  d06f              BEQ      |L12.1552|
000530  2100              MOVS     r1,#0
                  |L12.1330|
000532  4008              ANDS     r0,r0,r1
000534  79f1              LDRB     r1,[r6,#7]  ; RxBuffer
000536  2972              CMP      r1,#0x72
000538  d06b              BEQ      |L12.1554|
00053a  2100              MOVS     r1,#0
                  |L12.1340|
00053c  4008              ANDS     r0,r0,r1
00053e  7a31              LDRB     r1,[r6,#8]  ; RxBuffer
000540  2974              CMP      r1,#0x74
000542  d067              BEQ      |L12.1556|
000544  2100              MOVS     r1,#0
                  |L12.1350|
000546  4208              TST      r0,r1
000548  d02e              BEQ      |L12.1448|
;;;618    		{
;;;619    			
;;;620    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
00054a  2200              MOVS     r2,#0
00054c  f2405125          MOV      r1,#0x525
000550  4648              MOV      r0,r9
000552  f7fffffe          BL       USART_ITConfig
;;;621    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
000556  2201              MOVS     r2,#1
000558  f2406126          MOV      r1,#0x626
00055c  4648              MOV      r0,r9
00055e  f7fffffe          BL       USART_ITConfig
;;;622    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
000562  2201              MOVS     r2,#1
000564  2108              MOVS     r1,#8
000566  48d2              LDR      r0,|L12.2224|
000568  f7fffffe          BL       GPIO_WriteBit
;;;623    			
;;;624    			TxBuffer[0]='r';
00056c  2172              MOVS     r1,#0x72
00056e  7039              STRB     r1,[r7,#0]
;;;625    			TxBuffer[1]='e';	
000570  2065              MOVS     r0,#0x65
000572  7078              STRB     r0,[r7,#1]
;;;626    			TxBuffer[2]='s';
000574  f8878002          STRB     r8,[r7,#2]
;;;627    			TxBuffer[3]='t';					
000578  2274              MOVS     r2,#0x74
00057a  70fa              STRB     r2,[r7,#3]
;;;628    			TxBuffer[4]='a';		
00057c  2061              MOVS     r0,#0x61
00057e  7138              STRB     r0,[r7,#4]
;;;629    			TxBuffer[5]='r';	
000580  7179              STRB     r1,[r7,#5]
;;;630    			TxBuffer[6]='t';	
000582  71ba              STRB     r2,[r7,#6]
;;;631    			TxBuffer[7]='_';	
000584  205f              MOVS     r0,#0x5f
000586  71f8              STRB     r0,[r7,#7]
;;;632    			TxBuffer[8]='o';	
000588  206f              MOVS     r0,#0x6f
00058a  7238              STRB     r0,[r7,#8]
;;;633    			TxBuffer[9]='k';
00058c  206b              MOVS     r0,#0x6b
00058e  7278              STRB     r0,[r7,#9]
;;;634    	
;;;635    			txsize=10;
000590  200a              MOVS     r0,#0xa
000592  f8aa0000          STRH     r0,[r10,#0]
;;;636    			tekper=0;
000596  f8ab4000          STRH     r4,[r11,#0]
;;;637    			USART_SendData(USART2, 0x3A);
00059a  213a              MOVS     r1,#0x3a
00059c  4648              MOV      r0,r9
00059e  f7fffffe          BL       USART_SendData
;;;638    			
;;;639    			SCB->AIRCR = 0x05FA0004;
0005a2  49c5              LDR      r1,|L12.2232|
0005a4  48c3              LDR      r0,|L12.2228|
0005a6  6008              STR      r0,[r1,#0]
                  |L12.1448|
;;;640    			
;;;641    			
;;;642    			
;;;643    			// need restart
;;;644    		}
;;;645    	
;;;646    		// set_time
;;;647    		if ((RxBuffer[2]=='s')&(RxBuffer[3]=='e')&(RxBuffer[4]=='t')&(RxBuffer[5]=='_')&(RxBuffer[6]=='t')&(RxBuffer[7]=='i')&(RxBuffer[8]=='m')&(RxBuffer[9]=='e'))
0005a8  78b0              LDRB     r0,[r6,#2]  ; RxBuffer
0005aa  2873              CMP      r0,#0x73
0005ac  d07e              BEQ      |L12.1708|
0005ae  2000              MOVS     r0,#0
                  |L12.1456|
0005b0  78f1              LDRB     r1,[r6,#3]  ; RxBuffer
0005b2  2965              CMP      r1,#0x65
0005b4  d07b              BEQ      |L12.1710|
0005b6  2100              MOVS     r1,#0
                  |L12.1464|
0005b8  4008              ANDS     r0,r0,r1
0005ba  7931              LDRB     r1,[r6,#4]  ; RxBuffer
0005bc  2974              CMP      r1,#0x74
0005be  d077              BEQ      |L12.1712|
0005c0  2100              MOVS     r1,#0
                  |L12.1474|
0005c2  4008              ANDS     r0,r0,r1
0005c4  7971              LDRB     r1,[r6,#5]  ; RxBuffer
0005c6  295f              CMP      r1,#0x5f
0005c8  d073              BEQ      |L12.1714|
0005ca  2100              MOVS     r1,#0
                  |L12.1484|
0005cc  4008              ANDS     r0,r0,r1
0005ce  79b1              LDRB     r1,[r6,#6]  ; RxBuffer
0005d0  2974              CMP      r1,#0x74
0005d2  d06f              BEQ      |L12.1716|
0005d4  2100              MOVS     r1,#0
                  |L12.1494|
0005d6  4008              ANDS     r0,r0,r1
0005d8  79f1              LDRB     r1,[r6,#7]  ; RxBuffer
0005da  2969              CMP      r1,#0x69
0005dc  d06b              BEQ      |L12.1718|
0005de  2100              MOVS     r1,#0
                  |L12.1504|
0005e0  4008              ANDS     r0,r0,r1
0005e2  7a31              LDRB     r1,[r6,#8]  ; RxBuffer
0005e4  296d              CMP      r1,#0x6d
0005e6  d067              BEQ      |L12.1720|
0005e8  2100              MOVS     r1,#0
                  |L12.1514|
0005ea  4008              ANDS     r0,r0,r1
0005ec  7a71              LDRB     r1,[r6,#9]  ; RxBuffer
0005ee  2965              CMP      r1,#0x65
0005f0  d07d              BEQ      |L12.1774|
0005f2  2100              MOVS     r1,#0
                  |L12.1524|
0005f4  4208              TST      r0,r1
0005f6  d07b              BEQ      |L12.1776|
;;;648    		{		
;;;649    			extern void rtc_SetDate(uint8_t Day, uint8_t Month, uint8_t Year, uint8_t DayOfWeek);
;;;650    			extern  void rtc_SetTime(uint8_t Hours, uint8_t Minutes, uint8_t Seconds);
;;;651    			extern  void rtc_Unlock(void);
;;;652    			extern void rtc_Lock(void);
;;;653    			
;;;654    			uint32_t Tens, Units;
;;;655          uint32_t TempReg = 0;
;;;656    			u8 i=0;
;;;657    			
;;;658    			
;;;659    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
0005f8  2200              MOVS     r2,#0
0005fa  f2405125          MOV      r1,#0x525
0005fe  4648              MOV      r0,r9
000600  f7fffffe          BL       USART_ITConfig
;;;660    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
000604  2201              MOVS     r2,#1
000606  e006              B        |L12.1558|
                  |L12.1544|
000608  e222              B        |L12.2640|
                  |L12.1546|
00060a  e223              B        |L12.2644|
                  |L12.1548|
00060c  e224              B        |L12.2648|
                  |L12.1550|
00060e  e225              B        |L12.2652|
                  |L12.1552|
000610  e226              B        |L12.2656|
                  |L12.1554|
000612  e227              B        |L12.2660|
                  |L12.1556|
000614  e228              B        |L12.2664|
                  |L12.1558|
000616  f2406126          MOV      r1,#0x626
00061a  4648              MOV      r0,r9
00061c  f7fffffe          BL       USART_ITConfig
;;;661    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
000620  2201              MOVS     r2,#1
000622  2108              MOVS     r1,#8
000624  48a2              LDR      r0,|L12.2224|
000626  f7fffffe          BL       GPIO_WriteBit
;;;662    
;;;663    
;;;664    			// set time
;;;665    		rtc_Unlock();
00062a  f7fffffe          BL       rtc_Unlock
;;;666    		RTC->ISR |= RTC_ISR_INIT;
00062e  48a3              LDR      r0,|L12.2236|
000630  6801              LDR      r1,[r0,#0]
000632  f0410180          ORR      r1,r1,#0x80
000636  6001              STR      r1,[r0,#0]
                  |L12.1592|
;;;667    		while(!(RTC->ISR & RTC_ISR_INITF)) {}
000638  48a0              LDR      r0,|L12.2236|
00063a  6800              LDR      r0,[r0,#0]
00063c  0640              LSLS     r0,r0,#25
00063e  d5fb              BPL      |L12.1592|
;;;668    
;;;669    		RTC->PRER = 263; //Sync;         
000640  489e              LDR      r0,|L12.2236|
000642  f2401107          MOV      r1,#0x107
000646  1d00              ADDS     r0,r0,#4
000648  6001              STR      r1,[r0,#0]
;;;670        RTC->PRER =263 | (127<<16); //Sync | (Async << 16);
00064a  499d              LDR      r1,|L12.2240|
00064c  6001              STR      r1,[r0,#0]
;;;671    			
;;;672    			
;;;673    			TxBuffer[0]='s';
00064e  f8878000          STRB     r8,[r7,#0]
;;;674    			TxBuffer[1]='e';	
000652  2065              MOVS     r0,#0x65
000654  7078              STRB     r0,[r7,#1]
;;;675    			TxBuffer[2]='t';
000656  2274              MOVS     r2,#0x74
000658  70ba              STRB     r2,[r7,#2]
;;;676    			TxBuffer[3]='_';					
00065a  215f              MOVS     r1,#0x5f
00065c  70f9              STRB     r1,[r7,#3]
;;;677    			TxBuffer[4]='t';		
00065e  713a              STRB     r2,[r7,#4]
;;;678    			TxBuffer[5]='i';	
000660  2269              MOVS     r2,#0x69
000662  717a              STRB     r2,[r7,#5]
;;;679    			TxBuffer[6]='m';	
000664  226d              MOVS     r2,#0x6d
000666  71ba              STRB     r2,[r7,#6]
;;;680    			TxBuffer[7]='e';	
000668  71f8              STRB     r0,[r7,#7]
;;;681    			TxBuffer[8]='_';	
00066a  7239              STRB     r1,[r7,#8]
;;;682    			TxBuffer[9]='o';
00066c  206f              MOVS     r0,#0x6f
00066e  7278              STRB     r0,[r7,#9]
;;;683    			TxBuffer[10]='k';
000670  206b              MOVS     r0,#0x6b
000672  72b8              STRB     r0,[r7,#0xa]
;;;684    			
;;;685    
;;;686        // set time
;;;687    rtc_SetTime((RxBuffer[16]-0x30)*10+(RxBuffer[17]-0x30), (RxBuffer[18]-0x30)*10+(RxBuffer[19]-0x30), (RxBuffer[20]-0x30)*10+(RxBuffer[21]-0x30));
000674  7d30              LDRB     r0,[r6,#0x14]  ; RxBuffer
000676  7d71              LDRB     r1,[r6,#0x15]  ; RxBuffer
000678  3830              SUBS     r0,r0,#0x30
00067a  eb000280          ADD      r2,r0,r0,LSL #2
00067e  f06f082f          MVN      r8,#0x2f
000682  eb080042          ADD      r0,r8,r2,LSL #1
000686  4408              ADD      r0,r0,r1
000688  b2c2              UXTB     r2,r0
00068a  7cb0              LDRB     r0,[r6,#0x12]  ; RxBuffer
00068c  7cf1              LDRB     r1,[r6,#0x13]  ; RxBuffer
00068e  3830              SUBS     r0,r0,#0x30
000690  eb000380          ADD      r3,r0,r0,LSL #2
000694  eb080043          ADD      r0,r8,r3,LSL #1
000698  4408              ADD      r0,r0,r1
00069a  b2c1              UXTB     r1,r0
00069c  7c30              LDRB     r0,[r6,#0x10]  ; RxBuffer
00069e  7c73              LDRB     r3,[r6,#0x11]  ; RxBuffer
0006a0  3830              SUBS     r0,r0,#0x30
0006a2  eb000c80          ADD      r12,r0,r0,LSL #2
0006a6  eb08004c          ADD      r0,r8,r12,LSL #1
0006aa  e006              B        |L12.1722|
                  |L12.1708|
0006ac  e1de              B        |L12.2668|
                  |L12.1710|
0006ae  e1df              B        |L12.2672|
                  |L12.1712|
0006b0  e1e3              B        |L12.2682|
                  |L12.1714|
0006b2  e1e4              B        |L12.2686|
                  |L12.1716|
0006b4  e1e5              B        |L12.2690|
                  |L12.1718|
0006b6  e1e6              B        |L12.2694|
                  |L12.1720|
0006b8  e1e7              B        |L12.2698|
                  |L12.1722|
0006ba  4418              ADD      r0,r0,r3
0006bc  b2c0              UXTB     r0,r0
0006be  f7fffffe          BL       rtc_SetTime
;;;688    
;;;689    rtc_SetDate((RxBuffer[10]-0x30)*10+(RxBuffer[11]-0x30), (RxBuffer[12]-0x30)*10+(RxBuffer[13]-0x30), (RxBuffer[14]-0x30)*10+(RxBuffer[15]-0x30),1);
0006c2  7bb0              LDRB     r0,[r6,#0xe]  ; RxBuffer
0006c4  7bf1              LDRB     r1,[r6,#0xf]  ; RxBuffer
0006c6  3830              SUBS     r0,r0,#0x30
0006c8  eb000280          ADD      r2,r0,r0,LSL #2
0006cc  eb080042          ADD      r0,r8,r2,LSL #1
0006d0  4408              ADD      r0,r0,r1
0006d2  b2c2              UXTB     r2,r0
0006d4  7b30              LDRB     r0,[r6,#0xc]  ; RxBuffer
0006d6  7b71              LDRB     r1,[r6,#0xd]  ; RxBuffer
0006d8  3830              SUBS     r0,r0,#0x30
0006da  eb000380          ADD      r3,r0,r0,LSL #2
0006de  eb080043          ADD      r0,r8,r3,LSL #1
0006e2  4408              ADD      r0,r0,r1
0006e4  b2c1              UXTB     r1,r0
0006e6  7ab0              LDRB     r0,[r6,#0xa]  ; RxBuffer
0006e8  7af3              LDRB     r3,[r6,#0xb]  ; RxBuffer
0006ea  3830              SUBS     r0,r0,#0x30
0006ec  e001              B        |L12.1778|
                  |L12.1774|
0006ee  e1d1              B        |L12.2708|
                  |L12.1776|
0006f0  e02d              B        |L12.1870|
                  |L12.1778|
0006f2  eb000c80          ADD      r12,r0,r0,LSL #2
0006f6  eb08004c          ADD      r0,r8,r12,LSL #1
0006fa  4418              ADD      r0,r0,r3
0006fc  b2c0              UXTB     r0,r0
0006fe  2301              MOVS     r3,#1
000700  f7fffffe          BL       rtc_SetDate
;;;690    /*
;;;691    if (1)
;;;692    {
;;;693    
;;;694        TempReg = 0;
;;;695        {
;;;696            Tens  = ((RxBuffer[10]-0x30) / 10) & 0x0f;          // ??????? ???
;;;697            Units = (RxBuffer[11]-0x30) & 0x0f; // ??????? ???
;;;698            
;;;699            TempReg |= (Tens  << 20); // YT, 20
;;;700            TempReg |= (Units << 16); // YU, 16
;;;701        }
;;;702        {
;;;703            Tens  = (RxBuffer[12]-0x30) & 0x01;          // ??????? ???????
;;;704            Units = (RxBuffer[13]-0x30) & 0x0f; // ??????? ???????
;;;705            
;;;706            TempReg |= (Tens  << 12); // MT, 12
;;;707            TempReg |= (Units << 8);  // MU, 8
;;;708        }
;;;709        {
;;;710            Tens  = (RxBuffer[14]-0x30) & 0x03;          // ??????? ????
;;;711            Units = (RxBuffer[15]-0x30) & 0x0f; // ??????? ????
;;;712            
;;;713            TempReg |= (Tens  << 4); // DT, 4
;;;714            TempReg |= (Units << 0);  // DU, 0
;;;715        }
;;;716        {
;;;717            TempReg |= ((1 & 0x07) << 13); // WDU, 13
;;;718        }
;;;719        RTC->DR = TempReg;	
;;;720    	}	
;;;721    */
;;;722    		RTC->CR |= RTC_CR_FMT;
000704  486d              LDR      r0,|L12.2236|
000706  1f00              SUBS     r0,r0,#4
000708  6801              LDR      r1,[r0,#0]
00070a  f0410140          ORR      r1,r1,#0x40
00070e  6001              STR      r1,[r0,#0]
;;;723        RTC->ISR &= ~RTC_ISR_INIT;
000710  1d00              ADDS     r0,r0,#4
000712  6801              LDR      r1,[r0,#0]
000714  f0210180          BIC      r1,r1,#0x80
000718  6001              STR      r1,[r0,#0]
;;;724    		rtc_Lock();
00071a  f7fffffe          BL       rtc_Lock
                  |L12.1822|
;;;725    
;;;726    	
;;;727    		rtc_Get(&DT1);
;;;728    //			while (TempReg!=RTC->DR)
;;;729    		while (((RxBuffer[10]-0x30)*10+(RxBuffer[11]-0x30))!=DT1.Day)
;;;730    				rtc_Get(&DT1);
00071e  4869              LDR      r0,|L12.2244|
000720  f7fffffe          BL       rtc_Get
000724  7ab0              LDRB     r0,[r6,#0xa]          ;729  ; RxBuffer
000726  7af1              LDRB     r1,[r6,#0xb]          ;729  ; RxBuffer
000728  3830              SUBS     r0,r0,#0x30           ;729
00072a  eb000280          ADD      r2,r0,r0,LSL #2       ;729
00072e  eb080042          ADD      r0,r8,r2,LSL #1       ;729
000732  4401              ADD      r1,r1,r0              ;729
000734  4863              LDR      r0,|L12.2244|
000736  7880              LDRB     r0,[r0,#2]            ;729  ; DT1
000738  4281              CMP      r1,r0                 ;729
00073a  d1f0              BNE      |L12.1822|
;;;731    
;;;732    				
;;;733    			txsize=11;
00073c  200b              MOVS     r0,#0xb
00073e  f8aa0000          STRH     r0,[r10,#0]
;;;734    			tekper=0;
000742  f8ab4000          STRH     r4,[r11,#0]
;;;735    			USART_SendData(USART2, 0x3A);
000746  213a              MOVS     r1,#0x3a
000748  4648              MOV      r0,r9
00074a  f7fffffe          BL       USART_SendData
                  |L12.1870|
;;;736    			
;;;737    			// need restart
;;;738    		}
;;;739    		
;;;740    		// read
;;;741    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='e')&(RxBuffer[4]=='a')&(RxBuffer[5]=='d'))
00074e  78b0              LDRB     r0,[r6,#2]  ; RxBuffer
000750  2872              CMP      r0,#0x72
000752  d07d              BEQ      |L12.2128|
000754  2000              MOVS     r0,#0
                  |L12.1878|
000756  78f1              LDRB     r1,[r6,#3]  ; RxBuffer
000758  2965              CMP      r1,#0x65
00075a  d07a              BEQ      |L12.2130|
00075c  2100              MOVS     r1,#0
                  |L12.1886|
00075e  4008              ANDS     r0,r0,r1
000760  7931              LDRB     r1,[r6,#4]  ; RxBuffer
000762  2961              CMP      r1,#0x61
000764  d076              BEQ      |L12.2132|
000766  2100              MOVS     r1,#0
                  |L12.1896|
000768  4008              ANDS     r0,r0,r1
00076a  4957              LDR      r1,|L12.2248|
00076c  7949              LDRB     r1,[r1,#5]  ; RxBuffer
00076e  2964              CMP      r1,#0x64
000770  d071              BEQ      |L12.2134|
000772  2100              MOVS     r1,#0
                  |L12.1908|
000774  4208              TST      r0,r1
000776  d06f              BEQ      |L12.2136|
;;;742    		{
;;;743    			
;;;744    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
000778  2200              MOVS     r2,#0
00077a  f2405125          MOV      r1,#0x525
00077e  4648              MOV      r0,r9
000780  f7fffffe          BL       USART_ITConfig
;;;745    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
000784  2201              MOVS     r2,#1
000786  f2406126          MOV      r1,#0x626
00078a  4648              MOV      r0,r9
00078c  f7fffffe          BL       USART_ITConfig
;;;746    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
000790  2201              MOVS     r2,#1
000792  2108              MOVS     r1,#8
000794  4846              LDR      r0,|L12.2224|
000796  f7fffffe          BL       GPIO_WriteBit
;;;747    			
;;;748    			// test zapis for controlling time on fleshka
;;;749    			tmp=por;
00079a  484c              LDR      r0,|L12.2252|
;;;750    			TxBuffer[0]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
00079c  f44f727a          MOV      r2,#0x3e8
;;;751    			tmp%=1000;
;;;752    			TxBuffer[1]=(uint8_t)(tmp/100)+(uint8_t)0x30;
;;;753    			tmp%=100;		
;;;754    			TxBuffer[2]=(uint8_t)(tmp/10)+(uint8_t)0x30;
;;;755    			tmp%=10;	
;;;756    			TxBuffer[3]=(uint8_t)(tmp)+(uint8_t)0x30;		
;;;757    				
;;;758    			TxBuffer[4]=0x20;	
;;;759    
;;;760    			// date
;;;761    			TxBuffer[5]=(uint8_t)(DT1.Year/10)+(uint8_t)0x30;	
0007a0  f8df8120          LDR      r8,|L12.2244|
0007a4  8800              LDRH     r0,[r0,#0]            ;749  ; por
0007a6  fbb0f1f2          UDIV     r1,r0,r2              ;750
0007aa  f1010330          ADD      r3,r1,#0x30           ;750
0007ae  703b              STRB     r3,[r7,#0]            ;750
0007b0  fb020011          MLS      r0,r2,r1,r0           ;751
0007b4  2364              MOVS     r3,#0x64              ;752
0007b6  fbb0f1f3          UDIV     r1,r0,r3              ;752
0007ba  f1010630          ADD      r6,r1,#0x30           ;752
0007be  fb030111          MLS      r1,r3,r1,r0           ;753
0007c2  707e              STRB     r6,[r7,#1]            ;752
0007c4  200a              MOVS     r0,#0xa               ;754
0007c6  fbb1f6f0          UDIV     r6,r1,r0              ;754
0007ca  fb001116          MLS      r1,r0,r6,r1           ;755
0007ce  f1060c30          ADD      r12,r6,#0x30          ;754
0007d2  f887c002          STRB     r12,[r7,#2]           ;754
0007d6  3130              ADDS     r1,r1,#0x30           ;756
0007d8  70f9              STRB     r1,[r7,#3]            ;756
0007da  2120              MOVS     r1,#0x20              ;758
0007dc  7139              STRB     r1,[r7,#4]            ;758
0007de  f898c000          LDRB     r12,[r8,#0]  ; DT1
0007e2  fbbcfef0          UDIV     lr,r12,r0
0007e6  f10e0630          ADD      r6,lr,#0x30
0007ea  717e              STRB     r6,[r7,#5]
;;;762    			TxBuffer[6]=(uint8_t)(DT1.Year%10)+(uint8_t)0x30;	
0007ec  fb00c61e          MLS      r6,r0,lr,r12
0007f0  3630              ADDS     r6,r6,#0x30
0007f2  71be              STRB     r6,[r7,#6]
;;;763    			TxBuffer[7]=(uint8_t)(DT1.Month/10)+(uint8_t)0x30;	
0007f4  f898c001          LDRB     r12,[r8,#1]  ; DT1
0007f8  fbbcfef0          UDIV     lr,r12,r0
0007fc  f10e0630          ADD      r6,lr,#0x30
000800  71fe              STRB     r6,[r7,#7]
;;;764    			TxBuffer[8]=(uint8_t)(DT1.Month%10)+(uint8_t)0x30;	
000802  fb00c61e          MLS      r6,r0,lr,r12
000806  3630              ADDS     r6,r6,#0x30
000808  723e              STRB     r6,[r7,#8]
;;;765    			TxBuffer[9]=(uint8_t)(DT1.Day/10)+(uint8_t)0x30;	
00080a  f898c002          LDRB     r12,[r8,#2]  ; DT1
00080e  fbbcfef0          UDIV     lr,r12,r0
000812  f10e0630          ADD      r6,lr,#0x30
000816  727e              STRB     r6,[r7,#9]
;;;766    			TxBuffer[10]=(uint8_t)(DT1.Day%10)+(uint8_t)0x30;	
000818  fb00c61e          MLS      r6,r0,lr,r12
00081c  3630              ADDS     r6,r6,#0x30
00081e  72be              STRB     r6,[r7,#0xa]
;;;767    			TxBuffer[11]=0x20;				
000820  72f9              STRB     r1,[r7,#0xb]
;;;768    			
;;;769    			// time
;;;770    			TxBuffer[12]=(uint8_t)(DT1.Hours/10)+(uint8_t)0x30;	
000822  f898c004          LDRB     r12,[r8,#4]  ; DT1
000826  fbbcfef0          UDIV     lr,r12,r0
00082a  f10e0630          ADD      r6,lr,#0x30
00082e  733e              STRB     r6,[r7,#0xc]
;;;771    			TxBuffer[13]=(uint8_t)(DT1.Hours%10)+(uint8_t)0x30;			
000830  fb00c61e          MLS      r6,r0,lr,r12
000834  3630              ADDS     r6,r6,#0x30
000836  737e              STRB     r6,[r7,#0xd]
;;;772    			TxBuffer[14]=(uint8_t)(DT1.Minutes/10)+(uint8_t)0x30;	
000838  f898c005          LDRB     r12,[r8,#5]  ; DT1
00083c  fbbcfef0          UDIV     lr,r12,r0
000840  f10e0630          ADD      r6,lr,#0x30
000844  73be              STRB     r6,[r7,#0xe]
;;;773    			TxBuffer[15]=(uint8_t)(DT1.Minutes%10)+(uint8_t)0x30;	
000846  fb00c61e          MLS      r6,r0,lr,r12
00084a  3630              ADDS     r6,r6,#0x30
00084c  73fe              STRB     r6,[r7,#0xf]
;;;774    			TxBuffer[16]=(uint8_t)(DT1.Seconds/10)+(uint8_t)0x30;	
00084e  e004              B        |L12.2138|
                  |L12.2128|
000850  e122              B        |L12.2712|
                  |L12.2130|
000852  e123              B        |L12.2716|
                  |L12.2132|
000854  e124              B        |L12.2720|
                  |L12.2134|
000856  e125              B        |L12.2724|
                  |L12.2136|
000858  e097              B        |L12.2442|
                  |L12.2138|
00085a  f898c006          LDRB     r12,[r8,#6]  ; DT1
00085e  fbbcf8f0          UDIV     r8,r12,r0
000862  f1080630          ADD      r6,r8,#0x30
000866  743e              STRB     r6,[r7,#0x10]
;;;775    			TxBuffer[17]=(uint8_t)(DT1.Seconds%10)+(uint8_t)0x30;	
000868  fb00c618          MLS      r6,r0,r8,r12
00086c  3630              ADDS     r6,r6,#0x30
00086e  747e              STRB     r6,[r7,#0x11]
;;;776    			TxBuffer[18]=0x20;
000870  74b9              STRB     r1,[r7,#0x12]
;;;777    			
;;;778    			// dat pribl
;;;779    			TxBuffer[19]=sost_pribl+0x30;
000872  782d              LDRB     r5,[r5,#0]  ; sost_pribl
000874  3530              ADDS     r5,r5,#0x30
000876  74fd              STRB     r5,[r7,#0x13]
;;;780    			TxBuffer[20]=0x20;
;;;781    			
;;;782    			
;;;783    			// zn from adc with calibr and averaging
;;;784    			tmp=ADC3ConvertedValue;
000878  4d15              LDR      r5,|L12.2256|
00087a  7539              STRB     r1,[r7,#0x14]         ;780
00087c  882d              LDRH     r5,[r5,#0]  ; ADC3ConvertedValue
;;;785    			TxBuffer[21]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
00087e  fbb5f6f2          UDIV     r6,r5,r2
000882  f1060c30          ADD      r12,r6,#0x30
;;;786    			tmp%=1000;
000886  fb025516          MLS      r5,r2,r6,r5
;;;787    			TxBuffer[22]=(uint8_t)(tmp/100)+(uint8_t)0x30;
00088a  fbb5f6f3          UDIV     r6,r5,r3
00088e  f887c015          STRB     r12,[r7,#0x15]        ;785
000892  f1060c30          ADD      r12,r6,#0x30
;;;788    			tmp%=100;		
000896  fb035516          MLS      r5,r3,r6,r5
;;;789    			TxBuffer[23]=(uint8_t)(tmp/10)+(uint8_t)0x30;
00089a  fbb5f6f0          UDIV     r6,r5,r0
00089e  f887c016          STRB     r12,[r7,#0x16]        ;787
0008a2  f1060c30          ADD      r12,r6,#0x30
;;;790    			tmp%=10;	
0008a6  fb005516          MLS      r5,r0,r6,r5
0008aa  f887c017          STRB     r12,[r7,#0x17]        ;789
;;;791    			TxBuffer[24]=(uint8_t)(tmp)+(uint8_t)0x30;
0008ae  e011              B        |L12.2260|
                  |L12.2224|
                          DCD      0x40020c00
                  |L12.2228|
                          DCD      0x05fa0004
                  |L12.2232|
                          DCD      0xe000ed0c
                  |L12.2236|
                          DCD      0x4000280c
                  |L12.2240|
                          DCD      0x007f0107
                  |L12.2244|
                          DCD      ||.data||+0xc
                  |L12.2248|
                          DCD      RxBuffer
                  |L12.2252|
                          DCD      por
                  |L12.2256|
                          DCD      ADC3ConvertedValue
                  |L12.2260|
0008d4  3530              ADDS     r5,r5,#0x30
0008d6  763d              STRB     r5,[r7,#0x18]
;;;792    			TxBuffer[25]=0x20;		
;;;793    			
;;;794    			tmp=fz_average[0];
0008d8  4d7b              LDR      r5,|L12.2760|
0008da  7679              STRB     r1,[r7,#0x19]         ;792
0008dc  882d              LDRH     r5,[r5,#0]  ; fz_average
;;;795    			TxBuffer[26]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
0008de  fbb5f6f2          UDIV     r6,r5,r2
0008e2  f1060c30          ADD      r12,r6,#0x30
;;;796    			tmp%=1000;
0008e6  fb025516          MLS      r5,r2,r6,r5
;;;797    			TxBuffer[27]=(uint8_t)(tmp/100)+(uint8_t)0x30;
0008ea  fbb5f6f3          UDIV     r6,r5,r3
0008ee  f887c01a          STRB     r12,[r7,#0x1a]        ;795
0008f2  f1060c30          ADD      r12,r6,#0x30
;;;798    			tmp%=100;		
0008f6  fb035516          MLS      r5,r3,r6,r5
;;;799    			TxBuffer[28]=(uint8_t)(tmp/10)+(uint8_t)0x30;
0008fa  fbb5f6f0          UDIV     r6,r5,r0
0008fe  f887c01b          STRB     r12,[r7,#0x1b]        ;797
;;;800    			tmp%=10;	
000902  fb005516          MLS      r5,r0,r6,r5
000906  f1060c30          ADD      r12,r6,#0x30          ;799
00090a  f887c01c          STRB     r12,[r7,#0x1c]        ;799
;;;801    			TxBuffer[29]=(uint8_t)(tmp)+(uint8_t)0x30;		
00090e  3530              ADDS     r5,r5,#0x30
000910  777d              STRB     r5,[r7,#0x1d]
;;;802    			TxBuffer[30]=0x20;
;;;803    			
;;;804    			tmp=max[0];
000912  4d6e              LDR      r5,|L12.2764|
000914  77b9              STRB     r1,[r7,#0x1e]         ;802
000916  882d              LDRH     r5,[r5,#0]  ; max
;;;805    			TxBuffer[31]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
000918  fbb5f6f2          UDIV     r6,r5,r2
;;;806    			tmp%=1000;
00091c  fb025216          MLS      r2,r2,r6,r5
;;;807    			TxBuffer[32]=(uint8_t)(tmp/100)+(uint8_t)0x30;
000920  fbb2f5f3          UDIV     r5,r2,r3
;;;808    			tmp%=100;		
000924  fb032215          MLS      r2,r3,r5,r2
;;;809    			TxBuffer[33]=(uint8_t)(tmp/10)+(uint8_t)0x30;
000928  fbb2f3f0          UDIV     r3,r2,r0
00092c  f1060c30          ADD      r12,r6,#0x30          ;805
000930  f1050630          ADD      r6,r5,#0x30           ;807
000934  f887c01f          STRB     r12,[r7,#0x1f]        ;805
;;;810    			tmp%=10;	
000938  fb002013          MLS      r0,r0,r3,r2
00093c  f8876020          STRB     r6,[r7,#0x20]         ;807
000940  f1030530          ADD      r5,r3,#0x30           ;809
000944  f8875021          STRB     r5,[r7,#0x21]         ;809
;;;811    			TxBuffer[34]=(uint8_t)(tmp)+(uint8_t)0x30;		
000948  3030              ADDS     r0,r0,#0x30
00094a  f8870022          STRB     r0,[r7,#0x22]
;;;812    
;;;813    			TxBuffer[35]=0x20;
;;;814    			TxBuffer[36]=(uint8_t)(avariya)+(uint8_t)0x30;	
00094e  4860              LDR      r0,|L12.2768|
000950  f8871023          STRB     r1,[r7,#0x23]         ;813
000954  7800              LDRB     r0,[r0,#0]  ; avariya
000956  3030              ADDS     r0,r0,#0x30
000958  f8870024          STRB     r0,[r7,#0x24]
;;;815    
;;;816    			TxBuffer[37]=0x20;
;;;817    			TxBuffer[38]=(uint8_t)(sost_flesh)+(uint8_t)0x30;
00095c  485d              LDR      r0,|L12.2772|
00095e  f8871025          STRB     r1,[r7,#0x25]         ;816
000962  7800              LDRB     r0,[r0,#0]  ; sost_flesh
000964  3030              ADDS     r0,r0,#0x30
000966  f8870026          STRB     r0,[r7,#0x26]
;;;818    			
;;;819    			TxBuffer[39]=0x20;
;;;820    			TxBuffer[40]=(uint8_t)(conf.tek_gr_kal)+(uint8_t)0x30;
00096a  485b              LDR      r0,|L12.2776|
00096c  f8871027          STRB     r1,[r7,#0x27]         ;819
;;;821    		/*
;;;822         + need:
;;;823    			1 avariya   
;;;824    			2 zapis norm or error  
;;;825    			3 tek gr kal
;;;826    */
;;;827    			txsize=41;
000970  2129              MOVS     r1,#0x29
000972  78c0              LDRB     r0,[r0,#3]            ;820  ; conf
000974  3030              ADDS     r0,r0,#0x30           ;820
000976  f8870028          STRB     r0,[r7,#0x28]         ;820
00097a  f8aa1000          STRH     r1,[r10,#0]
;;;828    			tekper=0;
00097e  f8ab4000          STRH     r4,[r11,#0]
;;;829    			USART_SendData(USART2, 0x3A);
000982  213a              MOVS     r1,#0x3a
000984  4648              MOV      r0,r9
000986  f7fffffe          BL       USART_SendData
                  |L12.2442|
;;;830    		}		
;;;831    		
;;;832    		// read_conf
;;;833    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='d')&(RxBuffer[4]=='_')&(RxBuffer[5]=='c')&(RxBuffer[6]=='o')&(RxBuffer[7]=='n')&(RxBuffer[8]=='f'))
00098a  4a54              LDR      r2,|L12.2780|
00098c  7890              LDRB     r0,[r2,#2]  ; RxBuffer
00098e  2872              CMP      r0,#0x72
000990  d070              BEQ      |L12.2676|
000992  2000              MOVS     r0,#0
                  |L12.2452|
000994  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
000996  2964              CMP      r1,#0x64
000998  d06d              BEQ      |L12.2678|
00099a  2100              MOVS     r1,#0
                  |L12.2460|
00099c  4008              ANDS     r0,r0,r1
00099e  7911              LDRB     r1,[r2,#4]  ; RxBuffer
0009a0  295f              CMP      r1,#0x5f
0009a2  d069              BEQ      |L12.2680|
0009a4  2100              MOVS     r1,#0
                  |L12.2470|
0009a6  4008              ANDS     r0,r0,r1
0009a8  7951              LDRB     r1,[r2,#5]  ; RxBuffer
0009aa  2963              CMP      r1,#0x63
0009ac  d06f              BEQ      |L12.2702|
0009ae  2100              MOVS     r1,#0
                  |L12.2480|
0009b0  4008              ANDS     r0,r0,r1
0009b2  7991              LDRB     r1,[r2,#6]  ; RxBuffer
0009b4  296f              CMP      r1,#0x6f
0009b6  d06b              BEQ      |L12.2704|
0009b8  2100              MOVS     r1,#0
                  |L12.2490|
0009ba  4008              ANDS     r0,r0,r1
0009bc  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
0009be  296e              CMP      r1,#0x6e
0009c0  d07d              BEQ      |L12.2750|
0009c2  2100              MOVS     r1,#0
                  |L12.2500|
0009c4  4008              ANDS     r0,r0,r1
0009c6  7a11              LDRB     r1,[r2,#8]  ; RxBuffer
0009c8  2966              CMP      r1,#0x66
0009ca  d07a              BEQ      |L12.2754|
0009cc  2100              MOVS     r1,#0
                  |L12.2510|
0009ce  4208              TST      r0,r1
0009d0  d022              BEQ      |L12.2584|
;;;834    		{
;;;835    			u16 i=0;
0009d2  2500              MOVS     r5,#0
;;;836    			extern st_conf conf;		
;;;837    			
;;;838    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
0009d4  462a              MOV      r2,r5
0009d6  f2405125          MOV      r1,#0x525
0009da  464e              MOV      r6,r9
0009dc  4648              MOV      r0,r9
0009de  f7fffffe          BL       USART_ITConfig
;;;839    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
0009e2  2201              MOVS     r2,#1
0009e4  f2406126          MOV      r1,#0x626
0009e8  4630              MOV      r0,r6
0009ea  f7fffffe          BL       USART_ITConfig
;;;840    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
0009ee  2201              MOVS     r2,#1
0009f0  2108              MOVS     r1,#8
0009f2  483b              LDR      r0,|L12.2784|
0009f4  f7fffffe          BL       GPIO_WriteBit
;;;841    /*
;;;842    		u8 address;
;;;843    		u8 ver_po_st;
;;;844    		u8 ver_po_ml;
;;;845    	  u8 tek_gr_kal; 
;;;846    	  u8 tm_antidreb;
;;;847    		u8 revers_group_select;
;;;848    		u8 revers_peredacha_select;
;;;849    		u8 rez8;
;;;850    	
;;;851    		u16	per_usr;
;;;852    		u16	time_max;
;;;853    		u16 por_rele;
;;;854    		u16 tm_rele_on;
;;;855    		u16 tm_rele_off;
;;;856    		u16 rez16;
;;;857    	*/	
;;;858    /*
;;;859    			conf.address=1;
;;;860    			conf.ver_po_st=2;
;;;861    			conf.ver_po_ml=3;
;;;862    			conf.tek_gr_kal=4;
;;;863    			conf.tm_antidreb=5;
;;;864    			conf.revers_group_select=6;
;;;865    			conf.revers_peredacha_select=7;
;;;866    			conf.rez8=8;
;;;867    			conf.per_usr=9;
;;;868    			conf.time_max=10;
;;;869    			conf.por_rele=11;
;;;870    			conf.tm_rele_on=12;
;;;871    			conf.tm_rele_off=13;
;;;872    			conf.rez16=14;
;;;873    			
;;;874    		conf.lin.kol_st=15;
;;;875    		conf.lin.max1=16;	
;;;876    		conf.lin.max2=17;
;;;877    		conf.lin.max3=18;
;;;878    		conf.lin.max4=19;
;;;879    		*/
;;;880    			/*
;;;881    			conf.indicators[0].numb=15;
;;;882    			conf.indicators[0].kol_cifr=16;
;;;883    			conf.indicators[0].type_ind=17;
;;;884    			conf.indicators[0].yark=18;
;;;885    			conf.indicators[0].rez_viv=19;
;;;886    			conf.indicators[0].pol_zap=20;
;;;887    			conf.indicators[0].r1=21;
;;;888    			conf.indicators[0].r2=22;
;;;889    			conf.indicators[0].chislo=23;
;;;890    			conf.indicators[0].porog=24;
;;;891    
;;;892    			conf.indicators[1].numb=25;
;;;893    			conf.indicators[1].kol_cifr=26;
;;;894    			conf.indicators[1].type_ind=27;
;;;895    			conf.indicators[1].yark=28;
;;;896    			conf.indicators[1].rez_viv=29;
;;;897    			conf.indicators[1].pol_zap=30;
;;;898    			conf.indicators[1].r1=31;
;;;899    			conf.indicators[1].r2=32;
;;;900    			conf.indicators[1].chislo=33;
;;;901    			conf.indicators[1].porog=34;
;;;902    		
;;;903    
;;;904    		
;;;905    
;;;906    		
;;;907    			conf.indicators[2].numb=35;
;;;908    			conf.indicators[2].kol_cifr=36;
;;;909    			conf.indicators[2].type_ind=37;
;;;910    			conf.indicators[2].yark=38;
;;;911    			conf.indicators[2].rez_viv=39;
;;;912    			conf.indicators[2].pol_zap=40;
;;;913    			conf.indicators[2].r1=41;
;;;914    			conf.indicators[2].r2=42;
;;;915    			conf.indicators[2].chislo=43;
;;;916    			conf.indicators[2].porog=44;
;;;917    			
;;;918    			conf.indicators[3].numb=45;
;;;919    			conf.indicators[3].kol_cifr=46;
;;;920    			conf.indicators[3].type_ind=47;
;;;921    			conf.indicators[3].yark=48;
;;;922    			conf.indicators[3].rez_viv=49;
;;;923    			conf.indicators[3].pol_zap=50;
;;;924    			conf.indicators[3].r1=51;
;;;925    			conf.indicators[3].r2=52;
;;;926    			conf.indicators[3].chislo=53;
;;;927    			conf.indicators[3].porog=54;
;;;928    				*/
;;;929    		/*		
;;;930    			conf.gr_kal1.tabl1.fz[0]=55;
;;;931    			conf.gr_kal1.tabl1.fz[1]=56;
;;;932    			conf.gr_kal1.tabl1.fz[2]=57;
;;;933    			conf.gr_kal1.tabl1.fz[3]=58;
;;;934    			conf.gr_kal1.tabl1.fz[4]=59;
;;;935    			conf.gr_kal1.tabl1.fz[5]=60;
;;;936    			conf.gr_kal1.tabl1.fz[6]=61;
;;;937    			conf.gr_kal1.tabl1.fz[7]=62;
;;;938    			conf.gr_kal1.tabl1.fz[8]=63;
;;;939    			conf.gr_kal1.tabl1.fz[9]=64;
;;;940    
;;;941    			conf.gr_kal1.tabl1.kod[0]=65;
;;;942    			conf.gr_kal1.tabl1.kod[1]=66;
;;;943    			conf.gr_kal1.tabl1.kod[2]=67;
;;;944    			conf.gr_kal1.tabl1.kod[3]=68;
;;;945    			conf.gr_kal1.tabl1.kod[4]=69;
;;;946    			conf.gr_kal1.tabl1.kod[5]=70;
;;;947    			conf.gr_kal1.tabl1.kod[6]=71;
;;;948    			conf.gr_kal1.tabl1.kod[7]=72;
;;;949    			conf.gr_kal1.tabl1.kod[8]=73;
;;;950    			conf.gr_kal1.tabl1.kod[9]=74;
;;;951    	
;;;952    			conf.gr_kal1.tabl2.fz[0]=75;
;;;953    			conf.gr_kal1.tabl2.fz[1]=76;
;;;954    			conf.gr_kal1.tabl2.fz[2]=77;
;;;955    			conf.gr_kal1.tabl2.fz[3]=78;
;;;956    			conf.gr_kal1.tabl2.fz[4]=79;
;;;957    			conf.gr_kal1.tabl2.fz[5]=80;
;;;958    			conf.gr_kal1.tabl2.fz[6]=81;
;;;959    			conf.gr_kal1.tabl2.fz[7]=82;
;;;960    			conf.gr_kal1.tabl2.fz[8]=83;
;;;961    			conf.gr_kal1.tabl2.fz[9]=84;
;;;962    
;;;963    			conf.gr_kal1.tabl2.kod[0]=85;
;;;964    			conf.gr_kal1.tabl2.kod[1]=86;
;;;965    			conf.gr_kal1.tabl2.kod[2]=87;
;;;966    			conf.gr_kal1.tabl2.kod[3]=88;
;;;967    			conf.gr_kal1.tabl2.kod[4]=89;
;;;968    			conf.gr_kal1.tabl2.kod[5]=90;
;;;969    			conf.gr_kal1.tabl2.kod[6]=91;
;;;970    			conf.gr_kal1.tabl2.kod[7]=92;
;;;971    			conf.gr_kal1.tabl2.kod[8]=93;
;;;972    			conf.gr_kal1.tabl2.kod[9]=94;	
;;;973    			
;;;974    			// dr2
;;;975    			conf.gr_kal2.tabl1.fz[0]=95;
;;;976    			conf.gr_kal2.tabl1.fz[1]=96;
;;;977    			conf.gr_kal2.tabl1.fz[2]=97;
;;;978    			conf.gr_kal2.tabl1.fz[3]=98;
;;;979    			conf.gr_kal2.tabl1.fz[4]=99;
;;;980    			conf.gr_kal2.tabl1.fz[5]=100;
;;;981    			conf.gr_kal2.tabl1.fz[6]=101;
;;;982    			conf.gr_kal2.tabl1.fz[7]=102;
;;;983    			conf.gr_kal2.tabl1.fz[8]=103;
;;;984    			conf.gr_kal2.tabl1.fz[9]=104;
;;;985    
;;;986    			conf.gr_kal2.tabl1.kod[0]=105;
;;;987    			conf.gr_kal2.tabl1.kod[1]=106;
;;;988    			conf.gr_kal2.tabl1.kod[2]=107;
;;;989    			conf.gr_kal2.tabl1.kod[3]=108;
;;;990    			conf.gr_kal2.tabl1.kod[4]=109;
;;;991    			conf.gr_kal2.tabl1.kod[5]=100;
;;;992    			conf.gr_kal2.tabl1.kod[6]=111;
;;;993    			conf.gr_kal2.tabl1.kod[7]=112;
;;;994    			conf.gr_kal2.tabl1.kod[8]=113;
;;;995    			conf.gr_kal2.tabl1.kod[9]=114;
;;;996    	
;;;997    			conf.gr_kal2.tabl2.fz[0]=115;
;;;998    			conf.gr_kal2.tabl2.fz[1]=116;
;;;999    			conf.gr_kal2.tabl2.fz[2]=117;
;;;1000   			conf.gr_kal2.tabl2.fz[3]=118;
;;;1001   			conf.gr_kal2.tabl2.fz[4]=119;
;;;1002   			conf.gr_kal2.tabl2.fz[5]=120;
;;;1003   			conf.gr_kal2.tabl2.fz[6]=121;
;;;1004   			conf.gr_kal2.tabl2.fz[7]=122;
;;;1005   			conf.gr_kal2.tabl2.fz[8]=123;
;;;1006   			conf.gr_kal2.tabl2.fz[9]=124;
;;;1007   
;;;1008   			conf.gr_kal2.tabl2.kod[0]=125;
;;;1009   			conf.gr_kal2.tabl2.kod[1]=126;
;;;1010   			conf.gr_kal2.tabl2.kod[2]=127;
;;;1011   			conf.gr_kal2.tabl2.kod[3]=128;
;;;1012   			conf.gr_kal2.tabl2.kod[4]=129;
;;;1013   			conf.gr_kal2.tabl2.kod[5]=130;
;;;1014   			conf.gr_kal2.tabl2.kod[6]=131;
;;;1015   			conf.gr_kal2.tabl2.kod[7]=132;
;;;1016   			conf.gr_kal2.tabl2.kod[8]=133;
;;;1017   			conf.gr_kal2.tabl2.kod[9]=134;	
;;;1018   */		
;;;1019   		/*
;;;1020   			txsize=sizeof(st_conf)<<1;
;;;1021   	
;;;1022   			for (i = 0; i < (txsize); i += 1)
;;;1023   			{
;;;1024   				u16 tmp=0;
;;;1025   	//			TxBuffer[i]=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1026   				tmp=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1027   				TxBuffer[i<<1]=(tmp>>8)+0x30;
;;;1028   				TxBuffer[(i<<1)+1]=tmp+0x30;
;;;1029   			}	
;;;1030   */
;;;1031   
;;;1032   			txsize=sizeof(st_conf);  // dl = 228
0009f8  21be              MOVS     r1,#0xbe
0009fa  483a              LDR      r0,|L12.2788|
0009fc  f8aa1000          STRH     r1,[r10,#0]
                  |L12.2560|
;;;1033   	
;;;1034   			for (i = 0; i < (txsize); i += 1)
;;;1035   			{
;;;1036   		//		TxBuffer[i]=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1037   				TxBuffer[i]=(*(__IO uint8_t *) (BKPSRAM_BASE + i));
000a00  5c2a              LDRB     r2,[r5,r0]
000a02  557a              STRB     r2,[r7,r5]
000a04  1c6d              ADDS     r5,r5,#1              ;1034
000a06  b2ad              UXTH     r5,r5                 ;1034
000a08  428d              CMP      r5,r1                 ;1034
000a0a  d3f9              BCC      |L12.2560|
;;;1038   			}	
;;;1039   			tekper=0;
000a0c  f8ab4000          STRH     r4,[r11,#0]
;;;1040   			USART_SendData(USART2, 0x3A);
000a10  213a              MOVS     r1,#0x3a
000a12  4630              MOV      r0,r6
000a14  f7fffffe          BL       USART_SendData
                  |L12.2584|
;;;1041   		}		
;;;1042   		
;;;1043   		new_komand=0;
000a18  4833              LDR      r0,|L12.2792|
000a1a  7004              STRB     r4,[r0,#0]
                  |L12.2588|
;;;1044   	}
;;;1045   	
;;;1046   
;;;1047   	
;;;1048   				//	indicators[0].chislo=1234;
;;;1049   		//		indicators[1].chislo=1234;
;;;1050   		//		indicate (0);
;;;1051   		//		indicate (1);
;;;1052   				
;;;1053   }
000a1c  e8bd9ff0          POP      {r4-r12,pc}
                  |L12.2592|
000a20  2072              MOVS     r0,#0x72              ;560
000a22  7078              STRB     r0,[r7,#1]            ;560
000a24  2074              MOVS     r0,#0x74              ;561
000a26  70b8              STRB     r0,[r7,#2]            ;561
000a28  265f              MOVS     r6,#0x5f              ;562
000a2a  70fe              STRB     r6,[r7,#3]            ;562
000a2c  7139              STRB     r1,[r7,#4]            ;563
000a2e  206f              MOVS     r0,#0x6f              ;564
000a30  7178              STRB     r0,[r7,#5]            ;564
000a32  71ba              STRB     r2,[r7,#6]            ;565
000a34  71fb              STRB     r3,[r7,#7]            ;566
000a36  723e              STRB     r6,[r7,#8]            ;567
000a38  7278              STRB     r0,[r7,#9]            ;568
000a3a  206b              MOVS     r0,#0x6b              ;569
000a3c  72b8              STRB     r0,[r7,#0xa]          ;569
000a3e  e4bc              B        |L12.954|
                  |L12.2624|
000a40  2001              MOVS     r0,#1                 ;592
000a42  e4c8              B        |L12.982|
                  |L12.2628|
000a44  2101              MOVS     r1,#1                 ;592
000a46  e4ca              B        |L12.990|
                  |L12.2632|
000a48  2101              MOVS     r1,#1                 ;592
000a4a  e4cd              B        |L12.1000|
                  |L12.2636|
000a4c  2101              MOVS     r1,#1                 ;592
000a4e  e4d0              B        |L12.1010|
                  |L12.2640|
000a50  2001              MOVS     r0,#1                 ;617
000a52  e55b              B        |L12.1292|
                  |L12.2644|
000a54  2101              MOVS     r1,#1                 ;617
000a56  e55d              B        |L12.1300|
                  |L12.2648|
000a58  2101              MOVS     r1,#1                 ;617
000a5a  e560              B        |L12.1310|
                  |L12.2652|
000a5c  2101              MOVS     r1,#1                 ;617
000a5e  e563              B        |L12.1320|
                  |L12.2656|
000a60  2101              MOVS     r1,#1                 ;617
000a62  e566              B        |L12.1330|
                  |L12.2660|
000a64  2101              MOVS     r1,#1                 ;617
000a66  e569              B        |L12.1340|
                  |L12.2664|
000a68  2101              MOVS     r1,#1                 ;617
000a6a  e56c              B        |L12.1350|
                  |L12.2668|
000a6c  2001              MOVS     r0,#1                 ;647
000a6e  e59f              B        |L12.1456|
                  |L12.2672|
000a70  2101              MOVS     r1,#1                 ;647
000a72  e5a1              B        |L12.1464|
                  |L12.2676|
000a74  e018              B        |L12.2728|
                  |L12.2678|
000a76  e01a              B        |L12.2734|
                  |L12.2680|
000a78  e01b              B        |L12.2738|
                  |L12.2682|
000a7a  2101              MOVS     r1,#1                 ;647
000a7c  e5a1              B        |L12.1474|
                  |L12.2686|
000a7e  2101              MOVS     r1,#1                 ;647
000a80  e5a4              B        |L12.1484|
                  |L12.2690|
000a82  2101              MOVS     r1,#1                 ;647
000a84  e5a7              B        |L12.1494|
                  |L12.2694|
000a86  2101              MOVS     r1,#1                 ;647
000a88  e5aa              B        |L12.1504|
                  |L12.2698|
000a8a  2101              MOVS     r1,#1                 ;647
000a8c  e5ad              B        |L12.1514|
                  |L12.2702|
000a8e  e012              B        |L12.2742|
                  |L12.2704|
000a90  e013              B        |L12.2746|
000a92  e014              B        |L12.2750|
                  |L12.2708|
000a94  2101              MOVS     r1,#1                 ;647
000a96  e5ad              B        |L12.1524|
                  |L12.2712|
000a98  2001              MOVS     r0,#1                 ;741
000a9a  e65c              B        |L12.1878|
                  |L12.2716|
000a9c  2101              MOVS     r1,#1                 ;741
000a9e  e65e              B        |L12.1886|
                  |L12.2720|
000aa0  2101              MOVS     r1,#1                 ;741
000aa2  e661              B        |L12.1896|
                  |L12.2724|
000aa4  2101              MOVS     r1,#1                 ;741
000aa6  e665              B        |L12.1908|
                  |L12.2728|
000aa8  2001              MOVS     r0,#1                 ;833
000aaa  e773              B        |L12.2452|
000aac  e009              B        |L12.2754|
                  |L12.2734|
000aae  2101              MOVS     r1,#1                 ;833
000ab0  e774              B        |L12.2460|
                  |L12.2738|
000ab2  2101              MOVS     r1,#1                 ;833
000ab4  e777              B        |L12.2470|
                  |L12.2742|
000ab6  2101              MOVS     r1,#1                 ;833
000ab8  e77a              B        |L12.2480|
                  |L12.2746|
000aba  2101              MOVS     r1,#1                 ;833
000abc  e77d              B        |L12.2490|
                  |L12.2750|
000abe  2101              MOVS     r1,#1                 ;833
000ac0  e780              B        |L12.2500|
                  |L12.2754|
000ac2  2101              MOVS     r1,#1                 ;833
000ac4  e783              B        |L12.2510|
;;;1054   
                          ENDP

000ac6  0000              DCW      0x0000
                  |L12.2760|
                          DCD      fz_average
                  |L12.2764|
                          DCD      max
                  |L12.2768|
                          DCD      avariya
                  |L12.2772|
                          DCD      sost_flesh
                  |L12.2776|
                          DCD      conf
                  |L12.2780|
                          DCD      RxBuffer
                  |L12.2784|
                          DCD      0x40020c00
                  |L12.2788|
                          DCD      0x40024000
                  |L12.2792|
                          DCD      new_komand

                          AREA ||i.TIM2_IRQHandler||, CODE, READONLY, ALIGN=1

                  TIM2_IRQHandler PROC
;;;1187     */
;;;1188   void TIM2_IRQHandler(void)
000000  f7ffbffe          B.W      USB_OTG_BSP_TimerIRQ
;;;1189   {
;;;1190     USB_OTG_BSP_TimerIRQ();
;;;1191   }
;;;1192   
                          ENDP


                          AREA ||i.TIM4_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM4_IRQHandler PROC
;;;1093     */
;;;1094   void TIM4_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1095   {
;;;1096      uint8_t clickreg = 0;
;;;1097   
;;;1098   	
;;;1099     /* Checks whether the TIM interrupt has occurred */
;;;1100     if (TIM_GetITStatus(TIM4, TIM_IT_CC1) != RESET)
000002  4c0d              LDR      r4,|L14.56|
000004  2102              MOVS     r1,#2
000006  4620              MOV      r0,r4
000008  f7fffffe          BL       TIM_GetITStatus
00000c  2800              CMP      r0,#0
00000e  d011              BEQ      |L14.52|
;;;1101     {
;;;1102       TIM_ClearITPendingBit(TIM4, TIM_IT_CC1);
000010  2102              MOVS     r1,#2
000012  4620              MOV      r0,r4
000014  f7fffffe          BL       TIM_ClearITPendingBit
;;;1103   		/*
;;;1104       if( LED_Toggle == 3)
;;;1105       {
;;;1106         // LED3 Orange toggling 
;;;1107         STM_EVAL_LEDToggle(LED3);
;;;1108         STM_EVAL_LEDOff(LED6);
;;;1109         STM_EVAL_LEDOff(LED4);
;;;1110       }
;;;1111       else if( LED_Toggle == 4)
;;;1112       {
;;;1113         // LED4 Green toggling 
;;;1114         STM_EVAL_LEDToggle(LED4);
;;;1115         STM_EVAL_LEDOff(LED6);
;;;1116         STM_EVAL_LEDOff(LED3);
;;;1117       }
;;;1118       else if( LED_Toggle == 6)
;;;1119       {
;;;1120         // LED6 Blue toggling 
;;;1121         STM_EVAL_LEDOff(LED3);
;;;1122         STM_EVAL_LEDOff(LED4);
;;;1123         STM_EVAL_LEDToggle(LED6);
;;;1124       }
;;;1125       else if (LED_Toggle ==0)
;;;1126       {
;;;1127         // LED6 Blue On to signal Pause 
;;;1128         STM_EVAL_LEDOn(LED6);
;;;1129       }
;;;1130       else if (LED_Toggle == 7)
;;;1131       {
;;;1132         // LED4 toggling with frequency = 439.4 Hz 
;;;1133         STM_EVAL_LEDOff(LED3);
;;;1134         STM_EVAL_LEDOff(LED4);
;;;1135         STM_EVAL_LEDOff(LED5);
;;;1136         STM_EVAL_LEDOff(LED6);
;;;1137       }
;;;1138   		*/
;;;1139   	
;;;1140   
;;;1141       capture = TIM_GetCapture1(TIM4);
000018  4620              MOV      r0,r4
00001a  f7fffffe          BL       TIM_GetCapture1
00001e  b281              UXTH     r1,r0
000020  4806              LDR      r0,|L14.60|
000022  8141              STRH     r1,[r0,#0xa]
;;;1142       TIM_SetCompare1(TIM4, capture + CCR_Val);
000024  4806              LDR      r0,|L14.64|
000026  8800              LDRH     r0,[r0,#0]  ; CCR_Val
000028  4401              ADD      r1,r1,r0
00002a  4620              MOV      r0,r4
00002c  e8bd4010          POP      {r4,lr}
000030  f7ffbffe          B.W      TIM_SetCompare1
                  |L14.52|
;;;1143     }
;;;1144   }
000034  bd10              POP      {r4,pc}
;;;1145   
                          ENDP

000036  0000              DCW      0x0000
                  |L14.56|
                          DCD      0x40000800
                  |L14.60|
                          DCD      ||.data||
                  |L14.64|
                          DCD      CCR_Val

                          AREA ||i.UsageFault_Handler||, CODE, READONLY, ALIGN=1

                  UsageFault_Handler PROC
                  |L15.0|
;;;150      */
;;;151    void UsageFault_Handler(void)
000000  e7fe              B        |L15.0|
;;;152    {
;;;153      /* Go to infinite loop when Usage Fault exception occurs */
;;;154      while (1)
;;;155      {
;;;156      }
;;;157    }
;;;158    
                          ENDP


                          AREA ||i.fiz_vel||, CODE, READONLY, ALIGN=2

                  fiz_vel PROC
;;;185    
;;;186    u16 fiz_vel(u16 kod, st_tab_kal* tk)
000000  b570              PUSH     {r4-r6,lr}
;;;187    {
;;;188    	u8 i=0, nul=0;
;;;189    	st_tab_kal *tab = tk;
;;;190    //	tab_kal
;;;191    	/*
;;;192    	    
;;;193           
;;;194                    
;;;195                    if kod[1:]==[0,0,0,0,0,0,0,0,0]:
;;;196                        print 'no tabl' 
;;;197                        return kodadc
;;;198                        
;;;199                    if kodadc<kod[0]:
;;;200                        return fz[0]
;;;201                    
;;;202                    for i in range(1,10):
;;;203                        
;;;204                        if kodadc<kod[i]:
;;;205                            if i==0:
;;;206                                print 'i=0',fz[0]
;;;207                                return fz[0]
;;;208                            else:
;;;209                                if kod[i]==0:
;;;210                                    print 'kod=0',fz[i-1]
;;;211                                    return fz[i-1]
;;;212                                else:
;;;213                                    print 'norm',
;;;214                                    return (fz[i]-fz[i-1])*(kodadc-kod[i-1])/(kod[i]-kod[i-1])+fz[i-1]
;;;215                                    
;;;216                        if  kod[i-1]>0 and kod[i]==0:
;;;217                            return fz[i-1]
;;;218                    
;;;219                    return fz[9]
;;;220    
;;;221    	*/
;;;222    	
;;;223    	
;;;224    	/*	
;;;225    	conf.gr_kal1.tabl1.fz[0]
;;;226    	conf.gr_kal1.tabl1.kod[0]=65;
;;;227      conf.tek_gr_kal=4;
;;;228      sost_pribl	
;;;229    	tk
;;;230    	*/
;;;231    		tk_null=0;
000002  4c24              LDR      r4,|L16.148|
000004  2300              MOVS     r3,#0                 ;188
;;;232    		for (i = 1; i < 10; i += 1)
000006  2201              MOVS     r2,#1
000008  7023              STRB     r3,[r4,#0]            ;231
                  |L16.10|
;;;233    			if (tk->kod[i]==0) 
00000a  f8315012          LDRH     r5,[r1,r2,LSL #1]
00000e  b90d              CBNZ     r5,|L16.20|
;;;234    					nul++;	
000010  1c5b              ADDS     r3,r3,#1
000012  b2db              UXTB     r3,r3
                  |L16.20|
000014  1c52              ADDS     r2,r2,#1              ;232
000016  b2d2              UXTB     r2,r2                 ;232
000018  2a0a              CMP      r2,#0xa               ;232
00001a  d3f6              BCC      |L16.10|
;;;235    	  if (nul==9)
00001c  2b09              CMP      r3,#9
00001e  d024              BEQ      |L16.106|
;;;236    		{		tk_null=1;
;;;237    				return kod; }
;;;238    		
;;;239    		if (kod<tk->kod[0])
000020  880a              LDRH     r2,[r1,#0]
000022  4282              CMP      r2,r0
000024  d824              BHI      |L16.112|
;;;240            return tk->fz[0];
;;;241    		
;;;242    		for (i = 1; i < 10; i += 1)	
000026  2201              MOVS     r2,#1
                  |L16.40|
;;;243    		{
;;;244    			float tmp=0;
;;;245    			if (kod<tk->kod[i]) {
000028  f8313012          LDRH     r3,[r1,r2,LSL #1]
00002c  4283              CMP      r3,r0
00002e  d921              BLS      |L16.116|
;;;246    					if (i==0)
000030  b1f2              CBZ      r2,|L16.112|
;;;247    							return tk->fz[0];
;;;248    					else  {
;;;249    							if (tk->kod[i]==0)
000032  041c              LSLS     r4,r3,#16
000034  0c24              LSRS     r4,r4,#16
000036  d029              BEQ      |L16.140|
;;;250    									return tk->fz[i-1];
;;;251    							else  {
;;;252    								  tmp=(tk->fz[i]-tk->fz[i-1])*(kod-tk->kod[i-1])/(tk->kod[i]-tk->kod[i-1])+tk->fz[i-1]+0.5;
000038  eb010142          ADD      r1,r1,r2,LSL #1
00003c  8a8c              LDRH     r4,[r1,#0x14]
00003e  8a4a              LDRH     r2,[r1,#0x12]
000040  f8311c02          LDRH     r1,[r1,#-2]
000044  1aa4              SUBS     r4,r4,r2
000046  1a40              SUBS     r0,r0,r1
000048  4344              MULS     r4,r0,r4
00004a  1a58              SUBS     r0,r3,r1
00004c  fb94f0f0          SDIV     r0,r4,r0
000050  4410              ADD      r0,r0,r2
000052  f7fffffe          BL       __aeabi_i2d
000056  2200              MOVS     r2,#0
000058  4b0f              LDR      r3,|L16.152|
00005a  f7fffffe          BL       __aeabi_dadd
00005e  f7fffffe          BL       __aeabi_d2f
;;;253    									return (u16) tmp;  } } }
000062  f7fffffe          BL       __aeabi_f2uiz
000066  b280              UXTH     r0,r0
;;;254    									
;;;255    			if  ((tk->kod[i-1]>0)&(tk->kod[i]==0))
;;;256    					return tk->fz[i-1];
;;;257      	}	
;;;258        
;;;259    		return tk->fz[9];		
;;;260    }
000068  bd70              POP      {r4-r6,pc}
                  |L16.106|
00006a  2101              MOVS     r1,#1                 ;236
00006c  7021              STRB     r1,[r4,#0]            ;236
00006e  bd70              POP      {r4-r6,pc}
                  |L16.112|
000070  8a88              LDRH     r0,[r1,#0x14]         ;247
000072  bd70              POP      {r4-r6,pc}
                  |L16.116|
000074  eb010442          ADD      r4,r1,r2,LSL #1       ;255
000078  f8344c02          LDRH     r4,[r4,#-2]           ;255
00007c  b104              CBZ      r4,|L16.128|
00007e  b12b              CBZ      r3,|L16.140|
                  |L16.128|
000080  1c52              ADDS     r2,r2,#1              ;242
000082  b2d2              UXTB     r2,r2                 ;242
000084  2a0a              CMP      r2,#0xa               ;242
000086  d3cf              BCC      |L16.40|
000088  8cc8              LDRH     r0,[r1,#0x26]         ;259
00008a  bd70              POP      {r4-r6,pc}
                  |L16.140|
00008c  eb010042          ADD      r0,r1,r2,LSL #1       ;256
000090  8a40              LDRH     r0,[r0,#0x12]         ;256
000092  bd70              POP      {r4-r6,pc}
;;;261    
                          ENDP

                  |L16.148|
                          DCD      ||.data||
                  |L16.152|
                          DCD      0x3fe00000

                          AREA ||i.moving_average||, CODE, READONLY, ALIGN=2

                  moving_average PROC
;;;262    
;;;263    u16 moving_average(u16 kod, u8 numb)
000000  b570              PUSH     {r4-r6,lr}
;;;264    {
;;;265    	extern u16 tek_kol;
;;;266    	extern u16 kol_usr;
;;;267    	extern u32 buf_sum;
;;;268    	u16 tmp=0;
;;;269    	
;;;270    	if (kol_usr==0)
000002  4916              LDR      r1,|L17.92|
000004  880a              LDRH     r2,[r1,#0]  ; kol_usr
000006  2a00              CMP      r2,#0                 ;264
000008  d018              BEQ      |L17.60|
;;;271    		return kod;
;;;272    
;;;273    	if (kol_usr==1)
00000a  2a01              CMP      r2,#1
00000c  d016              BEQ      |L17.60|
;;;274    		return kod;
;;;275    	
;;;276    	if (tek_kol<kol_usr)
00000e  4b14              LDR      r3,|L17.96|
;;;277    	{
;;;278    		buf_sum+=kod;
000010  4d14              LDR      r5,|L17.100|
;;;279    		tek_kol++;
;;;280    		return (u16)((buf_sum/tek_kol)+0.5);
000012  4e15              LDR      r6,|L17.104|
000014  8819              LDRH     r1,[r3,#0]            ;276  ; tek_kol
000016  682c              LDR      r4,[r5,#0]            ;278
000018  4291              CMP      r1,r2                 ;276
00001a  4404              ADD      r4,r4,r0              ;278
00001c  d20f              BCS      |L17.62|
00001e  1c49              ADDS     r1,r1,#1              ;279
000020  b288              UXTH     r0,r1                 ;279
000022  602c              STR      r4,[r5,#0]            ;279  ; buf_sum
000024  8018              STRH     r0,[r3,#0]            ;279
000026  fbb4f0f0          UDIV     r0,r4,r0
00002a  f7fffffe          BL       __aeabi_ui2d
00002e  2200              MOVS     r2,#0
000030  4633              MOV      r3,r6
000032  f7fffffe          BL       __aeabi_dadd
000036  f7fffffe          BL       __aeabi_d2uiz
00003a  b280              UXTH     r0,r0
                  |L17.60|
;;;281    	}
;;;282    	else
;;;283    	{
;;;284    		buf_sum+=kod;
;;;285    		tmp=(u16) ((buf_sum/tek_kol)+0.5);
;;;286    		buf_sum-=tmp;
;;;287    		return  tmp;
;;;288    	}
;;;289    }
00003c  bd70              POP      {r4-r6,pc}
                  |L17.62|
00003e  fbb4f0f1          UDIV     r0,r4,r1              ;285
000042  f7fffffe          BL       __aeabi_ui2d
000046  2200              MOVS     r2,#0                 ;285
000048  4633              MOV      r3,r6                 ;285
00004a  f7fffffe          BL       __aeabi_dadd
00004e  f7fffffe          BL       __aeabi_d2uiz
000052  b280              UXTH     r0,r0                 ;285
000054  1a21              SUBS     r1,r4,r0              ;286
000056  6029              STR      r1,[r5,#0]            ;286  ; buf_sum
000058  bd70              POP      {r4-r6,pc}
;;;290    
                          ENDP

00005a  0000              DCW      0x0000
                  |L17.92|
                          DCD      kol_usr
                  |L17.96|
                          DCD      tek_kol
                  |L17.100|
                          DCD      buf_sum
                  |L17.104|
                          DCD      0x3fe00000

                          AREA ||i.test_rele||, CODE, READONLY, ALIGN=2

                  test_rele PROC
;;;290    
;;;291    u8 test_rele(u16 fz, u8 numb)
000000  b5f0              PUSH     {r4-r7,lr}
;;;292    {
;;;293    	extern st_conf conf;
;;;294    	
;;;295    	if (fz>conf.por_rele)
000002  4d11              LDR      r5,|L18.72|
;;;296    			kol_rele_on++;			
000004  4911              LDR      r1,|L18.76|
000006  89aa              LDRH     r2,[r5,#0xc]          ;295  ; conf
000008  4282              CMP      r2,r0                 ;295
00000a  d203              BCS      |L18.20|
00000c  8888              LDRH     r0,[r1,#4]  ; kol_rele_on
00000e  1c40              ADDS     r0,r0,#1
000010  8088              STRH     r0,[r1,#4]
000012  e002              B        |L18.26|
                  |L18.20|
;;;297    	else
;;;298    			kol_rele_off++;
000014  88c8              LDRH     r0,[r1,#6]  ; kol_rele_off
000016  1c40              ADDS     r0,r0,#1
000018  80c8              STRH     r0,[r1,#6]
                  |L18.26|
;;;299    		
;;;300    	if (kol_rele_on>=conf.tm_rele_on)
00001a  89ee              LDRH     r6,[r5,#0xe]  ; conf
00001c  888f              LDRH     r7,[r1,#4]  ; kol_rele_on
00001e  2000              MOVS     r0,#0
;;;301    	{
;;;302    		kol_rele_on=0;
;;;303    		kol_rele_off=0;
;;;304    		avariya=1;
000020  4a0b              LDR      r2,|L18.80|
;;;305    		PORT_AVARIYA->BSRRL = PIN_AVARIYA;	// on PIN_AVARIYA
000022  4c0c              LDR      r4,|L18.84|
000024  f44f4300          MOV      r3,#0x8000
000028  42be              CMP      r6,r7                 ;300
00002a  d804              BHI      |L18.54|
00002c  8088              STRH     r0,[r1,#4]            ;302
00002e  80c8              STRH     r0,[r1,#6]            ;303
000030  2601              MOVS     r6,#1                 ;304
000032  7016              STRB     r6,[r2,#0]            ;304
000034  8323              STRH     r3,[r4,#0x18]
                  |L18.54|
;;;306    	}
;;;307    	
;;;308    	if (kol_rele_off>=conf.tm_rele_off)
000036  8a2d              LDRH     r5,[r5,#0x10]  ; conf
000038  88ce              LDRH     r6,[r1,#6]  ; kol_rele_off
00003a  42b5              CMP      r5,r6
00003c  d803              BHI      |L18.70|
;;;309    	{
;;;310    		kol_rele_on=0;
00003e  8088              STRH     r0,[r1,#4]
;;;311    		kol_rele_off=0;
000040  80c8              STRH     r0,[r1,#6]
;;;312    		avariya=0;
000042  7010              STRB     r0,[r2,#0]
;;;313    		PORT_AVARIYA->BSRRH = PIN_AVARIYA;  	// off  PIN_AVARIYA
000044  8363              STRH     r3,[r4,#0x1a]
                  |L18.70|
;;;314    	}
;;;315    }
000046  bdf0              POP      {r4-r7,pc}
;;;316    
                          ENDP

                  |L18.72|
                          DCD      conf
                  |L18.76|
                          DCD      ||.data||
                  |L18.80|
                          DCD      avariya
                  |L18.84|
                          DCD      0x40020000

                          AREA ||.data||, DATA, ALIGN=1

                  tk_null
000000  00                DCB      0x00
                  PauseResumeStatus
000001  02                DCB      0x02
                  Count
000002  0000              DCB      0x00,0x00
                  kol_rele_on
000004  0000              DCW      0x0000
                  kol_rele_off
000006  0000              DCW      0x0000
                  time_max
000008  0000              DCW      0x0000
                  capture
00000a  0000              DCW      0x0000
                  ||DT1||
                          DCDU     0x00000000
000010  000000            DCB      0x00,0x00,0x00

                          AREA ||area_number.22||, DATA, ALIGN=0

                          EXPORTAS ||area_number.22||, ||.data||
                  LED_Toggle
000000  00                DCB      0x00

                          AREA ||area_number.23||, DATA, ALIGN=1

                          EXPORTAS ||area_number.23||, ||.data||
                  Time_Rec_Base
000000  0000              DCW      0x0000

;*** Start embedded assembler ***

#line 1 "src\\stm32f4xx_it.c"
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_stm32f4xx_it_c_52b4fc9b____REV16|
#line 114 ".\\Libraries\\CMSIS\\core_cmInstr.h"
|__asm___14_stm32f4xx_it_c_52b4fc9b____REV16| PROC
#line 115

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_stm32f4xx_it_c_52b4fc9b____REVSH|
#line 128
|__asm___14_stm32f4xx_it_c_52b4fc9b____REVSH| PROC
#line 129

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
