; generated by ARM C/C++ Compiler, 5.03 [Build 24]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o.\MEDIA_USB_KEY\stm32f4xx_it.o --asm_dir=.\listing\ --list_dir=.\listing\ --depend=.\MEDIA_USB_KEY\stm32f4xx_it.d --cpu=Cortex-M4 --apcs=interwork -I.\Libraries -I.\Utilities -I.\Libraries\CMSIS\ST\STM32F4xx\Include -I.\inc -I.\src -I.\Libraries\STM32F4xx_StdPeriph_Driver -I.\Libraries\STM32_USB_HOST_Library -I.\Libraries\STM32_USB_OTG_Driver -I.\Utilities\STM32F4-Discovery -I.\Libraries\CMSIS -I.\Utilities\Third_Party\fat_fs -IC:\Keil4\ARM\RV31\INC -IC:\Keil4\ARM\CMSIS\Include -IC:\Keil4\ARM\Inc\ST\STM32F4xx -D__MICROLIB -DUSE_STDPERIPH_DRIVER -DUSE_USB_OTG_FS -DSTM32F4XX -DMEDIA_USB_KEY -D__FPU_PRESENT=0 --omf_browse=.\MEDIA_USB_KEY\stm32f4xx_it.crf src\stm32f4xx_it.c]
                          THUMB

                          AREA ||i.BusFault_Handler||, CODE, READONLY, ALIGN=1

                  BusFault_Handler PROC
                  |L1.0|
;;;137      */
;;;138    void BusFault_Handler(void)
000000  e7fe              B        |L1.0|
;;;139    {
;;;140      /* Go to infinite loop when Bus Fault exception occurs */
;;;141      while (1)
;;;142      {
;;;143      }
;;;144    }
;;;145    
                          ENDP


                          AREA ||i.DebugMon_Handler||, CODE, READONLY, ALIGN=1

                  DebugMon_Handler PROC
;;;172      */
;;;173    void DebugMon_Handler(void)
000000  4770              BX       lr
;;;174    {
;;;175    }
;;;176    
                          ENDP


                          AREA ||i.EXTI0_IRQHandler||, CODE, READONLY, ALIGN=2

                  EXTI0_IRQHandler PROC
;;;1181     */
;;;1182   void EXTI0_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1183   {
;;;1184     /* Checks whether the User Button EXTI line is asserted*/
;;;1185     if (EXTI_GetITStatus(EXTI_Line0) != RESET) 
000002  2001              MOVS     r0,#1
000004  f7fffffe          BL       EXTI_GetITStatus
000008  b158              CBZ      r0,|L3.34|
;;;1186     { 
;;;1187       if (Command_index == 1)
00000a  4808              LDR      r0,|L3.44|
00000c  7803              LDRB     r3,[r0,#0]  ; Command_index
00000e  2100              MOVS     r1,#0
;;;1188       {
;;;1189         RepeatState = 0;
000010  4a07              LDR      r2,|L3.48|
000012  2b01              CMP      r3,#1                 ;1187
000014  d001              BEQ      |L3.26|
;;;1190         /* Switch to play command */
;;;1191         Command_index = 0;
;;;1192       }
;;;1193       else if (Command_index == 0)
000016  7803              LDRB     r3,[r0,#0]  ; Command_index
000018  b10b              CBZ      r3,|L3.30|
                  |L3.26|
00001a  7011              STRB     r1,[r2,#0]            ;1189
00001c  e000              B        |L3.32|
                  |L3.30|
;;;1194       {
;;;1195         /* Switch to record command */
;;;1196         Command_index = 1;
00001e  2101              MOVS     r1,#1
                  |L3.32|
000020  7001              STRB     r1,[r0,#0]
                  |L3.34|
;;;1197     //    XferCplt = 1;
;;;1198     //    EVAL_AUDIO_Stop(CODEC_PDWN_SW);
;;;1199       }
;;;1200       else
;;;1201       {
;;;1202         RepeatState = 0;
;;;1203         /* Switch to play command */
;;;1204         Command_index = 0; 
;;;1205       }
;;;1206     } 
;;;1207     /* Clears the EXTI's line pending bit.*/ 
;;;1208     EXTI_ClearITPendingBit(EXTI_Line0);
000022  e8bd4010          POP      {r4,lr}
000026  2001              MOVS     r0,#1
000028  f7ffbffe          B.W      EXTI_ClearITPendingBit
;;;1209   }
;;;1210   
                          ENDP

                  |L3.44|
                          DCD      Command_index
                  |L3.48|
                          DCD      RepeatState

                          AREA ||i.EXTI1_IRQHandler||, CODE, READONLY, ALIGN=2

                  EXTI1_IRQHandler PROC
;;;1097     */
;;;1098   void EXTI1_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1099   {
;;;1100     /* Check the clic on the accelerometer to Pause/Resume Playing */
;;;1101     if(EXTI_GetITStatus(EXTI_Line1) != RESET)
000002  2002              MOVS     r0,#2
000004  f7fffffe          BL       EXTI_GetITStatus
000008  2800              CMP      r0,#0
00000a  d00f              BEQ      |L4.44|
;;;1102     {
;;;1103       if( Count==1)
00000c  4808              LDR      r0,|L4.48|
00000e  7883              LDRB     r3,[r0,#2]  ; Count
000010  2200              MOVS     r2,#0
;;;1104       {
;;;1105         PauseResumeStatus = 1;
000012  2101              MOVS     r1,#1
000014  2b01              CMP      r3,#1                 ;1103
000016  d006              BEQ      |L4.38|
;;;1106         Count = 0;
;;;1107       }
;;;1108       else
;;;1109       {
;;;1110         PauseResumeStatus = 0;
000018  7042              STRB     r2,[r0,#1]
;;;1111         Count = 1;
00001a  7081              STRB     r1,[r0,#2]
                  |L4.28|
;;;1112       }
;;;1113       /* Clear the EXTI line 1 pending bit */
;;;1114       EXTI_ClearITPendingBit(EXTI_Line1);
00001c  e8bd4010          POP      {r4,lr}
000020  2002              MOVS     r0,#2
000022  f7ffbffe          B.W      EXTI_ClearITPendingBit
                  |L4.38|
000026  7041              STRB     r1,[r0,#1]            ;1105
000028  7082              STRB     r2,[r0,#2]            ;1106
00002a  e7f7              B        |L4.28|
                  |L4.44|
;;;1115     }
;;;1116   }
00002c  bd10              POP      {r4,pc}
;;;1117   
                          ENDP

00002e  0000              DCW      0x0000
                  |L4.48|
                          DCD      ||.data||

                          AREA ||i.HardFault_Handler||, CODE, READONLY, ALIGN=1

                  HardFault_Handler PROC
                  |L5.0|
;;;111      */
;;;112    void HardFault_Handler(void)
000000  e7fe              B        |L5.0|
;;;113    {
;;;114      /* Go to infinite loop when Hard Fault exception occurs */
;;;115      while (1)
;;;116      {
;;;117      }
;;;118    }
;;;119    
                          ENDP


                          AREA ||i.MemManage_Handler||, CODE, READONLY, ALIGN=1

                  MemManage_Handler PROC
                  |L6.0|
;;;124      */
;;;125    void MemManage_Handler(void)
000000  e7fe              B        |L6.0|
;;;126    {
;;;127      /* Go to infinite loop when Memory Manage exception occurs */
;;;128      while (1)
;;;129      {
;;;130      }
;;;131    }
;;;132    
                          ENDP


                          AREA ||i.NMI_Handler||, CODE, READONLY, ALIGN=1

                  NMI_Handler PROC
;;;81       */
;;;82     void NMI_Handler(void)
000000  b510              PUSH     {r4,lr}
;;;83     {
;;;84       /* This interrupt is generated when HSE clock fails */
;;;85     
;;;86       if (RCC_GetITStatus(RCC_IT_CSS) != RESET)
000002  2080              MOVS     r0,#0x80
000004  f7fffffe          BL       RCC_GetITStatus
000008  2800              CMP      r0,#0
00000a  d00b              BEQ      |L7.36|
;;;87       {
;;;88         /* At this stage: HSE, PLL are disabled (but no change on PLL config) and HSI
;;;89            is selected as system clock source */
;;;90     
;;;91         /* Enable HSE */
;;;92         RCC_HSEConfig(RCC_HSE_ON);
00000c  2001              MOVS     r0,#1
00000e  f7fffffe          BL       RCC_HSEConfig
;;;93     
;;;94         /* Enable HSE Ready and PLL Ready interrupts */
;;;95         RCC_ITConfig(RCC_IT_HSERDY | RCC_IT_PLLRDY, ENABLE);
000012  2101              MOVS     r1,#1
000014  2018              MOVS     r0,#0x18
000016  f7fffffe          BL       RCC_ITConfig
;;;96     
;;;97         /* Clear Clock Security System interrupt pending bit */
;;;98         RCC_ClearITPendingBit(RCC_IT_CSS);
00001a  e8bd4010          POP      {r4,lr}
00001e  2080              MOVS     r0,#0x80
000020  f7ffbffe          B.W      RCC_ClearITPendingBit
                  |L7.36|
;;;99     
;;;100        /* Once HSE clock recover, the HSERDY interrupt is generated and in the RCC ISR
;;;101           routine the system clock will be reconfigured to its previous state (before
;;;102           HSE clock failure) */
;;;103      }
;;;104    }
000024  bd10              POP      {r4,pc}
;;;105    
                          ENDP


                          AREA ||i.OTG_FS_IRQHandler||, CODE, READONLY, ALIGN=2

                  OTG_FS_IRQHandler PROC
;;;1227     */
;;;1228   void OTG_FS_IRQHandler(void)
000000  4801              LDR      r0,|L8.8|
;;;1229   {
;;;1230     USBH_OTG_ISR_Handler(&USB_OTG_Core);
000002  f7ffbffe          B.W      USBH_OTG_ISR_Handler
;;;1231   }
;;;1232   #endif /* MEDIA_USB_KEY */
                          ENDP

000006  0000              DCW      0x0000
                  |L8.8|
                          DCD      USB_OTG_Core

                          AREA ||i.PendSV_Handler||, CODE, READONLY, ALIGN=1

                  PendSV_Handler PROC
;;;181      */
;;;182    void PendSV_Handler(void)
000000  4770              BX       lr
;;;183    {
;;;184    }
;;;185    
                          ENDP


                          AREA ||i.RCC_IRQHandler||, CODE, READONLY, ALIGN=1

                  RCC_IRQHandler PROC
;;;1248     */
;;;1249   void RCC_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1250   {
;;;1251     if(RCC_GetITStatus(RCC_IT_HSERDY) != RESET)
000002  2008              MOVS     r0,#8
000004  f7fffffe          BL       RCC_GetITStatus
000008  b148              CBZ      r0,|L10.30|
;;;1252     { 
;;;1253       /* Clear HSERDY interrupt pending bit */
;;;1254       RCC_ClearITPendingBit(RCC_IT_HSERDY);
00000a  2008              MOVS     r0,#8
00000c  f7fffffe          BL       RCC_ClearITPendingBit
;;;1255   
;;;1256       /* Check if the HSE clock is still available */
;;;1257       if (RCC_GetFlagStatus(RCC_FLAG_HSERDY) != RESET)
000010  2031              MOVS     r0,#0x31
000012  f7fffffe          BL       RCC_GetFlagStatus
000016  b110              CBZ      r0,|L10.30|
;;;1258       { 
;;;1259         /* Enable PLL: once the PLL is ready the PLLRDY interrupt is generated */ 
;;;1260         RCC_PLLCmd(ENABLE);     
000018  2001              MOVS     r0,#1
00001a  f7fffffe          BL       RCC_PLLCmd
                  |L10.30|
;;;1261       }
;;;1262     }
;;;1263   
;;;1264     if(RCC_GetITStatus(RCC_IT_PLLRDY) != RESET)
00001e  2010              MOVS     r0,#0x10
000020  f7fffffe          BL       RCC_GetITStatus
000024  2800              CMP      r0,#0
000026  d00c              BEQ      |L10.66|
;;;1265     { 
;;;1266       /* Clear PLLRDY interrupt pending bit */
;;;1267       RCC_ClearITPendingBit(RCC_IT_PLLRDY);
000028  2010              MOVS     r0,#0x10
00002a  f7fffffe          BL       RCC_ClearITPendingBit
;;;1268   
;;;1269       /* Check if the PLL is still locked */
;;;1270       if (RCC_GetFlagStatus(RCC_FLAG_PLLRDY) != RESET)
00002e  2039              MOVS     r0,#0x39
000030  f7fffffe          BL       RCC_GetFlagStatus
000034  2800              CMP      r0,#0
000036  d004              BEQ      |L10.66|
;;;1271       { 
;;;1272         /* Select PLL as system clock source */
;;;1273         RCC_SYSCLKConfig(RCC_SYSCLKSource_PLLCLK);
000038  e8bd4010          POP      {r4,lr}
00003c  2002              MOVS     r0,#2
00003e  f7ffbffe          B.W      RCC_SYSCLKConfig
                  |L10.66|
;;;1274       }
;;;1275     }
;;;1276   }
000042  bd10              POP      {r4,pc}
;;;1277   
                          ENDP


                          AREA ||i.SVC_Handler||, CODE, READONLY, ALIGN=1

                  SVC_Handler PROC
;;;163      */
;;;164    void SVC_Handler(void)
000000  4770              BX       lr
;;;165    {
;;;166    }
;;;167    
                          ENDP


                          AREA ||i.SysTick_Handler||, CODE, READONLY, ALIGN=2

                  SysTick_Handler PROC
;;;323      */
;;;324    void SysTick_Handler(void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;325    {
;;;326    	extern __IO uint16_t ADC3ConvertedValue;
;;;327    	extern u32 tick;
;;;328    	extern st_conf conf;
;;;329    	
;;;330     //  проверка состояния датчика приближений - 
;;;331    	
;;;332    	if ((PORT_PRIBL->IDR & PIN_PRIBL)==0)
000004  48fe              LDR      r0,|L12.1024|
000006  6800              LDR      r0,[r0,#0]
;;;333    	{
;;;334    		kol_pribl_vikl++;
;;;335    //		STM_EVAL_LEDOn(LED6);	
;;;336    	}
;;;337    	else
;;;338    	{
;;;339    		kol_pribl_vkl++;
000008  4ffe              LDR      r7,|L12.1028|
00000a  f8df83fc          LDR      r8,|L12.1032|
00000e  0780              LSLS     r0,r0,#30             ;332
000010  d405              BMI      |L12.30|
000012  f8b81000          LDRH     r1,[r8,#0]            ;334  ; kol_pribl_vikl
000016  1c49              ADDS     r1,r1,#1              ;334
000018  f8a81000          STRH     r1,[r8,#0]            ;334
00001c  e002              B        |L12.36|
                  |L12.30|
00001e  8838              LDRH     r0,[r7,#0]  ; kol_pribl_vkl
000020  1c40              ADDS     r0,r0,#1
000022  8038              STRH     r0,[r7,#0]
                  |L12.36|
;;;340    //		STM_EVAL_LEDOff(LED6);	
;;;341    	}
;;;342    	conf.tm_antidreb=2;
000024  f8df93e4          LDR      r9,|L12.1036|
000028  2102              MOVS     r1,#2
;;;343    	if (kol_pribl_vkl>=conf.tm_antidreb)
;;;344    	{
;;;345    			sost_pribl=1;
;;;346    		STM_EVAL_LEDOn(LED6);	
;;;347    			PORT_PER_NIZ->BSRRH = PIN_PER_NIZ;  	// off  PIN_PER_NIZ
00002a  f8dfb3e4          LDR      r11,|L12.1040|
00002e  f8891004          STRB     r1,[r9,#4]            ;342
000032  8838              LDRH     r0,[r7,#0]            ;343  ; kol_pribl_vkl
000034  01ce              LSLS     r6,r1,#7
000036  4df7              LDR      r5,|L12.1044|
000038  2400              MOVS     r4,#0                 ;345
00003a  f04f0a01          MOV      r10,#1                ;345
00003e  2802              CMP      r0,#2                 ;343
000040  d30c              BCC      |L12.92|
000042  f885a000          STRB     r10,[r5,#0]           ;345
000046  2003              MOVS     r0,#3                 ;346
000048  f7fffffe          BL       STM_EVAL_LEDOn
00004c  f8ab601a          STRH     r6,[r11,#0x1a]
;;;348    			PORT_PER_VERH->BSRRL = PIN_PER_VERH;	// on PIN_PER_VERH
000050  0070              LSLS     r0,r6,#1
000052  f8ab0018          STRH     r0,[r11,#0x18]
;;;349    			kol_pribl_vkl=0;
000056  803c              STRH     r4,[r7,#0]
;;;350    		  kol_pribl_vikl=0;
000058  f8a84000          STRH     r4,[r8,#0]
                  |L12.92|
;;;351    	} 
;;;352    	
;;;353    	if (kol_pribl_vikl>=conf.tm_antidreb)
00005c  f8991004          LDRB     r1,[r9,#4]  ; conf
000060  f8b80000          LDRH     r0,[r8,#0]  ; kol_pribl_vikl
000064  4281              CMP      r1,r0
000066  d80c              BHI      |L12.130|
;;;354    	{
;;;355    			sost_pribl=0;
000068  702c              STRB     r4,[r5,#0]
;;;356    		STM_EVAL_LEDOff(LED6);	
00006a  2003              MOVS     r0,#3
00006c  f7fffffe          BL       STM_EVAL_LEDOff
;;;357    			PORT_PER_NIZ->BSRRL = PIN_PER_NIZ;  	// on  PIN_PER_NIZ
000070  f8ab6018          STRH     r6,[r11,#0x18]
;;;358    			PORT_PER_VERH->BSRRH = PIN_PER_VERH;	// off PIN_PER_VERH
000074  f44f7100          MOV      r1,#0x200
000078  f8ab101a          STRH     r1,[r11,#0x1a]
;;;359    			kol_pribl_vkl=0;
00007c  803c              STRH     r4,[r7,#0]
;;;360    			kol_pribl_vikl=0;
00007e  f8a84000          STRH     r4,[r8,#0]
                  |L12.130|
;;;361    	}
;;;362    
;;;363    	
;;;364    	// проверка кнопок-состояния переключателей группы калибровок
;;;365    	// on 	GPIO_PORT[Led]->BSRRL = GPIO_PIN[Led];
;;;366    	// off  GPIO_PORT[Led]->BSRRH = GPIO_PIN[Led];    
;;;367    //	conf.tek_gr_kal
;;;368    
;;;369    		if ((PORT_K1->IDR & PIN_K1)==0)
000082  48df              LDR      r0,|L12.1024|
000084  6801              LDR      r1,[r0,#0]
000086  060a              LSLS     r2,r1,#24
;;;370    		{
;;;371    			kol_gr1_vkl++;
000088  49e3              LDR      r1,|L12.1048|
00008a  d403              BMI      |L12.148|
00008c  880a              LDRH     r2,[r1,#0]  ; kol_gr1_vkl
00008e  f1020201          ADD      r2,r2,#1
000092  800a              STRH     r2,[r1,#0]
                  |L12.148|
;;;372    	//		STM_EVAL_LEDOn(LED6);	
;;;373    		}
;;;374    //		else
;;;375    	//		STM_EVAL_LEDOff(LED6);	
;;;376    
;;;377    		if ((PORT_K2->IDR & PIN_K2)==0)
000094  6800              LDR      r0,[r0,#0]
000096  0582              LSLS     r2,r0,#22
;;;378    		{
;;;379    			kol_gr2_vkl++;
000098  48e0              LDR      r0,|L12.1052|
00009a  d402              BMI      |L12.162|
00009c  8802              LDRH     r2,[r0,#0]  ; kol_gr2_vkl
00009e  1c52              ADDS     r2,r2,#1
0000a0  8002              STRH     r2,[r0,#0]
                  |L12.162|
;;;380    //			STM_EVAL_LEDOn(LED6);	
;;;381    		}
;;;382    //		else
;;;383    //			STM_EVAL_LEDOff(LED6);	
;;;384    
;;;385    		if (kol_gr1_vkl>=conf.tm_antidreb)
;;;386    		{
;;;387    				conf.tek_gr_kal=0;
;;;388    	 // gr 1
;;;389    			PORT_L1->BSRRL = PIN_L1;  	// on  PIN_L1
0000a2  f8df835c          LDR      r8,|L12.1024|
0000a6  f8993004          LDRB     r3,[r9,#4]            ;385  ; conf
0000aa  f8b1c000          LDRH     r12,[r1,#0]           ;385  ; kol_gr1_vkl
0000ae  464a              MOV      r2,r9                 ;385
0000b0  f1080808          ADD      r8,r8,#8
0000b4  f04f0940          MOV      r9,#0x40
;;;390    			PORT_L2->BSRRH = PIN_L2;	// off PIN_L2
0000b8  f1080702          ADD      r7,r8,#2
0000bc  4563              CMP      r3,r12                ;385
0000be  d805              BHI      |L12.204|
0000c0  70d4              STRB     r4,[r2,#3]            ;387
0000c2  f8a89000          STRH     r9,[r8,#0]            ;389
0000c6  803e              STRH     r6,[r7,#0]
;;;391    
;;;392    				kol_gr1_vkl=0;
0000c8  800c              STRH     r4,[r1,#0]
;;;393    				kol_gr2_vkl=0;
0000ca  8004              STRH     r4,[r0,#0]
                  |L12.204|
;;;394    		}		
;;;395    
;;;396    		if (kol_gr2_vkl>=conf.tm_antidreb)
0000cc  8802              LDRH     r2,[r0,#0]  ; kol_gr2_vkl
0000ce  4293              CMP      r3,r2
0000d0  d808              BHI      |L12.228|
;;;397    		{
;;;398    				conf.tek_gr_kal=1;
0000d2  4bce              LDR      r3,|L12.1036|
0000d4  f883a003          STRB     r10,[r3,#3]
;;;399    				 // gr 2
;;;400    			PORT_L1->BSRRH = PIN_L1;  	// off  PIN_L1
0000d8  f8a79000          STRH     r9,[r7,#0]
;;;401    			PORT_L2->BSRRL = PIN_L2;	// on PIN_L2
0000dc  f8a86000          STRH     r6,[r8,#0]
;;;402    				kol_gr1_vkl=0;
0000e0  800c              STRH     r4,[r1,#0]
;;;403    				kol_gr2_vkl=0;
0000e2  8004              STRH     r4,[r0,#0]
                  |L12.228|
;;;404    		}				
;;;405    	
;;;406    	/*
;;;407    	  RCC_AHB1PeriphClockCmd(GPIO_CLK[Led], ENABLE);
;;;408    
;;;409    
;;;410      GPIO_InitStructure.GPIO_Pin = GPIO_PIN[Led];
;;;411      GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
;;;412      GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
;;;413      GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
;;;414      GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
;;;415      GPIO_Init(GPIO_PORT[Led], &GPIO_InitStructure);
;;;416    	*/
;;;417    	
;;;418    			// проверяем реле на срабатывание
;;;419    	test_rele(fz[0], 0);	
0000e4  4ece              LDR      r6,|L12.1056|
0000e6  2100              MOVS     r1,#0
0000e8  8830              LDRH     r0,[r6,#0]  ; fz
0000ea  f7fffffe          BL       test_rele
;;;420    	
;;;421    	
;;;422    	// раз в 10 мс
;;;423    	// находим среднее значение
;;;424    	summa[0]+=ADC3ConvertedValue;
0000ee  4acd              LDR      r2,|L12.1060|
0000f0  48cd              LDR      r0,|L12.1064|
0000f2  8811              LDRH     r1,[r2,#0]  ; summa
0000f4  8800              LDRH     r0,[r0,#0]  ; ADC3ConvertedValue
;;;425    	 
;;;426    //		summa[0]+=100;
;;;427    	kol_average++;
0000f6  4bcd              LDR      r3,|L12.1068|
0000f8  4408              ADD      r0,r0,r1              ;424
0000fa  b281              UXTH     r1,r0                 ;424
0000fc  8011              STRH     r1,[r2,#0]            ;424
0000fe  7818              LDRB     r0,[r3,#0]  ; kol_average
000100  1c40              ADDS     r0,r0,#1
000102  b2c0              UXTB     r0,r0
000104  7018              STRB     r0,[r3,#0]
;;;428    	
;;;429    	if (kol_average==10)
000106  280a              CMP      r0,#0xa
000108  d17e              BNE      |L12.520|
;;;430    	{			
;;;431    	
;;;432    		average[0]=summa[0]/kol_average;
00010a  fbb1f0f0          UDIV     r0,r1,r0
00010e  49c8              LDR      r1,|L12.1072|
;;;433    		kol_average=0;
;;;434    		summa[0]=0;
;;;435    		
;;;436    		
;;;437    		// раз в 100 мс
;;;438    		// вычисляем физическую величину
;;;439    		
;;;440    		if (conf.tek_gr_kal==0)
000110  4fbe              LDR      r7,|L12.1036|
000112  8008              STRH     r0,[r1,#0]            ;432
000114  701c              STRB     r4,[r3,#0]            ;433
000116  8014              STRH     r4,[r2,#0]            ;434
000118  78f9              LDRB     r1,[r7,#3]  ; conf
00011a  2900              CMP      r1,#0
;;;441    				if (sost_pribl==0)
;;;442    					fz[0]=fiz_vel(average[0],&conf.gr_kal1.tabl1);
;;;443    				else
;;;444    					fz[0]=fiz_vel(average[0],&conf.gr_kal1.tabl2);
;;;445    		else
;;;446    				if (sost_pribl==0)
00011c  7829              LDRB     r1,[r5,#0]  ; sost_pribl
00011e  d028              BEQ      |L12.370|
000120  2900              CMP      r1,#0
;;;447    					fz[0]=fiz_vel(average[0],&conf.gr_kal2.tabl1);
;;;448    				else
;;;449    					fz[0]=fiz_vel(average[0],&conf.gr_kal2.tabl2);
000122  4639              MOV      r1,r7
000124  d02c              BEQ      |L12.384|
000126  3196              ADDS     r1,r1,#0x96
                  |L12.296|
000128  f7fffffe          BL       fiz_vel
00012c  8030              STRH     r0,[r6,#0]            ;447
;;;450    			
;;;451    	
;;;452    	// находим среднее значение по скользящей средней
;;;453    		fz_average[0]=moving_average(fz[0],0);
00012e  b280              UXTH     r0,r0
000130  2100              MOVS     r1,#0
000132  f7fffffe          BL       moving_average
000136  49bf              LDR      r1,|L12.1076|
;;;454    
;;;455    		// time max
;;;456    		if (time_max>=conf.time_max) {
000138  4ab4              LDR      r2,|L12.1036|
00013a  4ebf              LDR      r6,|L12.1080|
00013c  8008              STRH     r0,[r1,#0]            ;453
00013e  8952              LDRH     r2,[r2,#0xa]  ; conf
000140  8933              LDRH     r3,[r6,#8]  ; time_max
000142  429a              CMP      r2,r3
000144  d802              BHI      |L12.332|
;;;457    				max[0]=0;
000146  4abd              LDR      r2,|L12.1084|
000148  8014              STRH     r4,[r2,#0]
;;;458    				time_max=0;  }
00014a  8134              STRH     r4,[r6,#8]
                  |L12.332|
;;;459    		time_max++;
00014c  8932              LDRH     r2,[r6,#8]  ; time_max
;;;460    		// detect max
;;;461    		if (fz_average[0]>max[0])
00014e  f8df92ec          LDR      r9,|L12.1084|
000152  1c52              ADDS     r2,r2,#1              ;459
000154  8132              STRH     r2,[r6,#8]            ;459
000156  f8b91000          LDRH     r1,[r9,#0]  ; max
00015a  4288              CMP      r0,r1
00015c  d901              BLS      |L12.354|
;;;462    			max[0]=fz_average[0];
00015e  f8a90000          STRH     r0,[r9,#0]
                  |L12.354|
;;;463    
;;;464    		
;;;465    		if (number_buff)
000162  48b7              LDR      r0,|L12.1088|
;;;466    			Buf_adc_zap2[por++]=por; //fz_average[0];			
;;;467    		else
;;;468    			Buf_adc_zap1[por++]=por; //fz_average[0];
000164  49b7              LDR      r1,|L12.1092|
000166  7800              LDRB     r0,[r0,#0]            ;465  ; number_buff
000168  2800              CMP      r0,#0                 ;465
00016a  8808              LDRH     r0,[r1,#0]  ; por
00016c  d00a              BEQ      |L12.388|
00016e  4ab6              LDR      r2,|L12.1096|
000170  e009              B        |L12.390|
                  |L12.370|
000172  2900              CMP      r1,#0                 ;441
000174  49a5              LDR      r1,|L12.1036|
000176  d001              BEQ      |L12.380|
000178  3146              ADDS     r1,r1,#0x46           ;444
00017a  e7d5              B        |L12.296|
                  |L12.380|
00017c  311e              ADDS     r1,r1,#0x1e           ;442
00017e  e7d3              B        |L12.296|
                  |L12.384|
000180  316e              ADDS     r1,r1,#0x6e           ;447
000182  e7d1              B        |L12.296|
                  |L12.388|
000184  4ab1              LDR      r2,|L12.1100|
                  |L12.390|
;;;469    		
;;;470    		if (por==999)
000186  4faf              LDR      r7,|L12.1092|
000188  f8220010          STRH     r0,[r2,r0,LSL #1]     ;468
00018c  1c40              ADDS     r0,r0,#1              ;468
00018e  8008              STRH     r0,[r1,#0]            ;468
000190  8839              LDRH     r1,[r7,#0]  ; por
000192  f24030e7          MOV      r0,#0x3e7
000196  4281              CMP      r1,r0
000198  d100              BNE      |L12.412|
;;;471    			por=999;
00019a  8038              STRH     r0,[r7,#0]
                  |L12.412|
;;;472    	
;;;473    	del++;
00019c  49ac              LDR      r1,|L12.1104|
;;;474    	if (del==10)
;;;475    	{		
;;;476    		del=0;
;;;477    		tick++;
00019e  f8dfb2b4          LDR      r11,|L12.1108|
0001a2  8808              LDRH     r0,[r1,#0]            ;473  ; del
0001a4  1c40              ADDS     r0,r0,#1              ;473
0001a6  b280              UXTH     r0,r0                 ;473
0001a8  8008              STRH     r0,[r1,#0]            ;473
0001aa  280a              CMP      r0,#0xa               ;474
0001ac  d16d              BNE      |L12.650|
0001ae  800c              STRH     r4,[r1,#0]            ;476
0001b0  f8db0000          LDR      r0,[r11,#0]  ; tick
;;;478    		time_label=tick;
0001b4  49a8              LDR      r1,|L12.1112|
0001b6  1c40              ADDS     r0,r0,#1              ;477
0001b8  f8cb0000          STR      r0,[r11,#0]  ; tick
0001bc  8008              STRH     r0,[r1,#0]
;;;479    		
;;;480    		rtc_Get(&DT1);
0001be  489e              LDR      r0,|L12.1080|
0001c0  300c              ADDS     r0,r0,#0xc
0001c2  f7fffffe          BL       rtc_Get
;;;481    		
;;;482    		if (DT1.Seconds==0)
0001c6  f8df8270          LDR      r8,|L12.1080|
0001ca  f108080c          ADD      r8,r8,#0xc
0001ce  f8981006          LDRB     r1,[r8,#6]  ; DT1
0001d2  b971              CBNZ     r1,|L12.498|
;;;483    		{
;;;484    			number_buff^=1;
0001d4  489a              LDR      r0,|L12.1088|
0001d6  7802              LDRB     r2,[r0,#0]  ; number_buff
0001d8  f0820201          EOR      r2,r2,#1
0001dc  7002              STRB     r2,[r0,#0]
;;;485    			DT_zap=DT1;
0001de  489f              LDR      r0,|L12.1116|
0001e0  68f2              LDR      r2,[r6,#0xc]  ; DT1
0001e2  6002              STR      r2,[r0,#0]  ; DT_zap
0001e4  8a32              LDRH     r2,[r6,#0x10]  ; DT1
0001e6  8082              STRH     r2,[r0,#4]
0001e8  7181              STRB     r1,[r0,#6]
;;;486    			
;;;487    			buffering=1;
0001ea  499d              LDR      r1,|L12.1120|
0001ec  f881a000          STRB     r10,[r1,#0]
;;;488    			por=0;
0001f0  803c              STRH     r4,[r7,#0]
                  |L12.498|
;;;489    		}
;;;490    			
;;;491    	 if (tick%2==0)
0001f2  f89b0000          LDRB     r0,[r11,#0]  ; tick
0001f6  465f              MOV      r7,r11
0001f8  07c0              LSLS     r0,r0,#31
;;;492    	 {
;;;493    		 STM_EVAL_LEDOn(LED3);		 
;;;494    		 STM_EVAL_LEDOn(LED5);		
;;;495    	 }
;;;496    	 else
;;;497    	 {
;;;498    		 STM_EVAL_LEDOff(LED3);	 
0001fa  f04f0001          MOV      r0,#1
0001fe  d00e              BEQ      |L12.542|
000200  f7fffffe          BL       STM_EVAL_LEDOff
;;;499    		 STM_EVAL_LEDOff(LED5);		
000204  2002              MOVS     r0,#2
000206  e000              B        |L12.522|
                  |L12.520|
000208  e060              B        |L12.716|
                  |L12.522|
00020a  f7fffffe          BL       STM_EVAL_LEDOff
                  |L12.526|
;;;500    	 }
;;;501    	 
;;;502    // indicate_lin(0,(u16)fz_average[0], 4096);
;;;503    // indicate(1,(u16)(fz_average[0]/10));
;;;504    	 if (tk_null==1)
00020e  7830              LDRB     r0,[r6,#0]  ; tk_null
000210  2801              CMP      r0,#1
000212  d00a              BEQ      |L12.554|
;;;505    	 {
;;;506    		 indicate_err(1);   	// tek
;;;507    		 indicate_err(2);			// lineika 
;;;508    		 indicate_err(3);			// maximum
;;;509    	//	 indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes);								//	time	
;;;510    	 }
;;;511    	 else
;;;512    	 {		
;;;513    	 if ((avariya==1)&((tick%2)==0))
000214  4893              LDR      r0,|L12.1124|
000216  7800              LDRB     r0,[r0,#0]  ; avariya
000218  2801              CMP      r0,#1
00021a  d010              BEQ      |L12.574|
00021c  e012              B        |L12.580|
                  |L12.542|
00021e  f7fffffe          BL       STM_EVAL_LEDOn
000222  2002              MOVS     r0,#2                 ;494
000224  f7fffffe          BL       STM_EVAL_LEDOn
000228  e7f1              B        |L12.526|
                  |L12.554|
00022a  2001              MOVS     r0,#1                 ;506
00022c  f7fffffe          BL       indicate_err
000230  2002              MOVS     r0,#2                 ;507
000232  f7fffffe          BL       indicate_err
000236  2003              MOVS     r0,#3                 ;508
000238  f7fffffe          BL       indicate_err
00023c  e025              B        |L12.650|
                  |L12.574|
00023e  7838              LDRB     r0,[r7,#0]  ; tick
000240  07c0              LSLS     r0,r0,#31
000242  d02b              BEQ      |L12.668|
                  |L12.580|
;;;514    	 {
;;;515    			ind_blank_all(1); 
;;;516    			ind_blank_all(2); 
;;;517    			ind_blank_all(3); 
;;;518    	//		ind_blank_all(4); 		 
;;;519    		}
;;;520    		else
;;;521    		{
;;;522    		 // dop usrednenie na vivod indicatorov???
;;;523    		 indicate(1,(u16)(u16)(fz_average[0]),3);   																// tek
000244  4e7b              LDR      r6,|L12.1076|
000246  2203              MOVS     r2,#3
000248  2001              MOVS     r0,#1
00024a  8831              LDRH     r1,[r6,#0]  ; fz_average
00024c  f7fffffe          BL       indicate
;;;524    
;;;525    			if (conf.tek_gr_kal==0)
000250  486e              LDR      r0,|L12.1036|
000252  78c1              LDRB     r1,[r0,#3]  ; conf
000254  2900              CMP      r1,#0
;;;526    					if (sost_pribl==0)
;;;527    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max1, (u16) conf.lin.kol_st);			// lineika 
;;;528    					else
;;;529    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max2, (u16) conf.lin.kol_st);			// lineika 
;;;530    			else
;;;531    					if (sost_pribl==0)
000256  7829              LDRB     r1,[r5,#0]  ; sost_pribl
000258  d02a              BEQ      |L12.688|
;;;532    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max3, (u16) conf.lin.kol_st);			// lineika 
;;;533    					else
;;;534    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max4, (u16) conf.lin.kol_st);			// lineika 
00025a  7d03              LDRB     r3,[r0,#0x14]  ; conf
00025c  b371              CBZ      r1,|L12.700|
00025e  8b82              LDRH     r2,[r0,#0x1c]  ; conf
                  |L12.608|
000260  8831              LDRH     r1,[r6,#0]            ;532  ; fz_average
000262  2002              MOVS     r0,#2                 ;532
000264  f7fffffe          BL       indicate_lin
;;;535    		 
;;;536    		 indicate(3,(u16)(max[0]),3);														// maximum
000268  2203              MOVS     r2,#3
00026a  f8b91000          LDRH     r1,[r9,#0]  ; max
00026e  4610              MOV      r0,r2
000270  f7fffffe          BL       indicate
;;;537    		
;;;538    			if ((tick%2)==0)
000274  7838              LDRB     r0,[r7,#0]  ; tick
;;;539    				indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes,1);				//	time	
;;;540    			else
;;;541    				indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes,0);				//	time	
000276  f8982005          LDRB     r2,[r8,#5]  ; DT1
00027a  f8981004          LDRB     r1,[r8,#4]  ; DT1
00027e  07c0              LSLS     r0,r0,#31             ;538
000280  d01e              BEQ      |L12.704|
000282  2300              MOVS     r3,#0
                  |L12.644|
000284  2004              MOVS     r0,#4                 ;539
000286  f7fffffe          BL       indicate_time
                  |L12.650|
;;;542    		}
;;;543    	 }	
;;;544     }	 
;;;545    		
;;;546    	if ((tick%60)==0)
00028a  f8db0000          LDR      r0,[r11,#0]  ; tick
00028e  213c              MOVS     r1,#0x3c
000290  fbb0f2f1          UDIV     r2,r0,r1
000294  fb010012          MLS      r0,r1,r2,r0
000298  b1a0              CBZ      r0,|L12.708|
00029a  e017              B        |L12.716|
                  |L12.668|
00029c  2001              MOVS     r0,#1                 ;515
00029e  f7fffffe          BL       ind_blank_all
0002a2  2002              MOVS     r0,#2                 ;516
0002a4  f7fffffe          BL       ind_blank_all
0002a8  2003              MOVS     r0,#3                 ;517
0002aa  f7fffffe          BL       ind_blank_all
0002ae  e7ec              B        |L12.650|
                  |L12.688|
0002b0  7d03              LDRB     r3,[r0,#0x14]         ;529  ; conf
0002b2  b109              CBZ      r1,|L12.696|
0002b4  8b02              LDRH     r2,[r0,#0x18]         ;529  ; conf
0002b6  e7d3              B        |L12.608|
                  |L12.696|
0002b8  8ac2              LDRH     r2,[r0,#0x16]         ;527  ; conf
0002ba  e7d1              B        |L12.608|
                  |L12.700|
0002bc  8b42              LDRH     r2,[r0,#0x1a]         ;532  ; conf
0002be  e7cf              B        |L12.608|
                  |L12.704|
0002c0  2301              MOVS     r3,#1                 ;539
0002c2  e7df              B        |L12.644|
                  |L12.708|
;;;547    	{
;;;548    		minute++;
0002c4  4868              LDR      r0,|L12.1128|
0002c6  8801              LDRH     r1,[r0,#0]  ; minute
0002c8  1c49              ADDS     r1,r1,#1
0002ca  8001              STRH     r1,[r0,#0]
                  |L12.716|
;;;549    	}
;;;550    	}	
;;;551    	
;;;552    	if (new_komand)
0002cc  4867              LDR      r0,|L12.1132|
0002ce  7800              LDRB     r0,[r0,#0]  ; new_komand
0002d0  2800              CMP      r0,#0
0002d2  d06f              BEQ      |L12.948|
;;;553    	{
;;;554    		u16 tmp=0;
;;;555    	
;;;556    		// wrt_conf
;;;557    		if ((RxBuffer[2]=='w')&(RxBuffer[3]=='r')&(RxBuffer[4]=='t')&(RxBuffer[5]=='_')&(RxBuffer[6]=='c')&(RxBuffer[7]=='o')&(RxBuffer[8]=='n')&(RxBuffer[9]=='f'))
0002d4  4a66              LDR      r2,|L12.1136|
0002d6  7890              LDRB     r0,[r2,#2]  ; RxBuffer
0002d8  2877              CMP      r0,#0x77
0002da  d046              BEQ      |L12.874|
0002dc  2000              MOVS     r0,#0
                  |L12.734|
0002de  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
0002e0  2972              CMP      r1,#0x72
0002e2  d044              BEQ      |L12.878|
0002e4  2100              MOVS     r1,#0
                  |L12.742|
0002e6  4008              ANDS     r0,r0,r1
0002e8  7911              LDRB     r1,[r2,#4]  ; RxBuffer
0002ea  2974              CMP      r1,#0x74
0002ec  d041              BEQ      |L12.882|
0002ee  2100              MOVS     r1,#0
                  |L12.752|
0002f0  4008              ANDS     r0,r0,r1
0002f2  7951              LDRB     r1,[r2,#5]  ; RxBuffer
0002f4  295f              CMP      r1,#0x5f
0002f6  d03e              BEQ      |L12.886|
0002f8  2100              MOVS     r1,#0
                  |L12.762|
0002fa  4008              ANDS     r0,r0,r1
0002fc  7991              LDRB     r1,[r2,#6]  ; RxBuffer
0002fe  2963              CMP      r1,#0x63
000300  d03b              BEQ      |L12.890|
000302  2100              MOVS     r1,#0
                  |L12.772|
000304  4008              ANDS     r0,r0,r1
000306  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
000308  296f              CMP      r1,#0x6f
00030a  d038              BEQ      |L12.894|
00030c  2100              MOVS     r1,#0
                  |L12.782|
00030e  4008              ANDS     r0,r0,r1
000310  7a11              LDRB     r1,[r2,#8]  ; RxBuffer
000312  296e              CMP      r1,#0x6e
000314  d035              BEQ      |L12.898|
000316  2100              MOVS     r1,#0
                  |L12.792|
000318  4008              ANDS     r0,r0,r1
00031a  4955              LDR      r1,|L12.1136|
00031c  7a49              LDRB     r1,[r1,#9]  ; RxBuffer
00031e  2966              CMP      r1,#0x66
000320  d031              BEQ      |L12.902|
000322  2100              MOVS     r1,#0
                  |L12.804|
;;;558    		{
;;;559    			u16 i=0;
;;;560    			u8 errors=0;
;;;561    			
;;;562    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
;;;563    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
;;;564    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
;;;565    	
;;;566    		
;;;567    			for (i = 0; i < rxsize-10; i += 2)
;;;568    			{
;;;569    			  tmp1=RxBuffer[i+10];
;;;570    				tmp2=RxBuffer[i+11];
;;;571    				tmp3=0;
;;;572    				if (tmp1>'9')	
;;;573    						tmp3=(tmp1-0x37)<<4;
;;;574    				else
;;;575    						tmp3=(tmp1-0x30)<<4;
;;;576    	
;;;577    				if (tmp2>'9')	
;;;578    						tmp3+=(tmp2-0x37);
;;;579    				else
;;;580    						tmp3+=(tmp2-0x30);				
;;;581    				*(__IO uint8_t *) (BKPSRAM_BASE + (i>>1)) = tmp3;//*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i);
;;;582    				if (*(__IO uint8_t *) (BKPSRAM_BASE + (i>>1)) != tmp3)
;;;583    						errors=1;
;;;584    			}
;;;585    
;;;586    			if (errors==0)
;;;587    			{
;;;588    			TxBuffer[0]='w';
;;;589    			TxBuffer[1]='r';	
;;;590    			TxBuffer[2]='t';
;;;591    			TxBuffer[3]='_';					
;;;592    			TxBuffer[4]='c';		
;;;593    			TxBuffer[5]='o';	
;;;594    			TxBuffer[6]='n';	
;;;595    			TxBuffer[7]='f';	
;;;596    			TxBuffer[8]='_';	
;;;597    			TxBuffer[9]='o';
;;;598    			TxBuffer[10]='k';	
;;;599    			}
;;;600    			else
;;;601    			{
;;;602    				TxBuffer[0]='w';
;;;603    				TxBuffer[1]='r';	
;;;604    				TxBuffer[2]='t';
;;;605    				TxBuffer[3]='_';					
;;;606    				TxBuffer[4]='c';		
;;;607    				TxBuffer[5]='o';	
;;;608    				TxBuffer[6]='n';	
;;;609    				TxBuffer[7]='f';	
;;;610    				TxBuffer[8]='_';	
;;;611    				TxBuffer[9]='e';
;;;612    				TxBuffer[10]='r';	
;;;613    			}
;;;614    	
;;;615    			txsize=11;
;;;616    			tekper=0;
000324  f8dfb14c          LDR      r11,|L12.1140|
000328  f8df914c          LDR      r9,|L12.1144|
00032c  4f53              LDR      r7,|L12.1148|
00032e  f8dfa150          LDR      r10,|L12.1152|
000332  4208              TST      r0,r1                 ;557
000334  d062              BEQ      |L12.1020|
000336  2600              MOVS     r6,#0                 ;559
000338  46b0              MOV      r8,r6                 ;560
00033a  4632              MOV      r2,r6                 ;562
00033c  f2405125          MOV      r1,#0x525             ;562
000340  4648              MOV      r0,r9                 ;562
000342  f7fffffe          BL       USART_ITConfig
000346  2201              MOVS     r2,#1                 ;563
000348  f2406126          MOV      r1,#0x626             ;563
00034c  4648              MOV      r0,r9                 ;563
00034e  f7fffffe          BL       USART_ITConfig
000352  2201              MOVS     r2,#1                 ;564
000354  2108              MOVS     r1,#8                 ;564
000356  484b              LDR      r0,|L12.1156|
000358  f7fffffe          BL       GPIO_WriteBit
00035c  f8dfc128          LDR      r12,|L12.1160|
000360  4b4a              LDR      r3,|L12.1164|
000362  494b              LDR      r1,|L12.1168|
000364  f8dfe108          LDR      lr,|L12.1136|
000368  e034              B        |L12.980|
                  |L12.874|
00036a  2001              MOVS     r0,#1                 ;557
00036c  e7b7              B        |L12.734|
                  |L12.878|
00036e  2101              MOVS     r1,#1                 ;557
000370  e7b9              B        |L12.742|
                  |L12.882|
000372  2101              MOVS     r1,#1                 ;557
000374  e7bc              B        |L12.752|
                  |L12.886|
000376  2101              MOVS     r1,#1                 ;557
000378  e7bf              B        |L12.762|
                  |L12.890|
00037a  2101              MOVS     r1,#1                 ;557
00037c  e7c2              B        |L12.772|
                  |L12.894|
00037e  2101              MOVS     r1,#1                 ;557
000380  e7c5              B        |L12.782|
                  |L12.898|
000382  2101              MOVS     r1,#1                 ;557
000384  e7c8              B        |L12.792|
                  |L12.902|
000386  2101              MOVS     r1,#1                 ;557
000388  e7cc              B        |L12.804|
                  |L12.906|
00038a  eb0e0006          ADD      r0,lr,r6              ;569
00038e  7a82              LDRB     r2,[r0,#0xa]          ;569
000390  f88c2000          STRB     r2,[r12,#0]           ;569
000394  7ac0              LDRB     r0,[r0,#0xb]          ;570
000396  7018              STRB     r0,[r3,#0]            ;570
000398  2a39              CMP      r2,#0x39              ;572
00039a  700c              STRB     r4,[r1,#0]            ;571
00039c  ea4f1202          LSL      r2,r2,#4              ;575
0003a0  d901              BLS      |L12.934|
0003a2  f5a2725c          SUB      r2,r2,#0x370          ;573
                  |L12.934|
0003a6  700a              STRB     r2,[r1,#0]            ;575
0003a8  2839              CMP      r0,#0x39              ;577
0003aa  b2d2              UXTB     r2,r2                 ;580
0003ac  4410              ADD      r0,r0,r2              ;580
0003ae  d902              BLS      |L12.950|
0003b0  3837              SUBS     r0,r0,#0x37           ;578
0003b2  e001              B        |L12.952|
                  |L12.948|
0003b4  e371              B        |L12.2714|
                  |L12.950|
0003b6  3830              SUBS     r0,r0,#0x30           ;580
                  |L12.952|
0003b8  7008              STRB     r0,[r1,#0]            ;580
0003ba  b2c2              UXTB     r2,r0                 ;581
0003bc  4835              LDR      r0,|L12.1172|
0003be  eb000056          ADD      r0,r0,r6,LSR #1       ;581
0003c2  7002              STRB     r2,[r0,#0]            ;581
0003c4  7800              LDRB     r0,[r0,#0]            ;582
0003c6  780a              LDRB     r2,[r1,#0]            ;582  ; tmp3
0003c8  4290              CMP      r0,r2                 ;582
0003ca  d001              BEQ      |L12.976|
0003cc  f04f0801          MOV      r8,#1                 ;583
                  |L12.976|
0003d0  1cb6              ADDS     r6,r6,#2              ;567
0003d2  b2b6              UXTH     r6,r6                 ;567
                  |L12.980|
0003d4  4830              LDR      r0,|L12.1176|
0003d6  8800              LDRH     r0,[r0,#0]            ;567  ; rxsize
0003d8  380a              SUBS     r0,r0,#0xa            ;567
0003da  4286              CMP      r6,r0                 ;567
0003dc  dbd5              BLT      |L12.906|
0003de  2077              MOVS     r0,#0x77              ;557
0003e0  7038              STRB     r0,[r7,#0]            ;602
0003e2  2163              MOVS     r1,#0x63              ;557
0003e4  226e              MOVS     r2,#0x6e              ;557
0003e6  2366              MOVS     r3,#0x66              ;557
0003e8  f04f0072          MOV      r0,#0x72              ;603
0003ec  f1b80f00          CMP      r8,#0                 ;586
0003f0  7078              STRB     r0,[r7,#1]            ;603
0003f2  d07c              BEQ      |L12.1262|
0003f4  2674              MOVS     r6,#0x74              ;604
0003f6  70be              STRB     r6,[r7,#2]            ;604
0003f8  265f              MOVS     r6,#0x5f              ;605
0003fa  e04f              B        |L12.1180|
                  |L12.1020|
0003fc  e061              B        |L12.1218|
0003fe  0000              DCW      0x0000
                  |L12.1024|
                          DCD      0x40020810
                  |L12.1028|
                          DCD      kol_pribl_vkl
                  |L12.1032|
                          DCD      kol_pribl_vikl
                  |L12.1036|
                          DCD      conf
                  |L12.1040|
                          DCD      0x40020000
                  |L12.1044|
                          DCD      sost_pribl
                  |L12.1048|
                          DCD      kol_gr1_vkl
                  |L12.1052|
                          DCD      kol_gr2_vkl
                  |L12.1056|
                          DCD      ||fz||
                  |L12.1060|
                          DCD      summa
                  |L12.1064|
                          DCD      ADC3ConvertedValue
                  |L12.1068|
                          DCD      kol_average
                  |L12.1072|
                          DCD      average
                  |L12.1076|
                          DCD      fz_average
                  |L12.1080|
                          DCD      ||.data||
                  |L12.1084|
                          DCD      max
                  |L12.1088|
                          DCD      number_buff
                  |L12.1092|
                          DCD      por
                  |L12.1096|
                          DCD      Buf_adc_zap2
                  |L12.1100|
                          DCD      Buf_adc_zap1
                  |L12.1104|
                          DCD      ||del||
                  |L12.1108|
                          DCD      tick
                  |L12.1112|
                          DCD      time_label
                  |L12.1116|
                          DCD      DT_zap
                  |L12.1120|
                          DCD      buffering
                  |L12.1124|
                          DCD      avariya
                  |L12.1128|
                          DCD      minute
                  |L12.1132|
                          DCD      new_komand
                  |L12.1136|
                          DCD      RxBuffer
                  |L12.1140|
                          DCD      tekper
                  |L12.1144|
                          DCD      0x40004400
                  |L12.1148|
                          DCD      TxBuffer
                  |L12.1152|
                          DCD      txsize
                  |L12.1156|
                          DCD      0x40020c00
                  |L12.1160|
                          DCD      tmp1
                  |L12.1164|
                          DCD      tmp2
                  |L12.1168|
                          DCD      tmp3
                  |L12.1172|
                          DCD      0x40024000
                  |L12.1176|
                          DCD      rxsize
                  |L12.1180|
00049c  70fe              STRB     r6,[r7,#3]            ;605
00049e  7139              STRB     r1,[r7,#4]            ;606
0004a0  216f              MOVS     r1,#0x6f              ;607
0004a2  7179              STRB     r1,[r7,#5]            ;607
0004a4  71ba              STRB     r2,[r7,#6]            ;608
0004a6  71fb              STRB     r3,[r7,#7]            ;609
0004a8  723e              STRB     r6,[r7,#8]            ;610
0004aa  2165              MOVS     r1,#0x65              ;611
0004ac  7279              STRB     r1,[r7,#9]            ;611
                  |L12.1198|
0004ae  72b8              STRB     r0,[r7,#0xa]          ;612
0004b0  210b              MOVS     r1,#0xb               ;615
0004b2  f8aa1000          STRH     r1,[r10,#0]           ;615
0004b6  f8ab4000          STRH     r4,[r11,#0]
;;;617    			USART_SendData(USART2, 0x3A);
0004ba  213a              MOVS     r1,#0x3a
0004bc  4648              MOV      r0,r9
0004be  f7fffffe          BL       USART_SendData
                  |L12.1218|
;;;618    		}
;;;619    
;;;620    		// who?
;;;621    		if ((RxBuffer[2]=='w')&(RxBuffer[3]=='h')&(RxBuffer[4]=='o')&(RxBuffer[5]=='?'))
0004c2  4afe              LDR      r2,|L12.2236|
0004c4  7890              LDRB     r0,[r2,#2]  ; RxBuffer
0004c6  2877              CMP      r0,#0x77
0004c8  d07e              BEQ      |L12.1480|
0004ca  2000              MOVS     r0,#0
                  |L12.1228|
0004cc  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
0004ce  2968              CMP      r1,#0x68
0004d0  d07b              BEQ      |L12.1482|
0004d2  2100              MOVS     r1,#0
                  |L12.1236|
0004d4  4008              ANDS     r0,r0,r1
0004d6  7911              LDRB     r1,[r2,#4]  ; RxBuffer
0004d8  296f              CMP      r1,#0x6f
0004da  d077              BEQ      |L12.1484|
0004dc  2100              MOVS     r1,#0
                  |L12.1246|
0004de  4008              ANDS     r0,r0,r1
0004e0  7951              LDRB     r1,[r2,#5]  ; RxBuffer
0004e2  4690              MOV      r8,r2
0004e4  293f              CMP      r1,#0x3f
0004e6  d072              BEQ      |L12.1486|
0004e8  2100              MOVS     r1,#0
                  |L12.1258|
0004ea  4208              TST      r0,r1
;;;622    		{
;;;623    			
;;;624    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
;;;625    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
;;;626    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
;;;627    			
;;;628    			TxBuffer[0]='u';
;;;629    			TxBuffer[1]='s';	
0004ec  e000              B        |L12.1264|
                  |L12.1262|
0004ee  e2d6              B        |L12.2718|
                  |L12.1264|
0004f0  f04f0673          MOV      r6,#0x73
0004f4  d02d              BEQ      |L12.1362|
0004f6  2200              MOVS     r2,#0                 ;624
0004f8  f2405125          MOV      r1,#0x525             ;624
0004fc  4648              MOV      r0,r9                 ;624
0004fe  f7fffffe          BL       USART_ITConfig
000502  2201              MOVS     r2,#1                 ;625
000504  f2406126          MOV      r1,#0x626             ;625
000508  4648              MOV      r0,r9                 ;625
00050a  f7fffffe          BL       USART_ITConfig
00050e  2201              MOVS     r2,#1                 ;626
000510  2108              MOVS     r1,#8                 ;626
000512  48eb              LDR      r0,|L12.2240|
000514  f7fffffe          BL       GPIO_WriteBit
000518  2075              MOVS     r0,#0x75              ;628
00051a  7038              STRB     r0,[r7,#0]            ;628
00051c  707e              STRB     r6,[r7,#1]
;;;630    			TxBuffer[2]='o';
00051e  206f              MOVS     r0,#0x6f
000520  70b8              STRB     r0,[r7,#2]
;;;631    			TxBuffer[3]='_';					
000522  215f              MOVS     r1,#0x5f
000524  70f9              STRB     r1,[r7,#3]
;;;632    			TxBuffer[4]='a';		
000526  2061              MOVS     r0,#0x61
000528  7138              STRB     r0,[r7,#4]
;;;633    			TxBuffer[5]='r';	
00052a  2072              MOVS     r0,#0x72
00052c  7178              STRB     r0,[r7,#5]
;;;634    			TxBuffer[6]='m';	
00052e  206d              MOVS     r0,#0x6d
000530  71b8              STRB     r0,[r7,#6]
;;;635    			TxBuffer[7]='_';	
000532  71f9              STRB     r1,[r7,#7]
;;;636    			TxBuffer[8]='k';	
000534  206b              MOVS     r0,#0x6b
000536  7238              STRB     r0,[r7,#8]
;;;637    			TxBuffer[9]='e';
000538  2065              MOVS     r0,#0x65
00053a  7278              STRB     r0,[r7,#9]
;;;638    			TxBuffer[10]='y';	
00053c  2079              MOVS     r0,#0x79
00053e  72b8              STRB     r0,[r7,#0xa]
;;;639    	
;;;640    			txsize=11;
000540  210b              MOVS     r1,#0xb
000542  f8aa1000          STRH     r1,[r10,#0]
;;;641    			tekper=0;
000546  f8ab4000          STRH     r4,[r11,#0]
;;;642    			USART_SendData(USART2, 0x3A);
00054a  213a              MOVS     r1,#0x3a
00054c  4648              MOV      r0,r9
00054e  f7fffffe          BL       USART_SendData
                  |L12.1362|
;;;643    		}
;;;644    	
;;;645    		// restart
;;;646    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='e')&(RxBuffer[4]=='s')&(RxBuffer[5]=='t')&(RxBuffer[6]=='a')&(RxBuffer[7]=='r')&(RxBuffer[8]=='t'))
000552  f8980002          LDRB     r0,[r8,#2]  ; RxBuffer
000556  4642              MOV      r2,r8
000558  2872              CMP      r0,#0x72
00055a  d07d              BEQ      |L12.1624|
00055c  2000              MOVS     r0,#0
                  |L12.1374|
00055e  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
000560  2965              CMP      r1,#0x65
000562  d07a              BEQ      |L12.1626|
000564  2100              MOVS     r1,#0
                  |L12.1382|
000566  4008              ANDS     r0,r0,r1
000568  7911              LDRB     r1,[r2,#4]  ; RxBuffer
00056a  2973              CMP      r1,#0x73
00056c  d076              BEQ      |L12.1628|
00056e  2100              MOVS     r1,#0
                  |L12.1392|
000570  4008              ANDS     r0,r0,r1
000572  7951              LDRB     r1,[r2,#5]  ; RxBuffer
000574  2974              CMP      r1,#0x74
000576  d072              BEQ      |L12.1630|
000578  2100              MOVS     r1,#0
                  |L12.1402|
00057a  4008              ANDS     r0,r0,r1
00057c  7991              LDRB     r1,[r2,#6]  ; RxBuffer
00057e  2961              CMP      r1,#0x61
000580  d06e              BEQ      |L12.1632|
000582  2100              MOVS     r1,#0
                  |L12.1412|
000584  4008              ANDS     r0,r0,r1
000586  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
000588  2972              CMP      r1,#0x72
00058a  d06a              BEQ      |L12.1634|
00058c  2100              MOVS     r1,#0
                  |L12.1422|
00058e  4008              ANDS     r0,r0,r1
000590  f8981008          LDRB     r1,[r8,#8]  ; RxBuffer
000594  2974              CMP      r1,#0x74
000596  d07d              BEQ      |L12.1684|
000598  2100              MOVS     r1,#0
                  |L12.1434|
00059a  4208              TST      r0,r1
00059c  d032              BEQ      |L12.1540|
;;;647    		{
;;;648    			
;;;649    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
00059e  2200              MOVS     r2,#0
0005a0  f2405125          MOV      r1,#0x525
0005a4  4648              MOV      r0,r9
0005a6  f7fffffe          BL       USART_ITConfig
;;;650    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
0005aa  2201              MOVS     r2,#1
0005ac  f2406126          MOV      r1,#0x626
0005b0  4648              MOV      r0,r9
0005b2  f7fffffe          BL       USART_ITConfig
;;;651    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
0005b6  2201              MOVS     r2,#1
0005b8  2108              MOVS     r1,#8
0005ba  48c1              LDR      r0,|L12.2240|
0005bc  f7fffffe          BL       GPIO_WriteBit
;;;652    			
;;;653    			TxBuffer[0]='r';
0005c0  2172              MOVS     r1,#0x72
0005c2  7039              STRB     r1,[r7,#0]
;;;654    			TxBuffer[1]='e';	
0005c4  2065              MOVS     r0,#0x65
0005c6  e003              B        |L12.1488|
                  |L12.1480|
0005c8  e276              B        |L12.2744|
                  |L12.1482|
0005ca  e277              B        |L12.2748|
                  |L12.1484|
0005cc  e278              B        |L12.2752|
                  |L12.1486|
0005ce  e279              B        |L12.2756|
                  |L12.1488|
0005d0  7078              STRB     r0,[r7,#1]
;;;655    			TxBuffer[2]='s';
0005d2  70be              STRB     r6,[r7,#2]
;;;656    			TxBuffer[3]='t';					
0005d4  2074              MOVS     r0,#0x74
0005d6  70f8              STRB     r0,[r7,#3]
;;;657    			TxBuffer[4]='a';		
0005d8  2261              MOVS     r2,#0x61
0005da  713a              STRB     r2,[r7,#4]
;;;658    			TxBuffer[5]='r';	
0005dc  7179              STRB     r1,[r7,#5]
;;;659    			TxBuffer[6]='t';	
0005de  71b8              STRB     r0,[r7,#6]
;;;660    			TxBuffer[7]='_';	
0005e0  205f              MOVS     r0,#0x5f
0005e2  71f8              STRB     r0,[r7,#7]
;;;661    			TxBuffer[8]='o';	
0005e4  206f              MOVS     r0,#0x6f
0005e6  7238              STRB     r0,[r7,#8]
;;;662    			TxBuffer[9]='k';
0005e8  206b              MOVS     r0,#0x6b
0005ea  7278              STRB     r0,[r7,#9]
;;;663    	
;;;664    			txsize=10;
0005ec  210a              MOVS     r1,#0xa
0005ee  f8aa1000          STRH     r1,[r10,#0]
;;;665    			tekper=0;
0005f2  f8ab4000          STRH     r4,[r11,#0]
;;;666    			USART_SendData(USART2, 0x3A);
0005f6  213a              MOVS     r1,#0x3a
0005f8  4648              MOV      r0,r9
0005fa  f7fffffe          BL       USART_SendData
;;;667    			
;;;668    			SCB->AIRCR = 0x05FA0004;
0005fe  48b2              LDR      r0,|L12.2248|
000600  49b0              LDR      r1,|L12.2244|
000602  6001              STR      r1,[r0,#0]
                  |L12.1540|
;;;669    			
;;;670    			
;;;671    			
;;;672    			// need restart
;;;673    		}
;;;674    	
;;;675    		// set_time
;;;676    		if ((RxBuffer[2]=='s')&(RxBuffer[3]=='e')&(RxBuffer[4]=='t')&(RxBuffer[5]=='_')&(RxBuffer[6]=='t')&(RxBuffer[7]=='i')&(RxBuffer[8]=='m')&(RxBuffer[9]=='e'))
000604  f8980002          LDRB     r0,[r8,#2]  ; RxBuffer
000608  4642              MOV      r2,r8
00060a  2873              CMP      r0,#0x73
00060c  d07d              BEQ      |L12.1802|
00060e  2000              MOVS     r0,#0
                  |L12.1552|
000610  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
000612  2965              CMP      r1,#0x65
000614  d07a              BEQ      |L12.1804|
000616  2100              MOVS     r1,#0
                  |L12.1560|
000618  4008              ANDS     r0,r0,r1
00061a  7911              LDRB     r1,[r2,#4]  ; RxBuffer
00061c  2974              CMP      r1,#0x74
00061e  d076              BEQ      |L12.1806|
000620  2100              MOVS     r1,#0
                  |L12.1570|
000622  4008              ANDS     r0,r0,r1
000624  7951              LDRB     r1,[r2,#5]  ; RxBuffer
000626  295f              CMP      r1,#0x5f
000628  d072              BEQ      |L12.1808|
00062a  2100              MOVS     r1,#0
                  |L12.1580|
00062c  4008              ANDS     r0,r0,r1
00062e  7991              LDRB     r1,[r2,#6]  ; RxBuffer
000630  2974              CMP      r1,#0x74
000632  d06e              BEQ      |L12.1810|
000634  2100              MOVS     r1,#0
                  |L12.1590|
000636  4008              ANDS     r0,r0,r1
000638  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
00063a  2969              CMP      r1,#0x69
00063c  d06a              BEQ      |L12.1812|
00063e  2100              MOVS     r1,#0
                  |L12.1600|
000640  4008              ANDS     r0,r0,r1
000642  f8981008          LDRB     r1,[r8,#8]  ; RxBuffer
000646  296d              CMP      r1,#0x6d
000648  d065              BEQ      |L12.1814|
00064a  2100              MOVS     r1,#0
                  |L12.1612|
00064c  4008              ANDS     r0,r0,r1
00064e  499b              LDR      r1,|L12.2236|
000650  7a49              LDRB     r1,[r1,#9]  ; RxBuffer
000652  2965              CMP      r1,#0x65
000654  d07e              BEQ      |L12.1876|
000656  e005              B        |L12.1636|
                  |L12.1624|
000658  e236              B        |L12.2760|
                  |L12.1626|
00065a  e237              B        |L12.2764|
                  |L12.1628|
00065c  e238              B        |L12.2768|
                  |L12.1630|
00065e  e239              B        |L12.2772|
                  |L12.1632|
000660  e23a              B        |L12.2776|
                  |L12.1634|
000662  e23b              B        |L12.2780|
                  |L12.1636|
000664  2100              MOVS     r1,#0
                  |L12.1638|
000666  4208              TST      r0,r1
000668  d075              BEQ      |L12.1878|
;;;677    		{		
;;;678    			extern void rtc_SetDate(uint8_t Day, uint8_t Month, uint8_t Year, uint8_t DayOfWeek);
;;;679    			extern  void rtc_SetTime(uint8_t Hours, uint8_t Minutes, uint8_t Seconds);
;;;680    			extern  void rtc_Unlock(void);
;;;681    			extern void rtc_Lock(void);
;;;682    			
;;;683    			uint32_t Tens, Units;
;;;684          uint32_t TempReg = 0;
;;;685    			u8 i=0;
;;;686    			
;;;687    			
;;;688    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
00066a  2200              MOVS     r2,#0
00066c  f2405125          MOV      r1,#0x525
000670  4648              MOV      r0,r9
000672  f7fffffe          BL       USART_ITConfig
;;;689    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
000676  2201              MOVS     r2,#1
000678  f2406126          MOV      r1,#0x626
00067c  4648              MOV      r0,r9
00067e  f7fffffe          BL       USART_ITConfig
;;;690    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
000682  2201              MOVS     r2,#1
000684  2108              MOVS     r1,#8
000686  488e              LDR      r0,|L12.2240|
000688  f7fffffe          BL       GPIO_WriteBit
;;;691    
;;;692    
;;;693    			// set time
;;;694    		rtc_Unlock();
00068c  f7fffffe          BL       rtc_Unlock
;;;695    		RTC->ISR |= RTC_ISR_INIT;
000690  488e              LDR      r0,|L12.2252|
000692  e000              B        |L12.1686|
                  |L12.1684|
000694  e224              B        |L12.2784|
                  |L12.1686|
000696  6801              LDR      r1,[r0,#0]
000698  f0410180          ORR      r1,r1,#0x80
00069c  6001              STR      r1,[r0,#0]
                  |L12.1694|
;;;696    		while(!(RTC->ISR & RTC_ISR_INITF)) {}
00069e  488b              LDR      r0,|L12.2252|
0006a0  6800              LDR      r0,[r0,#0]
0006a2  0640              LSLS     r0,r0,#25
0006a4  d5fb              BPL      |L12.1694|
;;;697    
;;;698    		RTC->PRER = 263; //Sync;         
0006a6  4889              LDR      r0,|L12.2252|
0006a8  f2401107          MOV      r1,#0x107
0006ac  1d00              ADDS     r0,r0,#4
0006ae  6001              STR      r1,[r0,#0]
;;;699        RTC->PRER =263 | (127<<16); //Sync | (Async << 16);
0006b0  4987              LDR      r1,|L12.2256|
0006b2  6001              STR      r1,[r0,#0]
;;;700    			
;;;701    			
;;;702    			TxBuffer[0]='s';
0006b4  703e              STRB     r6,[r7,#0]
;;;703    			TxBuffer[1]='e';	
0006b6  2065              MOVS     r0,#0x65
0006b8  7078              STRB     r0,[r7,#1]
;;;704    			TxBuffer[2]='t';
0006ba  2174              MOVS     r1,#0x74
0006bc  70b9              STRB     r1,[r7,#2]
;;;705    			TxBuffer[3]='_';					
0006be  225f              MOVS     r2,#0x5f
0006c0  70fa              STRB     r2,[r7,#3]
;;;706    			TxBuffer[4]='t';		
0006c2  7139              STRB     r1,[r7,#4]
;;;707    			TxBuffer[5]='i';	
0006c4  2169              MOVS     r1,#0x69
0006c6  7179              STRB     r1,[r7,#5]
;;;708    			TxBuffer[6]='m';	
0006c8  216d              MOVS     r1,#0x6d
0006ca  71b9              STRB     r1,[r7,#6]
;;;709    			TxBuffer[7]='e';	
0006cc  71f8              STRB     r0,[r7,#7]
;;;710    			TxBuffer[8]='_';	
0006ce  723a              STRB     r2,[r7,#8]
;;;711    			TxBuffer[9]='o';
0006d0  206f              MOVS     r0,#0x6f
0006d2  7278              STRB     r0,[r7,#9]
;;;712    			TxBuffer[10]='k';
;;;713    			
;;;714    
;;;715        // set time
;;;716    rtc_SetTime((RxBuffer[16]-0x30)*10+(RxBuffer[17]-0x30), (RxBuffer[18]-0x30)*10+(RxBuffer[19]-0x30), (RxBuffer[20]-0x30)*10+(RxBuffer[21]-0x30));
0006d4  4e79              LDR      r6,|L12.2236|
0006d6  206b              MOVS     r0,#0x6b              ;712
0006d8  72b8              STRB     r0,[r7,#0xa]          ;712
0006da  7d30              LDRB     r0,[r6,#0x14]  ; RxBuffer
0006dc  7d71              LDRB     r1,[r6,#0x15]  ; RxBuffer
0006de  3830              SUBS     r0,r0,#0x30
0006e0  eb000280          ADD      r2,r0,r0,LSL #2
0006e4  f06f082f          MVN      r8,#0x2f
0006e8  eb080042          ADD      r0,r8,r2,LSL #1
0006ec  4408              ADD      r0,r0,r1
0006ee  b2c2              UXTB     r2,r0
0006f0  7cb0              LDRB     r0,[r6,#0x12]  ; RxBuffer
0006f2  7cf1              LDRB     r1,[r6,#0x13]  ; RxBuffer
0006f4  3830              SUBS     r0,r0,#0x30
0006f6  eb000380          ADD      r3,r0,r0,LSL #2
0006fa  eb080043          ADD      r0,r8,r3,LSL #1
0006fe  4408              ADD      r0,r0,r1
000700  b2c1              UXTB     r1,r0
000702  7c30              LDRB     r0,[r6,#0x10]  ; RxBuffer
000704  7c73              LDRB     r3,[r6,#0x11]  ; RxBuffer
000706  3830              SUBS     r0,r0,#0x30
000708  e006              B        |L12.1816|
                  |L12.1802|
00070a  e1eb              B        |L12.2788|
                  |L12.1804|
00070c  e1ec              B        |L12.2792|
                  |L12.1806|
00070e  e1ed              B        |L12.2796|
                  |L12.1808|
000710  e1f1              B        |L12.2806|
                  |L12.1810|
000712  e1f2              B        |L12.2810|
                  |L12.1812|
000714  e1f3              B        |L12.2814|
                  |L12.1814|
000716  e1f4              B        |L12.2818|
                  |L12.1816|
000718  eb000c80          ADD      r12,r0,r0,LSL #2
00071c  eb08004c          ADD      r0,r8,r12,LSL #1
000720  4418              ADD      r0,r0,r3
000722  b2c0              UXTB     r0,r0
000724  f7fffffe          BL       rtc_SetTime
;;;717    
;;;718    rtc_SetDate((RxBuffer[10]-0x30)*10+(RxBuffer[11]-0x30), (RxBuffer[12]-0x30)*10+(RxBuffer[13]-0x30), (RxBuffer[14]-0x30)*10+(RxBuffer[15]-0x30),1);
000728  7bb0              LDRB     r0,[r6,#0xe]  ; RxBuffer
00072a  7bf1              LDRB     r1,[r6,#0xf]  ; RxBuffer
00072c  3830              SUBS     r0,r0,#0x30
00072e  eb000280          ADD      r2,r0,r0,LSL #2
000732  eb080042          ADD      r0,r8,r2,LSL #1
000736  4408              ADD      r0,r0,r1
000738  b2c2              UXTB     r2,r0
00073a  7b30              LDRB     r0,[r6,#0xc]  ; RxBuffer
00073c  7b71              LDRB     r1,[r6,#0xd]  ; RxBuffer
00073e  3830              SUBS     r0,r0,#0x30
000740  eb000380          ADD      r3,r0,r0,LSL #2
000744  eb080043          ADD      r0,r8,r3,LSL #1
000748  4408              ADD      r0,r0,r1
00074a  b2c1              UXTB     r1,r0
00074c  7ab0              LDRB     r0,[r6,#0xa]  ; RxBuffer
00074e  7af3              LDRB     r3,[r6,#0xb]  ; RxBuffer
000750  3830              SUBS     r0,r0,#0x30
000752  e001              B        |L12.1880|
                  |L12.1876|
000754  e1d7              B        |L12.2822|
                  |L12.1878|
000756  e02d              B        |L12.1972|
                  |L12.1880|
000758  eb000c80          ADD      r12,r0,r0,LSL #2
00075c  eb08004c          ADD      r0,r8,r12,LSL #1
000760  4418              ADD      r0,r0,r3
000762  b2c0              UXTB     r0,r0
000764  2301              MOVS     r3,#1
000766  f7fffffe          BL       rtc_SetDate
;;;719    /*
;;;720    if (1)
;;;721    {
;;;722    
;;;723        TempReg = 0;
;;;724        {
;;;725            Tens  = ((RxBuffer[10]-0x30) / 10) & 0x0f;          // ??????? ???
;;;726            Units = (RxBuffer[11]-0x30) & 0x0f; // ??????? ???
;;;727            
;;;728            TempReg |= (Tens  << 20); // YT, 20
;;;729            TempReg |= (Units << 16); // YU, 16
;;;730        }
;;;731        {
;;;732            Tens  = (RxBuffer[12]-0x30) & 0x01;          // ??????? ???????
;;;733            Units = (RxBuffer[13]-0x30) & 0x0f; // ??????? ???????
;;;734            
;;;735            TempReg |= (Tens  << 12); // MT, 12
;;;736            TempReg |= (Units << 8);  // MU, 8
;;;737        }
;;;738        {
;;;739            Tens  = (RxBuffer[14]-0x30) & 0x03;          // ??????? ????
;;;740            Units = (RxBuffer[15]-0x30) & 0x0f; // ??????? ????
;;;741            
;;;742            TempReg |= (Tens  << 4); // DT, 4
;;;743            TempReg |= (Units << 0);  // DU, 0
;;;744        }
;;;745        {
;;;746            TempReg |= ((1 & 0x07) << 13); // WDU, 13
;;;747        }
;;;748        RTC->DR = TempReg;	
;;;749    	}	
;;;750    */
;;;751    		RTC->CR |= RTC_CR_FMT;
00076a  4858              LDR      r0,|L12.2252|
00076c  1f00              SUBS     r0,r0,#4
00076e  6801              LDR      r1,[r0,#0]
000770  f0410140          ORR      r1,r1,#0x40
000774  6001              STR      r1,[r0,#0]
;;;752        RTC->ISR &= ~RTC_ISR_INIT;
000776  1d00              ADDS     r0,r0,#4
000778  6801              LDR      r1,[r0,#0]
00077a  f0210180          BIC      r1,r1,#0x80
00077e  6001              STR      r1,[r0,#0]
;;;753    		rtc_Lock();
000780  f7fffffe          BL       rtc_Lock
                  |L12.1924|
;;;754    
;;;755    	
;;;756    		rtc_Get(&DT1);
;;;757    //			while (TempReg!=RTC->DR)
;;;758    		while (((RxBuffer[10]-0x30)*10+(RxBuffer[11]-0x30))!=DT1.Day)
;;;759    				rtc_Get(&DT1);
000784  4853              LDR      r0,|L12.2260|
000786  f7fffffe          BL       rtc_Get
00078a  7ab0              LDRB     r0,[r6,#0xa]          ;758  ; RxBuffer
00078c  7af1              LDRB     r1,[r6,#0xb]          ;758  ; RxBuffer
00078e  3830              SUBS     r0,r0,#0x30           ;758
000790  eb000280          ADD      r2,r0,r0,LSL #2       ;758
000794  eb080042          ADD      r0,r8,r2,LSL #1       ;758
000798  4401              ADD      r1,r1,r0              ;758
00079a  484e              LDR      r0,|L12.2260|
00079c  7880              LDRB     r0,[r0,#2]            ;758  ; DT1
00079e  4281              CMP      r1,r0                 ;758
0007a0  d1f0              BNE      |L12.1924|
;;;760    
;;;761    				
;;;762    			txsize=11;
0007a2  200b              MOVS     r0,#0xb
0007a4  f8aa0000          STRH     r0,[r10,#0]
;;;763    			tekper=0;
0007a8  f8ab4000          STRH     r4,[r11,#0]
;;;764    			USART_SendData(USART2, 0x3A);
0007ac  213a              MOVS     r1,#0x3a
0007ae  4648              MOV      r0,r9
0007b0  f7fffffe          BL       USART_SendData
                  |L12.1972|
;;;765    			
;;;766    			// need restart
;;;767    		}
;;;768    		
;;;769    		// read
;;;770    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='e')&(RxBuffer[4]=='a')&(RxBuffer[5]=='d'))
0007b4  4a41              LDR      r2,|L12.2236|
0007b6  7890              LDRB     r0,[r2,#2]  ; RxBuffer
0007b8  2872              CMP      r0,#0x72
0007ba  d07b              BEQ      |L12.2228|
0007bc  2000              MOVS     r0,#0
                  |L12.1982|
0007be  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
0007c0  2965              CMP      r1,#0x65
0007c2  d078              BEQ      |L12.2230|
0007c4  2100              MOVS     r1,#0
                  |L12.1990|
0007c6  4008              ANDS     r0,r0,r1
0007c8  7911              LDRB     r1,[r2,#4]  ; RxBuffer
0007ca  2961              CMP      r1,#0x61
0007cc  d074              BEQ      |L12.2232|
0007ce  2100              MOVS     r1,#0
                  |L12.2000|
0007d0  4008              ANDS     r0,r0,r1
0007d2  493a              LDR      r1,|L12.2236|
0007d4  7949              LDRB     r1,[r1,#5]  ; RxBuffer
0007d6  2964              CMP      r1,#0x64
0007d8  d06f              BEQ      |L12.2234|
0007da  2100              MOVS     r1,#0
                  |L12.2012|
0007dc  4208              TST      r0,r1
0007de  d07d              BEQ      |L12.2268|
;;;771    		{
;;;772    			
;;;773    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
0007e0  2200              MOVS     r2,#0
0007e2  f2405125          MOV      r1,#0x525
0007e6  4648              MOV      r0,r9
0007e8  f7fffffe          BL       USART_ITConfig
;;;774    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
0007ec  2201              MOVS     r2,#1
0007ee  f2406126          MOV      r1,#0x626
0007f2  4648              MOV      r0,r9
0007f4  f7fffffe          BL       USART_ITConfig
;;;775    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
0007f8  2201              MOVS     r2,#1
0007fa  2108              MOVS     r1,#8
0007fc  4830              LDR      r0,|L12.2240|
0007fe  f7fffffe          BL       GPIO_WriteBit
;;;776    			
;;;777    			// test zapis for controlling time on fleshka
;;;778    			tmp=por;
000802  4835              LDR      r0,|L12.2264|
;;;779    			TxBuffer[0]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
000804  f44f717a          MOV      r1,#0x3e8
;;;780    			tmp%=1000;
;;;781    			TxBuffer[1]=(uint8_t)(tmp/100)+(uint8_t)0x30;
;;;782    			tmp%=100;		
;;;783    			TxBuffer[2]=(uint8_t)(tmp/10)+(uint8_t)0x30;
;;;784    			tmp%=10;	
;;;785    			TxBuffer[3]=(uint8_t)(tmp)+(uint8_t)0x30;		
;;;786    				
;;;787    			TxBuffer[4]=0x20;	
;;;788    
;;;789    			// date
;;;790    			TxBuffer[5]=(uint8_t)(DT1.Year/10)+(uint8_t)0x30;	
000808  f8df80c8          LDR      r8,|L12.2260|
00080c  8800              LDRH     r0,[r0,#0]            ;778  ; por
00080e  fbb0f2f1          UDIV     r2,r0,r1              ;779
000812  f1020330          ADD      r3,r2,#0x30           ;779
000816  703b              STRB     r3,[r7,#0]            ;779
000818  fb010012          MLS      r0,r1,r2,r0           ;780
00081c  2364              MOVS     r3,#0x64              ;781
00081e  fbb0f2f3          UDIV     r2,r0,r3              ;781
000822  f1020630          ADD      r6,r2,#0x30           ;781
000826  fb030212          MLS      r2,r3,r2,r0           ;782
00082a  707e              STRB     r6,[r7,#1]            ;781
00082c  200a              MOVS     r0,#0xa               ;783
00082e  fbb2f6f0          UDIV     r6,r2,r0              ;783
000832  fb002216          MLS      r2,r0,r6,r2           ;784
000836  f1060c30          ADD      r12,r6,#0x30          ;783
00083a  f887c002          STRB     r12,[r7,#2]           ;783
00083e  3230              ADDS     r2,r2,#0x30           ;785
000840  70fa              STRB     r2,[r7,#3]            ;785
000842  2220              MOVS     r2,#0x20              ;787
000844  713a              STRB     r2,[r7,#4]            ;787
000846  f898c000          LDRB     r12,[r8,#0]  ; DT1
00084a  fbbcfef0          UDIV     lr,r12,r0
00084e  f10e0630          ADD      r6,lr,#0x30
000852  717e              STRB     r6,[r7,#5]
;;;791    			TxBuffer[6]=(uint8_t)(DT1.Year%10)+(uint8_t)0x30;	
000854  fb00c61e          MLS      r6,r0,lr,r12
000858  3630              ADDS     r6,r6,#0x30
00085a  71be              STRB     r6,[r7,#6]
;;;792    			TxBuffer[7]=(uint8_t)(DT1.Month/10)+(uint8_t)0x30;	
00085c  f898c001          LDRB     r12,[r8,#1]  ; DT1
000860  fbbcfef0          UDIV     lr,r12,r0
000864  f10e0630          ADD      r6,lr,#0x30
000868  71fe              STRB     r6,[r7,#7]
;;;793    			TxBuffer[8]=(uint8_t)(DT1.Month%10)+(uint8_t)0x30;	
00086a  fb00c61e          MLS      r6,r0,lr,r12
00086e  3630              ADDS     r6,r6,#0x30
000870  723e              STRB     r6,[r7,#8]
;;;794    			TxBuffer[9]=(uint8_t)(DT1.Day/10)+(uint8_t)0x30;	
000872  f898c002          LDRB     r12,[r8,#2]  ; DT1
000876  fbbcfef0          UDIV     lr,r12,r0
00087a  f10e0630          ADD      r6,lr,#0x30
00087e  727e              STRB     r6,[r7,#9]
;;;795    			TxBuffer[10]=(uint8_t)(DT1.Day%10)+(uint8_t)0x30;	
000880  fb00c61e          MLS      r6,r0,lr,r12
000884  3630              ADDS     r6,r6,#0x30
000886  72be              STRB     r6,[r7,#0xa]
;;;796    			TxBuffer[11]=0x20;				
000888  72fa              STRB     r2,[r7,#0xb]
;;;797    			
;;;798    			// time
;;;799    			TxBuffer[12]=(uint8_t)(DT1.Hours/10)+(uint8_t)0x30;	
00088a  f898c004          LDRB     r12,[r8,#4]  ; DT1
00088e  fbbcfef0          UDIV     lr,r12,r0
000892  f10e0630          ADD      r6,lr,#0x30
000896  733e              STRB     r6,[r7,#0xc]
;;;800    			TxBuffer[13]=(uint8_t)(DT1.Hours%10)+(uint8_t)0x30;			
000898  fb00c61e          MLS      r6,r0,lr,r12
00089c  3630              ADDS     r6,r6,#0x30
00089e  737e              STRB     r6,[r7,#0xd]
;;;801    			TxBuffer[14]=(uint8_t)(DT1.Minutes/10)+(uint8_t)0x30;	
0008a0  f898c005          LDRB     r12,[r8,#5]  ; DT1
0008a4  fbbcfef0          UDIV     lr,r12,r0
0008a8  f10e0630          ADD      r6,lr,#0x30
0008ac  73be              STRB     r6,[r7,#0xe]
;;;802    			TxBuffer[15]=(uint8_t)(DT1.Minutes%10)+(uint8_t)0x30;	
0008ae  fb00c61e          MLS      r6,r0,lr,r12
0008b2  e014              B        |L12.2270|
                  |L12.2228|
0008b4  e12b              B        |L12.2830|
                  |L12.2230|
0008b6  e12c              B        |L12.2834|
                  |L12.2232|
0008b8  e12d              B        |L12.2838|
                  |L12.2234|
0008ba  e12e              B        |L12.2842|
                  |L12.2236|
                          DCD      RxBuffer
                  |L12.2240|
                          DCD      0x40020c00
                  |L12.2244|
                          DCD      0x05fa0004
                  |L12.2248|
                          DCD      0xe000ed0c
                  |L12.2252|
                          DCD      0x4000280c
                  |L12.2256|
                          DCD      0x007f0107
                  |L12.2260|
                          DCD      ||.data||+0xc
                  |L12.2264|
                          DCD      por
                  |L12.2268|
0008dc  e094              B        |L12.2568|
                  |L12.2270|
0008de  3630              ADDS     r6,r6,#0x30
0008e0  73fe              STRB     r6,[r7,#0xf]
;;;803    			TxBuffer[16]=(uint8_t)(DT1.Seconds/10)+(uint8_t)0x30;	
0008e2  f898c006          LDRB     r12,[r8,#6]  ; DT1
0008e6  fbbcf8f0          UDIV     r8,r12,r0
0008ea  f1080630          ADD      r6,r8,#0x30
0008ee  743e              STRB     r6,[r7,#0x10]
;;;804    			TxBuffer[17]=(uint8_t)(DT1.Seconds%10)+(uint8_t)0x30;	
0008f0  fb00c618          MLS      r6,r0,r8,r12
0008f4  3630              ADDS     r6,r6,#0x30
0008f6  747e              STRB     r6,[r7,#0x11]
;;;805    			TxBuffer[18]=0x20;
0008f8  74ba              STRB     r2,[r7,#0x12]
;;;806    			
;;;807    			// dat pribl
;;;808    			TxBuffer[19]=sost_pribl+0x30;
0008fa  782d              LDRB     r5,[r5,#0]  ; sost_pribl
0008fc  3530              ADDS     r5,r5,#0x30
0008fe  74fd              STRB     r5,[r7,#0x13]
;;;809    			TxBuffer[20]=0x20;
;;;810    			
;;;811    			
;;;812    			// zn from adc with calibr and averaging
;;;813    			tmp=ADC3ConvertedValue%10000;
000900  4d8f              LDR      r5,|L12.2880|
000902  753a              STRB     r2,[r7,#0x14]         ;809
000904  882d              LDRH     r5,[r5,#0]  ; ADC3ConvertedValue
000906  f2427610          MOV      r6,#0x2710
00090a  fbb5fcf6          UDIV     r12,r5,r6
00090e  fb06551c          MLS      r5,r6,r12,r5
;;;814    			TxBuffer[21]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
000912  fbb5f6f1          UDIV     r6,r5,r1
000916  f1060c30          ADD      r12,r6,#0x30
;;;815    			tmp%=1000;
00091a  fb015516          MLS      r5,r1,r6,r5
;;;816    			TxBuffer[22]=(uint8_t)(tmp/100)+(uint8_t)0x30;
00091e  fbb5f6f3          UDIV     r6,r5,r3
000922  f887c015          STRB     r12,[r7,#0x15]        ;814
000926  f1060c30          ADD      r12,r6,#0x30
;;;817    			tmp%=100;		
00092a  fb035516          MLS      r5,r3,r6,r5
;;;818    			TxBuffer[23]=(uint8_t)(tmp/10)+(uint8_t)0x30;
00092e  fbb5f6f0          UDIV     r6,r5,r0
000932  f887c016          STRB     r12,[r7,#0x16]        ;816
;;;819    			tmp%=10;	
000936  fb005516          MLS      r5,r0,r6,r5
00093a  f1060c30          ADD      r12,r6,#0x30          ;818
00093e  f887c017          STRB     r12,[r7,#0x17]        ;818
;;;820    			TxBuffer[24]=(uint8_t)(tmp)+(uint8_t)0x30;
000942  3530              ADDS     r5,r5,#0x30
000944  763d              STRB     r5,[r7,#0x18]
;;;821    			TxBuffer[25]=0x20;		
;;;822    			
;;;823    			tmp=fz_average[0]%1000;
000946  4d7f              LDR      r5,|L12.2884|
000948  767a              STRB     r2,[r7,#0x19]         ;821
00094a  882d              LDRH     r5,[r5,#0]  ; fz_average
00094c  fbb5f6f1          UDIV     r6,r5,r1
000950  fb015516          MLS      r5,r1,r6,r5
;;;824    			TxBuffer[26]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
000954  fbb5f6f1          UDIV     r6,r5,r1
000958  f1060c30          ADD      r12,r6,#0x30
;;;825    			tmp%=1000;
00095c  fb015516          MLS      r5,r1,r6,r5
;;;826    			TxBuffer[27]=(uint8_t)(tmp/100)+(uint8_t)0x30;
000960  fbb5f6f3          UDIV     r6,r5,r3
000964  f887c01a          STRB     r12,[r7,#0x1a]        ;824
000968  f1060c30          ADD      r12,r6,#0x30
;;;827    			tmp%=100;		
00096c  fb035516          MLS      r5,r3,r6,r5
;;;828    			TxBuffer[28]=(uint8_t)(tmp/10)+(uint8_t)0x30;
000970  fbb5f6f0          UDIV     r6,r5,r0
000974  f887c01b          STRB     r12,[r7,#0x1b]        ;826
;;;829    			tmp%=10;	
000978  fb005516          MLS      r5,r0,r6,r5
00097c  f1060c30          ADD      r12,r6,#0x30          ;828
000980  f887c01c          STRB     r12,[r7,#0x1c]        ;828
;;;830    			TxBuffer[29]=(uint8_t)(tmp)+(uint8_t)0x30;		
000984  3530              ADDS     r5,r5,#0x30
000986  777d              STRB     r5,[r7,#0x1d]
;;;831    			TxBuffer[30]=0x20;
;;;832    			
;;;833    			tmp=max[0]%1000;
000988  4d6f              LDR      r5,|L12.2888|
00098a  77ba              STRB     r2,[r7,#0x1e]         ;831
00098c  882d              LDRH     r5,[r5,#0]  ; max
00098e  fbb5f6f1          UDIV     r6,r5,r1
000992  fb015516          MLS      r5,r1,r6,r5
;;;834    			TxBuffer[31]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
000996  fbb5f6f1          UDIV     r6,r5,r1
;;;835    			tmp%=1000;
00099a  fb015116          MLS      r1,r1,r6,r5
;;;836    			TxBuffer[32]=(uint8_t)(tmp/100)+(uint8_t)0x30;
00099e  fbb1f5f3          UDIV     r5,r1,r3
;;;837    			tmp%=100;		
0009a2  fb031115          MLS      r1,r3,r5,r1
;;;838    			TxBuffer[33]=(uint8_t)(tmp/10)+(uint8_t)0x30;
0009a6  fbb1f3f0          UDIV     r3,r1,r0
0009aa  f1060c30          ADD      r12,r6,#0x30          ;834
0009ae  f1050630          ADD      r6,r5,#0x30           ;836
0009b2  f887c01f          STRB     r12,[r7,#0x1f]        ;834
;;;839    			tmp%=10;	
0009b6  fb001013          MLS      r0,r0,r3,r1
0009ba  f8876020          STRB     r6,[r7,#0x20]         ;836
0009be  f1030530          ADD      r5,r3,#0x30           ;838
0009c2  f8875021          STRB     r5,[r7,#0x21]         ;838
;;;840    			TxBuffer[34]=(uint8_t)(tmp)+(uint8_t)0x30;		
0009c6  3030              ADDS     r0,r0,#0x30
0009c8  f8870022          STRB     r0,[r7,#0x22]
;;;841    
;;;842    			TxBuffer[35]=0x20;
;;;843    			TxBuffer[36]=(uint8_t)(avariya)+(uint8_t)0x30;	
0009cc  485f              LDR      r0,|L12.2892|
0009ce  f8872023          STRB     r2,[r7,#0x23]         ;842
;;;844    
;;;845    			TxBuffer[37]=0x20;
;;;846    			TxBuffer[38]=(uint8_t)(sost_flesh)+(uint8_t)0x30;
;;;847    			
;;;848    			TxBuffer[39]=0x20;
;;;849    			TxBuffer[40]=(uint8_t)(conf.tek_gr_kal)+(uint8_t)0x30;
;;;850    		/*
;;;851         + need:
;;;852    			1 avariya   
;;;853    			2 zapis norm or error  
;;;854    			3 tek gr kal
;;;855    */
;;;856    			txsize=41;
0009d2  2129              MOVS     r1,#0x29
0009d4  7800              LDRB     r0,[r0,#0]            ;843  ; avariya
0009d6  3030              ADDS     r0,r0,#0x30           ;843
0009d8  f8870024          STRB     r0,[r7,#0x24]         ;843
0009dc  485c              LDR      r0,|L12.2896|
0009de  f8872025          STRB     r2,[r7,#0x25]         ;845
0009e2  7800              LDRB     r0,[r0,#0]            ;846  ; sost_flesh
0009e4  3030              ADDS     r0,r0,#0x30           ;846
0009e6  f8870026          STRB     r0,[r7,#0x26]         ;846
0009ea  485a              LDR      r0,|L12.2900|
0009ec  f8872027          STRB     r2,[r7,#0x27]         ;848
0009f0  78c0              LDRB     r0,[r0,#3]            ;849  ; conf
0009f2  3030              ADDS     r0,r0,#0x30           ;849
0009f4  f8870028          STRB     r0,[r7,#0x28]         ;849
0009f8  f8aa1000          STRH     r1,[r10,#0]
;;;857    			tekper=0;
0009fc  f8ab4000          STRH     r4,[r11,#0]
;;;858    			USART_SendData(USART2, 0x3A);
000a00  213a              MOVS     r1,#0x3a
000a02  4648              MOV      r0,r9
000a04  f7fffffe          BL       USART_SendData
                  |L12.2568|
;;;859    		}		
;;;860    		
;;;861    		// read_conf
;;;862    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='d')&(RxBuffer[4]=='_')&(RxBuffer[5]=='c')&(RxBuffer[6]=='o')&(RxBuffer[7]=='n')&(RxBuffer[8]=='f'))
000a08  4a53              LDR      r2,|L12.2904|
000a0a  7890              LDRB     r0,[r2,#2]  ; RxBuffer
000a0c  2872              CMP      r0,#0x72
000a0e  d06f              BEQ      |L12.2800|
000a10  2000              MOVS     r0,#0
                  |L12.2578|
000a12  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
000a14  2964              CMP      r1,#0x64
000a16  d06c              BEQ      |L12.2802|
000a18  2100              MOVS     r1,#0
                  |L12.2586|
000a1a  4008              ANDS     r0,r0,r1
000a1c  7911              LDRB     r1,[r2,#4]  ; RxBuffer
000a1e  295f              CMP      r1,#0x5f
000a20  d068              BEQ      |L12.2804|
000a22  2100              MOVS     r1,#0
                  |L12.2596|
000a24  4008              ANDS     r0,r0,r1
000a26  7951              LDRB     r1,[r2,#5]  ; RxBuffer
000a28  2963              CMP      r1,#0x63
000a2a  d06e              BEQ      |L12.2826|
000a2c  2100              MOVS     r1,#0
                  |L12.2606|
000a2e  4008              ANDS     r0,r0,r1
000a30  7991              LDRB     r1,[r2,#6]  ; RxBuffer
000a32  296f              CMP      r1,#0x6f
000a34  d07d              BEQ      |L12.2866|
000a36  2100              MOVS     r1,#0
                  |L12.2616|
000a38  4008              ANDS     r0,r0,r1
000a3a  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
000a3c  296e              CMP      r1,#0x6e
000a3e  d07a              BEQ      |L12.2870|
000a40  2100              MOVS     r1,#0
                  |L12.2626|
000a42  4008              ANDS     r0,r0,r1
000a44  7a11              LDRB     r1,[r2,#8]  ; RxBuffer
000a46  2966              CMP      r1,#0x66
000a48  d077              BEQ      |L12.2874|
000a4a  2100              MOVS     r1,#0
                  |L12.2636|
000a4c  4208              TST      r0,r1
000a4e  d022              BEQ      |L12.2710|
;;;863    		{
;;;864    			u16 i=0;
000a50  2500              MOVS     r5,#0
;;;865    			extern st_conf conf;		
;;;866    			
;;;867    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
000a52  462a              MOV      r2,r5
000a54  f2405125          MOV      r1,#0x525
000a58  464e              MOV      r6,r9
000a5a  4648              MOV      r0,r9
000a5c  f7fffffe          BL       USART_ITConfig
;;;868    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
000a60  2201              MOVS     r2,#1
000a62  f2406126          MOV      r1,#0x626
000a66  4630              MOV      r0,r6
000a68  f7fffffe          BL       USART_ITConfig
;;;869    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
000a6c  2201              MOVS     r2,#1
000a6e  2108              MOVS     r1,#8
000a70  483a              LDR      r0,|L12.2908|
000a72  f7fffffe          BL       GPIO_WriteBit
;;;870    /*
;;;871    		u8 address;
;;;872    		u8 ver_po_st;
;;;873    		u8 ver_po_ml;
;;;874    	  u8 tek_gr_kal; 
;;;875    	  u8 tm_antidreb;
;;;876    		u8 revers_group_select;
;;;877    		u8 revers_peredacha_select;
;;;878    		u8 rez8;
;;;879    	
;;;880    		u16	per_usr;
;;;881    		u16	time_max;
;;;882    		u16 por_rele;
;;;883    		u16 tm_rele_on;
;;;884    		u16 tm_rele_off;
;;;885    		u16 rez16;
;;;886    	*/	
;;;887    /*
;;;888    			conf.address=1;
;;;889    			conf.ver_po_st=2;
;;;890    			conf.ver_po_ml=3;
;;;891    			conf.tek_gr_kal=4;
;;;892    			conf.tm_antidreb=5;
;;;893    			conf.revers_group_select=6;
;;;894    			conf.revers_peredacha_select=7;
;;;895    			conf.rez8=8;
;;;896    			conf.per_usr=9;
;;;897    			conf.time_max=10;
;;;898    			conf.por_rele=11;
;;;899    			conf.tm_rele_on=12;
;;;900    			conf.tm_rele_off=13;
;;;901    			conf.rez16=14;
;;;902    			
;;;903    		conf.lin.kol_st=15;
;;;904    		conf.lin.max1=16;	
;;;905    		conf.lin.max2=17;
;;;906    		conf.lin.max3=18;
;;;907    		conf.lin.max4=19;
;;;908    		*/
;;;909    			/*
;;;910    			conf.indicators[0].numb=15;
;;;911    			conf.indicators[0].kol_cifr=16;
;;;912    			conf.indicators[0].type_ind=17;
;;;913    			conf.indicators[0].yark=18;
;;;914    			conf.indicators[0].rez_viv=19;
;;;915    			conf.indicators[0].pol_zap=20;
;;;916    			conf.indicators[0].r1=21;
;;;917    			conf.indicators[0].r2=22;
;;;918    			conf.indicators[0].chislo=23;
;;;919    			conf.indicators[0].porog=24;
;;;920    
;;;921    			conf.indicators[1].numb=25;
;;;922    			conf.indicators[1].kol_cifr=26;
;;;923    			conf.indicators[1].type_ind=27;
;;;924    			conf.indicators[1].yark=28;
;;;925    			conf.indicators[1].rez_viv=29;
;;;926    			conf.indicators[1].pol_zap=30;
;;;927    			conf.indicators[1].r1=31;
;;;928    			conf.indicators[1].r2=32;
;;;929    			conf.indicators[1].chislo=33;
;;;930    			conf.indicators[1].porog=34;
;;;931    		
;;;932    
;;;933    		
;;;934    
;;;935    		
;;;936    			conf.indicators[2].numb=35;
;;;937    			conf.indicators[2].kol_cifr=36;
;;;938    			conf.indicators[2].type_ind=37;
;;;939    			conf.indicators[2].yark=38;
;;;940    			conf.indicators[2].rez_viv=39;
;;;941    			conf.indicators[2].pol_zap=40;
;;;942    			conf.indicators[2].r1=41;
;;;943    			conf.indicators[2].r2=42;
;;;944    			conf.indicators[2].chislo=43;
;;;945    			conf.indicators[2].porog=44;
;;;946    			
;;;947    			conf.indicators[3].numb=45;
;;;948    			conf.indicators[3].kol_cifr=46;
;;;949    			conf.indicators[3].type_ind=47;
;;;950    			conf.indicators[3].yark=48;
;;;951    			conf.indicators[3].rez_viv=49;
;;;952    			conf.indicators[3].pol_zap=50;
;;;953    			conf.indicators[3].r1=51;
;;;954    			conf.indicators[3].r2=52;
;;;955    			conf.indicators[3].chislo=53;
;;;956    			conf.indicators[3].porog=54;
;;;957    				*/
;;;958    		/*		
;;;959    			conf.gr_kal1.tabl1.fz[0]=55;
;;;960    			conf.gr_kal1.tabl1.fz[1]=56;
;;;961    			conf.gr_kal1.tabl1.fz[2]=57;
;;;962    			conf.gr_kal1.tabl1.fz[3]=58;
;;;963    			conf.gr_kal1.tabl1.fz[4]=59;
;;;964    			conf.gr_kal1.tabl1.fz[5]=60;
;;;965    			conf.gr_kal1.tabl1.fz[6]=61;
;;;966    			conf.gr_kal1.tabl1.fz[7]=62;
;;;967    			conf.gr_kal1.tabl1.fz[8]=63;
;;;968    			conf.gr_kal1.tabl1.fz[9]=64;
;;;969    
;;;970    			conf.gr_kal1.tabl1.kod[0]=65;
;;;971    			conf.gr_kal1.tabl1.kod[1]=66;
;;;972    			conf.gr_kal1.tabl1.kod[2]=67;
;;;973    			conf.gr_kal1.tabl1.kod[3]=68;
;;;974    			conf.gr_kal1.tabl1.kod[4]=69;
;;;975    			conf.gr_kal1.tabl1.kod[5]=70;
;;;976    			conf.gr_kal1.tabl1.kod[6]=71;
;;;977    			conf.gr_kal1.tabl1.kod[7]=72;
;;;978    			conf.gr_kal1.tabl1.kod[8]=73;
;;;979    			conf.gr_kal1.tabl1.kod[9]=74;
;;;980    	
;;;981    			conf.gr_kal1.tabl2.fz[0]=75;
;;;982    			conf.gr_kal1.tabl2.fz[1]=76;
;;;983    			conf.gr_kal1.tabl2.fz[2]=77;
;;;984    			conf.gr_kal1.tabl2.fz[3]=78;
;;;985    			conf.gr_kal1.tabl2.fz[4]=79;
;;;986    			conf.gr_kal1.tabl2.fz[5]=80;
;;;987    			conf.gr_kal1.tabl2.fz[6]=81;
;;;988    			conf.gr_kal1.tabl2.fz[7]=82;
;;;989    			conf.gr_kal1.tabl2.fz[8]=83;
;;;990    			conf.gr_kal1.tabl2.fz[9]=84;
;;;991    
;;;992    			conf.gr_kal1.tabl2.kod[0]=85;
;;;993    			conf.gr_kal1.tabl2.kod[1]=86;
;;;994    			conf.gr_kal1.tabl2.kod[2]=87;
;;;995    			conf.gr_kal1.tabl2.kod[3]=88;
;;;996    			conf.gr_kal1.tabl2.kod[4]=89;
;;;997    			conf.gr_kal1.tabl2.kod[5]=90;
;;;998    			conf.gr_kal1.tabl2.kod[6]=91;
;;;999    			conf.gr_kal1.tabl2.kod[7]=92;
;;;1000   			conf.gr_kal1.tabl2.kod[8]=93;
;;;1001   			conf.gr_kal1.tabl2.kod[9]=94;	
;;;1002   			
;;;1003   			// dr2
;;;1004   			conf.gr_kal2.tabl1.fz[0]=95;
;;;1005   			conf.gr_kal2.tabl1.fz[1]=96;
;;;1006   			conf.gr_kal2.tabl1.fz[2]=97;
;;;1007   			conf.gr_kal2.tabl1.fz[3]=98;
;;;1008   			conf.gr_kal2.tabl1.fz[4]=99;
;;;1009   			conf.gr_kal2.tabl1.fz[5]=100;
;;;1010   			conf.gr_kal2.tabl1.fz[6]=101;
;;;1011   			conf.gr_kal2.tabl1.fz[7]=102;
;;;1012   			conf.gr_kal2.tabl1.fz[8]=103;
;;;1013   			conf.gr_kal2.tabl1.fz[9]=104;
;;;1014   
;;;1015   			conf.gr_kal2.tabl1.kod[0]=105;
;;;1016   			conf.gr_kal2.tabl1.kod[1]=106;
;;;1017   			conf.gr_kal2.tabl1.kod[2]=107;
;;;1018   			conf.gr_kal2.tabl1.kod[3]=108;
;;;1019   			conf.gr_kal2.tabl1.kod[4]=109;
;;;1020   			conf.gr_kal2.tabl1.kod[5]=100;
;;;1021   			conf.gr_kal2.tabl1.kod[6]=111;
;;;1022   			conf.gr_kal2.tabl1.kod[7]=112;
;;;1023   			conf.gr_kal2.tabl1.kod[8]=113;
;;;1024   			conf.gr_kal2.tabl1.kod[9]=114;
;;;1025   	
;;;1026   			conf.gr_kal2.tabl2.fz[0]=115;
;;;1027   			conf.gr_kal2.tabl2.fz[1]=116;
;;;1028   			conf.gr_kal2.tabl2.fz[2]=117;
;;;1029   			conf.gr_kal2.tabl2.fz[3]=118;
;;;1030   			conf.gr_kal2.tabl2.fz[4]=119;
;;;1031   			conf.gr_kal2.tabl2.fz[5]=120;
;;;1032   			conf.gr_kal2.tabl2.fz[6]=121;
;;;1033   			conf.gr_kal2.tabl2.fz[7]=122;
;;;1034   			conf.gr_kal2.tabl2.fz[8]=123;
;;;1035   			conf.gr_kal2.tabl2.fz[9]=124;
;;;1036   
;;;1037   			conf.gr_kal2.tabl2.kod[0]=125;
;;;1038   			conf.gr_kal2.tabl2.kod[1]=126;
;;;1039   			conf.gr_kal2.tabl2.kod[2]=127;
;;;1040   			conf.gr_kal2.tabl2.kod[3]=128;
;;;1041   			conf.gr_kal2.tabl2.kod[4]=129;
;;;1042   			conf.gr_kal2.tabl2.kod[5]=130;
;;;1043   			conf.gr_kal2.tabl2.kod[6]=131;
;;;1044   			conf.gr_kal2.tabl2.kod[7]=132;
;;;1045   			conf.gr_kal2.tabl2.kod[8]=133;
;;;1046   			conf.gr_kal2.tabl2.kod[9]=134;	
;;;1047   */		
;;;1048   		/*
;;;1049   			txsize=sizeof(st_conf)<<1;
;;;1050   	
;;;1051   			for (i = 0; i < (txsize); i += 1)
;;;1052   			{
;;;1053   				u16 tmp=0;
;;;1054   	//			TxBuffer[i]=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1055   				tmp=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1056   				TxBuffer[i<<1]=(tmp>>8)+0x30;
;;;1057   				TxBuffer[(i<<1)+1]=tmp+0x30;
;;;1058   			}	
;;;1059   */
;;;1060   
;;;1061   			txsize=sizeof(st_conf);  // dl = 228
000a76  21be              MOVS     r1,#0xbe
000a78  4839              LDR      r0,|L12.2912|
000a7a  f8aa1000          STRH     r1,[r10,#0]
                  |L12.2686|
;;;1062   	
;;;1063   			for (i = 0; i < (txsize); i += 1)
;;;1064   			{
;;;1065   		//		TxBuffer[i]=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1066   				TxBuffer[i]=(*(__IO uint8_t *) (BKPSRAM_BASE + i));
000a7e  5c2a              LDRB     r2,[r5,r0]
000a80  557a              STRB     r2,[r7,r5]
000a82  1c6d              ADDS     r5,r5,#1              ;1063
000a84  b2ad              UXTH     r5,r5                 ;1063
000a86  428d              CMP      r5,r1                 ;1063
000a88  d3f9              BCC      |L12.2686|
;;;1067   			}	
;;;1068   			tekper=0;
000a8a  f8ab4000          STRH     r4,[r11,#0]
;;;1069   			USART_SendData(USART2, 0x3A);
000a8e  213a              MOVS     r1,#0x3a
000a90  4630              MOV      r0,r6
000a92  f7fffffe          BL       USART_SendData
                  |L12.2710|
;;;1070   		}		
;;;1071   		
;;;1072   		new_komand=0;
000a96  4833              LDR      r0,|L12.2916|
000a98  7004              STRB     r4,[r0,#0]
                  |L12.2714|
;;;1073   	}
;;;1074   	
;;;1075   
;;;1076   	
;;;1077   				//	indicators[0].chislo=1234;
;;;1078   		//		indicators[1].chislo=1234;
;;;1079   		//		indicate (0);
;;;1080   		//		indicate (1);
;;;1081   				
;;;1082   }
000a9a  e8bd9ff0          POP      {r4-r12,pc}
                  |L12.2718|
000a9e  2074              MOVS     r0,#0x74              ;590
000aa0  70b8              STRB     r0,[r7,#2]            ;590
000aa2  205f              MOVS     r0,#0x5f              ;591
000aa4  70f8              STRB     r0,[r7,#3]            ;591
000aa6  7139              STRB     r1,[r7,#4]            ;592
000aa8  216f              MOVS     r1,#0x6f              ;593
000aaa  7179              STRB     r1,[r7,#5]            ;593
000aac  71ba              STRB     r2,[r7,#6]            ;594
000aae  71fb              STRB     r3,[r7,#7]            ;595
000ab0  7238              STRB     r0,[r7,#8]            ;596
000ab2  7279              STRB     r1,[r7,#9]            ;597
000ab4  206b              MOVS     r0,#0x6b              ;598
000ab6  e4fa              B        |L12.1198|
                  |L12.2744|
000ab8  2001              MOVS     r0,#1                 ;621
000aba  e507              B        |L12.1228|
                  |L12.2748|
000abc  2101              MOVS     r1,#1                 ;621
000abe  e509              B        |L12.1236|
                  |L12.2752|
000ac0  2101              MOVS     r1,#1                 ;621
000ac2  e50c              B        |L12.1246|
                  |L12.2756|
000ac4  2101              MOVS     r1,#1                 ;621
000ac6  e510              B        |L12.1258|
                  |L12.2760|
000ac8  2001              MOVS     r0,#1                 ;646
000aca  e548              B        |L12.1374|
                  |L12.2764|
000acc  2101              MOVS     r1,#1                 ;646
000ace  e54a              B        |L12.1382|
                  |L12.2768|
000ad0  2101              MOVS     r1,#1                 ;646
000ad2  e54d              B        |L12.1392|
                  |L12.2772|
000ad4  2101              MOVS     r1,#1                 ;646
000ad6  e550              B        |L12.1402|
                  |L12.2776|
000ad8  2101              MOVS     r1,#1                 ;646
000ada  e553              B        |L12.1412|
                  |L12.2780|
000adc  2101              MOVS     r1,#1                 ;646
000ade  e556              B        |L12.1422|
                  |L12.2784|
000ae0  2101              MOVS     r1,#1                 ;646
000ae2  e55a              B        |L12.1434|
                  |L12.2788|
000ae4  2001              MOVS     r0,#1                 ;676
000ae6  e593              B        |L12.1552|
                  |L12.2792|
000ae8  2101              MOVS     r1,#1                 ;676
000aea  e595              B        |L12.1560|
                  |L12.2796|
000aec  2101              MOVS     r1,#1                 ;676
000aee  e598              B        |L12.1570|
                  |L12.2800|
000af0  e017              B        |L12.2850|
                  |L12.2802|
000af2  e018              B        |L12.2854|
                  |L12.2804|
000af4  e019              B        |L12.2858|
                  |L12.2806|
000af6  2101              MOVS     r1,#1                 ;676
000af8  e598              B        |L12.1580|
                  |L12.2810|
000afa  2101              MOVS     r1,#1                 ;676
000afc  e59b              B        |L12.1590|
                  |L12.2814|
000afe  2101              MOVS     r1,#1                 ;676
000b00  e59e              B        |L12.1600|
                  |L12.2818|
000b02  2101              MOVS     r1,#1                 ;676
000b04  e5a2              B        |L12.1612|
                  |L12.2822|
000b06  2101              MOVS     r1,#1                 ;676
000b08  e5ad              B        |L12.1638|
                  |L12.2826|
000b0a  e010              B        |L12.2862|
000b0c  e011              B        |L12.2866|
                  |L12.2830|
000b0e  2001              MOVS     r0,#1                 ;770
000b10  e655              B        |L12.1982|
                  |L12.2834|
000b12  2101              MOVS     r1,#1                 ;770
000b14  e657              B        |L12.1990|
                  |L12.2838|
000b16  2101              MOVS     r1,#1                 ;770
000b18  e65a              B        |L12.2000|
                  |L12.2842|
000b1a  2101              MOVS     r1,#1                 ;770
000b1c  e65e              B        |L12.2012|
000b1e  e00a              B        |L12.2870|
000b20  e00b              B        |L12.2874|
                  |L12.2850|
000b22  2001              MOVS     r0,#1                 ;862
000b24  e775              B        |L12.2578|
                  |L12.2854|
000b26  2101              MOVS     r1,#1                 ;862
000b28  e777              B        |L12.2586|
                  |L12.2858|
000b2a  2101              MOVS     r1,#1                 ;862
000b2c  e77a              B        |L12.2596|
                  |L12.2862|
000b2e  2101              MOVS     r1,#1                 ;862
000b30  e77d              B        |L12.2606|
                  |L12.2866|
000b32  2101              MOVS     r1,#1                 ;862
000b34  e780              B        |L12.2616|
                  |L12.2870|
000b36  2101              MOVS     r1,#1                 ;862
000b38  e783              B        |L12.2626|
                  |L12.2874|
000b3a  2101              MOVS     r1,#1                 ;862
000b3c  e786              B        |L12.2636|
;;;1083   
                          ENDP

000b3e  0000              DCW      0x0000
                  |L12.2880|
                          DCD      ADC3ConvertedValue
                  |L12.2884|
                          DCD      fz_average
                  |L12.2888|
                          DCD      max
                  |L12.2892|
                          DCD      avariya
                  |L12.2896|
                          DCD      sost_flesh
                  |L12.2900|
                          DCD      conf
                  |L12.2904|
                          DCD      RxBuffer
                  |L12.2908|
                          DCD      0x40020c00
                  |L12.2912|
                          DCD      0x40024000
                  |L12.2916|
                          DCD      new_komand

                          AREA ||i.TIM2_IRQHandler||, CODE, READONLY, ALIGN=1

                  TIM2_IRQHandler PROC
;;;1216     */
;;;1217   void TIM2_IRQHandler(void)
000000  f7ffbffe          B.W      USB_OTG_BSP_TimerIRQ
;;;1218   {
;;;1219     USB_OTG_BSP_TimerIRQ();
;;;1220   }
;;;1221   
                          ENDP


                          AREA ||i.TIM4_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM4_IRQHandler PROC
;;;1122     */
;;;1123   void TIM4_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1124   {
;;;1125      uint8_t clickreg = 0;
;;;1126   
;;;1127   	
;;;1128     /* Checks whether the TIM interrupt has occurred */
;;;1129     if (TIM_GetITStatus(TIM4, TIM_IT_CC1) != RESET)
000002  4c0d              LDR      r4,|L14.56|
000004  2102              MOVS     r1,#2
000006  4620              MOV      r0,r4
000008  f7fffffe          BL       TIM_GetITStatus
00000c  2800              CMP      r0,#0
00000e  d011              BEQ      |L14.52|
;;;1130     {
;;;1131       TIM_ClearITPendingBit(TIM4, TIM_IT_CC1);
000010  2102              MOVS     r1,#2
000012  4620              MOV      r0,r4
000014  f7fffffe          BL       TIM_ClearITPendingBit
;;;1132   		/*
;;;1133       if( LED_Toggle == 3)
;;;1134       {
;;;1135         // LED3 Orange toggling 
;;;1136         STM_EVAL_LEDToggle(LED3);
;;;1137         STM_EVAL_LEDOff(LED6);
;;;1138         STM_EVAL_LEDOff(LED4);
;;;1139       }
;;;1140       else if( LED_Toggle == 4)
;;;1141       {
;;;1142         // LED4 Green toggling 
;;;1143         STM_EVAL_LEDToggle(LED4);
;;;1144         STM_EVAL_LEDOff(LED6);
;;;1145         STM_EVAL_LEDOff(LED3);
;;;1146       }
;;;1147       else if( LED_Toggle == 6)
;;;1148       {
;;;1149         // LED6 Blue toggling 
;;;1150         STM_EVAL_LEDOff(LED3);
;;;1151         STM_EVAL_LEDOff(LED4);
;;;1152         STM_EVAL_LEDToggle(LED6);
;;;1153       }
;;;1154       else if (LED_Toggle ==0)
;;;1155       {
;;;1156         // LED6 Blue On to signal Pause 
;;;1157         STM_EVAL_LEDOn(LED6);
;;;1158       }
;;;1159       else if (LED_Toggle == 7)
;;;1160       {
;;;1161         // LED4 toggling with frequency = 439.4 Hz 
;;;1162         STM_EVAL_LEDOff(LED3);
;;;1163         STM_EVAL_LEDOff(LED4);
;;;1164         STM_EVAL_LEDOff(LED5);
;;;1165         STM_EVAL_LEDOff(LED6);
;;;1166       }
;;;1167   		*/
;;;1168   	
;;;1169   
;;;1170       capture = TIM_GetCapture1(TIM4);
000018  4620              MOV      r0,r4
00001a  f7fffffe          BL       TIM_GetCapture1
00001e  b281              UXTH     r1,r0
000020  4806              LDR      r0,|L14.60|
000022  8141              STRH     r1,[r0,#0xa]
;;;1171       TIM_SetCompare1(TIM4, capture + CCR_Val);
000024  4806              LDR      r0,|L14.64|
000026  8800              LDRH     r0,[r0,#0]  ; CCR_Val
000028  4401              ADD      r1,r1,r0
00002a  4620              MOV      r0,r4
00002c  e8bd4010          POP      {r4,lr}
000030  f7ffbffe          B.W      TIM_SetCompare1
                  |L14.52|
;;;1172     }
;;;1173   }
000034  bd10              POP      {r4,pc}
;;;1174   
                          ENDP

000036  0000              DCW      0x0000
                  |L14.56|
                          DCD      0x40000800
                  |L14.60|
                          DCD      ||.data||
                  |L14.64|
                          DCD      CCR_Val

                          AREA ||i.UsageFault_Handler||, CODE, READONLY, ALIGN=1

                  UsageFault_Handler PROC
                  |L15.0|
;;;150      */
;;;151    void UsageFault_Handler(void)
000000  e7fe              B        |L15.0|
;;;152    {
;;;153      /* Go to infinite loop when Usage Fault exception occurs */
;;;154      while (1)
;;;155      {
;;;156      }
;;;157    }
;;;158    
                          ENDP


                          AREA ||i.fiz_vel||, CODE, READONLY, ALIGN=2

                  fiz_vel PROC
;;;185    
;;;186    u16 fiz_vel(u16 kod, st_tab_kal* tk)
000000  b570              PUSH     {r4-r6,lr}
;;;187    {
;;;188    	u8 i=0, nul=0;
;;;189    	st_tab_kal *tab = tk;
;;;190    //	tab_kal
;;;191    	/*
;;;192    	    
;;;193           
;;;194                    
;;;195                    if kod[1:]==[0,0,0,0,0,0,0,0,0]:
;;;196                        print 'no tabl' 
;;;197                        return kodadc
;;;198                        
;;;199                    if kodadc<kod[0]:
;;;200                        return fz[0]
;;;201                    
;;;202                    for i in range(1,10):
;;;203                        
;;;204                        if kodadc<kod[i]:
;;;205                            if i==0:
;;;206                                print 'i=0',fz[0]
;;;207                                return fz[0]
;;;208                            else:
;;;209                                if kod[i]==0:
;;;210                                    print 'kod=0',fz[i-1]
;;;211                                    return fz[i-1]
;;;212                                else:
;;;213                                    print 'norm',
;;;214                                    return (fz[i]-fz[i-1])*(kodadc-kod[i-1])/(kod[i]-kod[i-1])+fz[i-1]
;;;215                                    
;;;216                        if  kod[i-1]>0 and kod[i]==0:
;;;217                            return fz[i-1]
;;;218                    
;;;219                    return fz[9]
;;;220    
;;;221    	*/
;;;222    	
;;;223    	
;;;224    	/*	
;;;225    	conf.gr_kal1.tabl1.fz[0]
;;;226    	conf.gr_kal1.tabl1.kod[0]=65;
;;;227      conf.tek_gr_kal=4;
;;;228      sost_pribl	
;;;229    	tk
;;;230    	*/
;;;231    		tk_null=0;
000002  4c24              LDR      r4,|L16.148|
000004  2300              MOVS     r3,#0                 ;188
;;;232    		for (i = 1; i < 10; i += 1)
000006  2201              MOVS     r2,#1
000008  7023              STRB     r3,[r4,#0]            ;231
                  |L16.10|
;;;233    			if (tk->kod[i]==0) 
00000a  f8315012          LDRH     r5,[r1,r2,LSL #1]
00000e  b90d              CBNZ     r5,|L16.20|
;;;234    					nul++;	
000010  1c5b              ADDS     r3,r3,#1
000012  b2db              UXTB     r3,r3
                  |L16.20|
000014  1c52              ADDS     r2,r2,#1              ;232
000016  b2d2              UXTB     r2,r2                 ;232
000018  2a0a              CMP      r2,#0xa               ;232
00001a  d3f6              BCC      |L16.10|
;;;235    	  if (nul==9)
00001c  2b09              CMP      r3,#9
00001e  d024              BEQ      |L16.106|
;;;236    		{		tk_null=1;
;;;237    				return kod; }
;;;238    		
;;;239    		if (kod<tk->kod[0])
000020  880a              LDRH     r2,[r1,#0]
000022  4282              CMP      r2,r0
000024  d824              BHI      |L16.112|
;;;240            return tk->fz[0];
;;;241    		
;;;242    		for (i = 1; i < 10; i += 1)	
000026  2201              MOVS     r2,#1
                  |L16.40|
;;;243    		{
;;;244    			float tmp=0;
;;;245    			if (kod<tk->kod[i]) {
000028  f8313012          LDRH     r3,[r1,r2,LSL #1]
00002c  4283              CMP      r3,r0
00002e  d921              BLS      |L16.116|
;;;246    					if (i==0)
000030  b1f2              CBZ      r2,|L16.112|
;;;247    							return tk->fz[0];
;;;248    					else  {
;;;249    							if (tk->kod[i]==0)
000032  041c              LSLS     r4,r3,#16
000034  0c24              LSRS     r4,r4,#16
000036  d029              BEQ      |L16.140|
;;;250    									return tk->fz[i-1];
;;;251    							else  {
;;;252    								  tmp=(tk->fz[i]-tk->fz[i-1])*(kod-tk->kod[i-1])/(tk->kod[i]-tk->kod[i-1])+tk->fz[i-1]+0.5;
000038  eb010142          ADD      r1,r1,r2,LSL #1
00003c  8a8c              LDRH     r4,[r1,#0x14]
00003e  8a4a              LDRH     r2,[r1,#0x12]
000040  f8311c02          LDRH     r1,[r1,#-2]
000044  1aa4              SUBS     r4,r4,r2
000046  1a40              SUBS     r0,r0,r1
000048  4344              MULS     r4,r0,r4
00004a  1a58              SUBS     r0,r3,r1
00004c  fb94f0f0          SDIV     r0,r4,r0
000050  4410              ADD      r0,r0,r2
000052  f7fffffe          BL       __aeabi_i2d
000056  2200              MOVS     r2,#0
000058  4b0f              LDR      r3,|L16.152|
00005a  f7fffffe          BL       __aeabi_dadd
00005e  f7fffffe          BL       __aeabi_d2f
;;;253    									return (u16) tmp;  } } }
000062  f7fffffe          BL       __aeabi_f2uiz
000066  b280              UXTH     r0,r0
;;;254    									
;;;255    			if  ((tk->kod[i-1]>0)&(tk->kod[i]==0))
;;;256    					return tk->fz[i-1];
;;;257      	}	
;;;258        
;;;259    		return tk->fz[9];		
;;;260    }
000068  bd70              POP      {r4-r6,pc}
                  |L16.106|
00006a  2101              MOVS     r1,#1                 ;236
00006c  7021              STRB     r1,[r4,#0]            ;236
00006e  bd70              POP      {r4-r6,pc}
                  |L16.112|
000070  8a88              LDRH     r0,[r1,#0x14]         ;247
000072  bd70              POP      {r4-r6,pc}
                  |L16.116|
000074  eb010442          ADD      r4,r1,r2,LSL #1       ;255
000078  f8344c02          LDRH     r4,[r4,#-2]           ;255
00007c  b104              CBZ      r4,|L16.128|
00007e  b12b              CBZ      r3,|L16.140|
                  |L16.128|
000080  1c52              ADDS     r2,r2,#1              ;242
000082  b2d2              UXTB     r2,r2                 ;242
000084  2a0a              CMP      r2,#0xa               ;242
000086  d3cf              BCC      |L16.40|
000088  8cc8              LDRH     r0,[r1,#0x26]         ;259
00008a  bd70              POP      {r4-r6,pc}
                  |L16.140|
00008c  eb010042          ADD      r0,r1,r2,LSL #1       ;256
000090  8a40              LDRH     r0,[r0,#0x12]         ;256
000092  bd70              POP      {r4-r6,pc}
;;;261    
                          ENDP

                  |L16.148|
                          DCD      ||.data||
                  |L16.152|
                          DCD      0x3fe00000

                          AREA ||i.moving_average||, CODE, READONLY, ALIGN=2

                  moving_average PROC
;;;262    
;;;263    u16 moving_average(u16 kod, u8 numb)
000000  b570              PUSH     {r4-r6,lr}
;;;264    {
;;;265    	extern u16 tek_kol;
;;;266    	extern u16 kol_usr;
;;;267    	extern u32 buf_sum;
;;;268    	u16 tmp=0;
;;;269    	
;;;270    	if (kol_usr==0)
000002  4916              LDR      r1,|L17.92|
000004  880a              LDRH     r2,[r1,#0]  ; kol_usr
000006  2a00              CMP      r2,#0                 ;264
000008  d018              BEQ      |L17.60|
;;;271    		return kod;
;;;272    
;;;273    	if (kol_usr==1)
00000a  2a01              CMP      r2,#1
00000c  d016              BEQ      |L17.60|
;;;274    		return kod;
;;;275    	
;;;276    	if (tek_kol<kol_usr)
00000e  4b14              LDR      r3,|L17.96|
;;;277    	{
;;;278    		buf_sum+=kod;
000010  4d14              LDR      r5,|L17.100|
;;;279    		tek_kol++;
;;;280    		return (u16)((buf_sum/tek_kol)+0.5);
000012  4e15              LDR      r6,|L17.104|
000014  8819              LDRH     r1,[r3,#0]            ;276  ; tek_kol
000016  682c              LDR      r4,[r5,#0]            ;278
000018  4291              CMP      r1,r2                 ;276
00001a  4404              ADD      r4,r4,r0              ;278
00001c  d20f              BCS      |L17.62|
00001e  1c49              ADDS     r1,r1,#1              ;279
000020  b288              UXTH     r0,r1                 ;279
000022  602c              STR      r4,[r5,#0]            ;279  ; buf_sum
000024  8018              STRH     r0,[r3,#0]            ;279
000026  fbb4f0f0          UDIV     r0,r4,r0
00002a  f7fffffe          BL       __aeabi_ui2d
00002e  2200              MOVS     r2,#0
000030  4633              MOV      r3,r6
000032  f7fffffe          BL       __aeabi_dadd
000036  f7fffffe          BL       __aeabi_d2uiz
00003a  b280              UXTH     r0,r0
                  |L17.60|
;;;281    	}
;;;282    	else
;;;283    	{
;;;284    		buf_sum+=kod;
;;;285    		tmp=(u16) ((buf_sum/tek_kol)+0.5);
;;;286    		buf_sum-=tmp;
;;;287    		return  tmp;
;;;288    	}
;;;289    }
00003c  bd70              POP      {r4-r6,pc}
                  |L17.62|
00003e  fbb4f0f1          UDIV     r0,r4,r1              ;285
000042  f7fffffe          BL       __aeabi_ui2d
000046  2200              MOVS     r2,#0                 ;285
000048  4633              MOV      r3,r6                 ;285
00004a  f7fffffe          BL       __aeabi_dadd
00004e  f7fffffe          BL       __aeabi_d2uiz
000052  b280              UXTH     r0,r0                 ;285
000054  1a21              SUBS     r1,r4,r0              ;286
000056  6029              STR      r1,[r5,#0]            ;286  ; buf_sum
000058  bd70              POP      {r4-r6,pc}
;;;290    
                          ENDP

00005a  0000              DCW      0x0000
                  |L17.92|
                          DCD      kol_usr
                  |L17.96|
                          DCD      tek_kol
                  |L17.100|
                          DCD      buf_sum
                  |L17.104|
                          DCD      0x3fe00000

                          AREA ||i.test_rele||, CODE, READONLY, ALIGN=2

                  test_rele PROC
;;;290    
;;;291    u8 test_rele(u16 fz, u8 numb)
000000  b5f0              PUSH     {r4-r7,lr}
;;;292    {
;;;293    	extern st_conf conf;
;;;294    	
;;;295    	if (fz>conf.por_rele)
000002  4e13              LDR      r6,|L18.80|
;;;296    			kol_rele_on++;			
000004  4913              LDR      r1,|L18.84|
000006  89b2              LDRH     r2,[r6,#0xc]          ;295  ; conf
000008  4282              CMP      r2,r0                 ;295
00000a  d203              BCS      |L18.20|
00000c  8888              LDRH     r0,[r1,#4]  ; kol_rele_on
00000e  1c40              ADDS     r0,r0,#1
000010  8088              STRH     r0,[r1,#4]
000012  e002              B        |L18.26|
                  |L18.20|
;;;297    	else
;;;298    			kol_rele_off++;
000014  88c8              LDRH     r0,[r1,#6]  ; kol_rele_off
000016  1c40              ADDS     r0,r0,#1
000018  80c8              STRH     r0,[r1,#6]
                  |L18.26|
;;;299    		
;;;300    	if (kol_rele_on>=conf.tm_rele_on)
00001a  89f7              LDRH     r7,[r6,#0xe]  ; conf
00001c  f8b1c004          LDRH     r12,[r1,#4]  ; kol_rele_on
000020  2000              MOVS     r0,#0
;;;301    	{
;;;302    		kol_rele_on=0;
;;;303    		kol_rele_off=0;
;;;304    		avariya=1;
000022  4b0d              LDR      r3,|L18.88|
;;;305    		PORT_AVARIYA->BSRRL = PIN_AVARIYA;	// on PIN_AVARIYA		
000024  4a0d              LDR      r2,|L18.92|
;;;306    		PORT_RELE->BSRRL = PIN_RELE;	// on PIN_RELE		
000026  2510              MOVS     r5,#0x10
000028  f44f4400          MOV      r4,#0x8000            ;305
00002c  4567              CMP      r7,r12                ;300
00002e  d805              BHI      |L18.60|
000030  8088              STRH     r0,[r1,#4]            ;302
000032  80c8              STRH     r0,[r1,#6]            ;303
000034  2701              MOVS     r7,#1                 ;304
000036  701f              STRB     r7,[r3,#0]            ;304
000038  8314              STRH     r4,[r2,#0x18]         ;305
00003a  8315              STRH     r5,[r2,#0x18]
                  |L18.60|
;;;307    	}
;;;308    	
;;;309    	if (kol_rele_off>=conf.tm_rele_off)
00003c  8a36              LDRH     r6,[r6,#0x10]  ; conf
00003e  88cf              LDRH     r7,[r1,#6]  ; kol_rele_off
000040  42be              CMP      r6,r7
000042  d804              BHI      |L18.78|
;;;310    	{
;;;311    		kol_rele_on=0;
000044  8088              STRH     r0,[r1,#4]
;;;312    		kol_rele_off=0;
000046  80c8              STRH     r0,[r1,#6]
;;;313    		avariya=0;
000048  7018              STRB     r0,[r3,#0]
;;;314    		PORT_AVARIYA->BSRRH = PIN_AVARIYA;  	// off  PIN_AVARIYA
00004a  8354              STRH     r4,[r2,#0x1a]
;;;315    		PORT_RELE->BSRRH = PIN_RELE;  	// off  PIN_RELE		
00004c  8355              STRH     r5,[r2,#0x1a]
                  |L18.78|
;;;316    	}
;;;317    }
00004e  bdf0              POP      {r4-r7,pc}
;;;318    
                          ENDP

                  |L18.80|
                          DCD      conf
                  |L18.84|
                          DCD      ||.data||
                  |L18.88|
                          DCD      avariya
                  |L18.92|
                          DCD      0x40020000

                          AREA ||.data||, DATA, ALIGN=1

                  tk_null
000000  00                DCB      0x00
                  PauseResumeStatus
000001  02                DCB      0x02
                  Count
000002  0000              DCB      0x00,0x00
                  kol_rele_on
000004  0000              DCW      0x0000
                  kol_rele_off
000006  0000              DCW      0x0000
                  time_max
000008  0000              DCW      0x0000
                  capture
00000a  0000              DCW      0x0000
                  ||DT1||
                          DCDU     0x00000000
000010  000000            DCB      0x00,0x00,0x00

                          AREA ||area_number.22||, DATA, ALIGN=0

                          EXPORTAS ||area_number.22||, ||.data||
                  LED_Toggle
000000  00                DCB      0x00

                          AREA ||area_number.23||, DATA, ALIGN=1

                          EXPORTAS ||area_number.23||, ||.data||
                  Time_Rec_Base
000000  0000              DCW      0x0000

;*** Start embedded assembler ***

#line 1 "src\\stm32f4xx_it.c"
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_stm32f4xx_it_c_52b4fc9b____REV16|
#line 114 ".\\Libraries\\CMSIS\\core_cmInstr.h"
|__asm___14_stm32f4xx_it_c_52b4fc9b____REV16| PROC
#line 115

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_stm32f4xx_it_c_52b4fc9b____REVSH|
#line 128
|__asm___14_stm32f4xx_it_c_52b4fc9b____REVSH| PROC
#line 129

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
