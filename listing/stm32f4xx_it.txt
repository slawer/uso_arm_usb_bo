; generated by ARM C/C++ Compiler, 5.03 [Build 24]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o.\MEDIA_USB_KEY\stm32f4xx_it.o --asm_dir=.\listing\ --list_dir=.\listing\ --depend=.\MEDIA_USB_KEY\stm32f4xx_it.d --cpu=Cortex-M4 --apcs=interwork -I.\Libraries -I.\Utilities -I.\Libraries\CMSIS\ST\STM32F4xx\Include -I.\inc -I.\src -I.\Libraries\STM32F4xx_StdPeriph_Driver -I.\Libraries\STM32_USB_HOST_Library -I.\Libraries\STM32_USB_OTG_Driver -I.\Utilities\STM32F4-Discovery -I.\Libraries\CMSIS -I.\Utilities\Third_Party\fat_fs -IC:\Keil4\ARM\RV31\INC -IC:\Keil4\ARM\CMSIS\Include -IC:\Keil4\ARM\Inc\ST\STM32F4xx -D__MICROLIB -DUSE_STDPERIPH_DRIVER -DUSE_USB_OTG_FS -DSTM32F4XX -DMEDIA_USB_KEY -D__FPU_PRESENT=0 --omf_browse=.\MEDIA_USB_KEY\stm32f4xx_it.crf src\stm32f4xx_it.c]
                          THUMB

                          AREA ||i.BusFault_Handler||, CODE, READONLY, ALIGN=1

                  BusFault_Handler PROC
                  |L1.0|
;;;137      */
;;;138    void BusFault_Handler(void)
000000  e7fe              B        |L1.0|
;;;139    {
;;;140      /* Go to infinite loop when Bus Fault exception occurs */
;;;141      while (1)
;;;142      {
;;;143      }
;;;144    }
;;;145    
                          ENDP


                          AREA ||i.DebugMon_Handler||, CODE, READONLY, ALIGN=1

                  DebugMon_Handler PROC
;;;172      */
;;;173    void DebugMon_Handler(void)
000000  4770              BX       lr
;;;174    {
;;;175    }
;;;176    
                          ENDP


                          AREA ||i.EXTI0_IRQHandler||, CODE, READONLY, ALIGN=2

                  EXTI0_IRQHandler PROC
;;;1159     */
;;;1160   void EXTI0_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1161   {
;;;1162     /* Checks whether the User Button EXTI line is asserted*/
;;;1163     if (EXTI_GetITStatus(EXTI_Line0) != RESET) 
000002  2001              MOVS     r0,#1
000004  f7fffffe          BL       EXTI_GetITStatus
000008  b158              CBZ      r0,|L3.34|
;;;1164     { 
;;;1165       if (Command_index == 1)
00000a  4808              LDR      r0,|L3.44|
00000c  7803              LDRB     r3,[r0,#0]  ; Command_index
00000e  2100              MOVS     r1,#0
;;;1166       {
;;;1167         RepeatState = 0;
000010  4a07              LDR      r2,|L3.48|
000012  2b01              CMP      r3,#1                 ;1165
000014  d001              BEQ      |L3.26|
;;;1168         /* Switch to play command */
;;;1169         Command_index = 0;
;;;1170       }
;;;1171       else if (Command_index == 0)
000016  7803              LDRB     r3,[r0,#0]  ; Command_index
000018  b10b              CBZ      r3,|L3.30|
                  |L3.26|
00001a  7011              STRB     r1,[r2,#0]            ;1167
00001c  e000              B        |L3.32|
                  |L3.30|
;;;1172       {
;;;1173         /* Switch to record command */
;;;1174         Command_index = 1;
00001e  2101              MOVS     r1,#1
                  |L3.32|
000020  7001              STRB     r1,[r0,#0]
                  |L3.34|
;;;1175     //    XferCplt = 1;
;;;1176     //    EVAL_AUDIO_Stop(CODEC_PDWN_SW);
;;;1177       }
;;;1178       else
;;;1179       {
;;;1180         RepeatState = 0;
;;;1181         /* Switch to play command */
;;;1182         Command_index = 0; 
;;;1183       }
;;;1184     } 
;;;1185     /* Clears the EXTI's line pending bit.*/ 
;;;1186     EXTI_ClearITPendingBit(EXTI_Line0);
000022  e8bd4010          POP      {r4,lr}
000026  2001              MOVS     r0,#1
000028  f7ffbffe          B.W      EXTI_ClearITPendingBit
;;;1187   }
;;;1188   
                          ENDP

                  |L3.44|
                          DCD      Command_index
                  |L3.48|
                          DCD      RepeatState

                          AREA ||i.EXTI1_IRQHandler||, CODE, READONLY, ALIGN=2

                  EXTI1_IRQHandler PROC
;;;1075     */
;;;1076   void EXTI1_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1077   {
;;;1078     /* Check the clic on the accelerometer to Pause/Resume Playing */
;;;1079     if(EXTI_GetITStatus(EXTI_Line1) != RESET)
000002  2002              MOVS     r0,#2
000004  f7fffffe          BL       EXTI_GetITStatus
000008  2800              CMP      r0,#0
00000a  d00f              BEQ      |L4.44|
;;;1080     {
;;;1081       if( Count==1)
00000c  4808              LDR      r0,|L4.48|
00000e  7883              LDRB     r3,[r0,#2]  ; Count
000010  2200              MOVS     r2,#0
;;;1082       {
;;;1083         PauseResumeStatus = 1;
000012  2101              MOVS     r1,#1
000014  2b01              CMP      r3,#1                 ;1081
000016  d006              BEQ      |L4.38|
;;;1084         Count = 0;
;;;1085       }
;;;1086       else
;;;1087       {
;;;1088         PauseResumeStatus = 0;
000018  7042              STRB     r2,[r0,#1]
;;;1089         Count = 1;
00001a  7081              STRB     r1,[r0,#2]
                  |L4.28|
;;;1090       }
;;;1091       /* Clear the EXTI line 1 pending bit */
;;;1092       EXTI_ClearITPendingBit(EXTI_Line1);
00001c  e8bd4010          POP      {r4,lr}
000020  2002              MOVS     r0,#2
000022  f7ffbffe          B.W      EXTI_ClearITPendingBit
                  |L4.38|
000026  7041              STRB     r1,[r0,#1]            ;1083
000028  7082              STRB     r2,[r0,#2]            ;1084
00002a  e7f7              B        |L4.28|
                  |L4.44|
;;;1093     }
;;;1094   }
00002c  bd10              POP      {r4,pc}
;;;1095   
                          ENDP

00002e  0000              DCW      0x0000
                  |L4.48|
                          DCD      ||.data||

                          AREA ||i.HardFault_Handler||, CODE, READONLY, ALIGN=1

                  HardFault_Handler PROC
                  |L5.0|
;;;111      */
;;;112    void HardFault_Handler(void)
000000  e7fe              B        |L5.0|
;;;113    {
;;;114      /* Go to infinite loop when Hard Fault exception occurs */
;;;115      while (1)
;;;116      {
;;;117      }
;;;118    }
;;;119    
                          ENDP


                          AREA ||i.MemManage_Handler||, CODE, READONLY, ALIGN=1

                  MemManage_Handler PROC
                  |L6.0|
;;;124      */
;;;125    void MemManage_Handler(void)
000000  e7fe              B        |L6.0|
;;;126    {
;;;127      /* Go to infinite loop when Memory Manage exception occurs */
;;;128      while (1)
;;;129      {
;;;130      }
;;;131    }
;;;132    
                          ENDP


                          AREA ||i.NMI_Handler||, CODE, READONLY, ALIGN=1

                  NMI_Handler PROC
;;;81       */
;;;82     void NMI_Handler(void)
000000  b510              PUSH     {r4,lr}
;;;83     {
;;;84       /* This interrupt is generated when HSE clock fails */
;;;85     
;;;86       if (RCC_GetITStatus(RCC_IT_CSS) != RESET)
000002  2080              MOVS     r0,#0x80
000004  f7fffffe          BL       RCC_GetITStatus
000008  2800              CMP      r0,#0
00000a  d00b              BEQ      |L7.36|
;;;87       {
;;;88         /* At this stage: HSE, PLL are disabled (but no change on PLL config) and HSI
;;;89            is selected as system clock source */
;;;90     
;;;91         /* Enable HSE */
;;;92         RCC_HSEConfig(RCC_HSE_ON);
00000c  2001              MOVS     r0,#1
00000e  f7fffffe          BL       RCC_HSEConfig
;;;93     
;;;94         /* Enable HSE Ready and PLL Ready interrupts */
;;;95         RCC_ITConfig(RCC_IT_HSERDY | RCC_IT_PLLRDY, ENABLE);
000012  2101              MOVS     r1,#1
000014  2018              MOVS     r0,#0x18
000016  f7fffffe          BL       RCC_ITConfig
;;;96     
;;;97         /* Clear Clock Security System interrupt pending bit */
;;;98         RCC_ClearITPendingBit(RCC_IT_CSS);
00001a  e8bd4010          POP      {r4,lr}
00001e  2080              MOVS     r0,#0x80
000020  f7ffbffe          B.W      RCC_ClearITPendingBit
                  |L7.36|
;;;99     
;;;100        /* Once HSE clock recover, the HSERDY interrupt is generated and in the RCC ISR
;;;101           routine the system clock will be reconfigured to its previous state (before
;;;102           HSE clock failure) */
;;;103      }
;;;104    }
000024  bd10              POP      {r4,pc}
;;;105    
                          ENDP


                          AREA ||i.OTG_FS_IRQHandler||, CODE, READONLY, ALIGN=2

                  OTG_FS_IRQHandler PROC
;;;1205     */
;;;1206   void OTG_FS_IRQHandler(void)
000000  4801              LDR      r0,|L8.8|
;;;1207   {
;;;1208     USBH_OTG_ISR_Handler(&USB_OTG_Core);
000002  f7ffbffe          B.W      USBH_OTG_ISR_Handler
;;;1209   }
;;;1210   #endif /* MEDIA_USB_KEY */
                          ENDP

000006  0000              DCW      0x0000
                  |L8.8|
                          DCD      USB_OTG_Core

                          AREA ||i.PendSV_Handler||, CODE, READONLY, ALIGN=1

                  PendSV_Handler PROC
;;;181      */
;;;182    void PendSV_Handler(void)
000000  4770              BX       lr
;;;183    {
;;;184    }
;;;185    
                          ENDP


                          AREA ||i.RCC_IRQHandler||, CODE, READONLY, ALIGN=1

                  RCC_IRQHandler PROC
;;;1226     */
;;;1227   void RCC_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1228   {
;;;1229     if(RCC_GetITStatus(RCC_IT_HSERDY) != RESET)
000002  2008              MOVS     r0,#8
000004  f7fffffe          BL       RCC_GetITStatus
000008  b148              CBZ      r0,|L10.30|
;;;1230     { 
;;;1231       /* Clear HSERDY interrupt pending bit */
;;;1232       RCC_ClearITPendingBit(RCC_IT_HSERDY);
00000a  2008              MOVS     r0,#8
00000c  f7fffffe          BL       RCC_ClearITPendingBit
;;;1233   
;;;1234       /* Check if the HSE clock is still available */
;;;1235       if (RCC_GetFlagStatus(RCC_FLAG_HSERDY) != RESET)
000010  2031              MOVS     r0,#0x31
000012  f7fffffe          BL       RCC_GetFlagStatus
000016  b110              CBZ      r0,|L10.30|
;;;1236       { 
;;;1237         /* Enable PLL: once the PLL is ready the PLLRDY interrupt is generated */ 
;;;1238         RCC_PLLCmd(ENABLE);     
000018  2001              MOVS     r0,#1
00001a  f7fffffe          BL       RCC_PLLCmd
                  |L10.30|
;;;1239       }
;;;1240     }
;;;1241   
;;;1242     if(RCC_GetITStatus(RCC_IT_PLLRDY) != RESET)
00001e  2010              MOVS     r0,#0x10
000020  f7fffffe          BL       RCC_GetITStatus
000024  2800              CMP      r0,#0
000026  d00c              BEQ      |L10.66|
;;;1243     { 
;;;1244       /* Clear PLLRDY interrupt pending bit */
;;;1245       RCC_ClearITPendingBit(RCC_IT_PLLRDY);
000028  2010              MOVS     r0,#0x10
00002a  f7fffffe          BL       RCC_ClearITPendingBit
;;;1246   
;;;1247       /* Check if the PLL is still locked */
;;;1248       if (RCC_GetFlagStatus(RCC_FLAG_PLLRDY) != RESET)
00002e  2039              MOVS     r0,#0x39
000030  f7fffffe          BL       RCC_GetFlagStatus
000034  2800              CMP      r0,#0
000036  d004              BEQ      |L10.66|
;;;1249       { 
;;;1250         /* Select PLL as system clock source */
;;;1251         RCC_SYSCLKConfig(RCC_SYSCLKSource_PLLCLK);
000038  e8bd4010          POP      {r4,lr}
00003c  2002              MOVS     r0,#2
00003e  f7ffbffe          B.W      RCC_SYSCLKConfig
                  |L10.66|
;;;1252       }
;;;1253     }
;;;1254   }
000042  bd10              POP      {r4,pc}
;;;1255   
                          ENDP


                          AREA ||i.SVC_Handler||, CODE, READONLY, ALIGN=1

                  SVC_Handler PROC
;;;163      */
;;;164    void SVC_Handler(void)
000000  4770              BX       lr
;;;165    {
;;;166    }
;;;167    
                          ENDP


                          AREA ||i.SysTick_Handler||, CODE, READONLY, ALIGN=2

                  SysTick_Handler PROC
;;;321      */
;;;322    void SysTick_Handler(void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;323    {
;;;324    	extern __IO uint16_t ADC3ConvertedValue;
;;;325    	extern u32 tick;
;;;326    	extern st_conf conf;
;;;327    	
;;;328     //  проверка состояния датчика приближений - 
;;;329    	
;;;330    	if ((PORT_PRIBL->IDR & PIN_PRIBL)==0)
000004  4cfe              LDR      r4,|L12.1024|
000006  6820              LDR      r0,[r4,#0]
;;;331    		kol_pribl_vikl++;
;;;332    	else
;;;333    		kol_pribl_vkl++;
000008  4afe              LDR      r2,|L12.1028|
00000a  4fff              LDR      r7,|L12.1032|
00000c  07c0              LSLS     r0,r0,#31             ;330
00000e  d064              BEQ      |L12.218|
000010  8810              LDRH     r0,[r2,#0]  ; kol_pribl_vkl
000012  1c40              ADDS     r0,r0,#1
000014  8010              STRH     r0,[r2,#0]
                  |L12.22|
;;;334    	
;;;335    	if (kol_pribl_vkl>=conf.tm_antidreb)
000016  f8dfc3f4          LDR      r12,|L12.1036|
;;;336    	{
;;;337    			sost_pribl=1;
;;;338    			PORT_PER_NIZ->BSRRH = PIN_PER_NIZ;  	// off  PIN_PER_NIZ
00001a  4bfd              LDR      r3,|L12.1040|
00001c  f8b28000          LDRH     r8,[r2,#0]            ;335  ; kol_pribl_vkl
000020  f89c0004          LDRB     r0,[r12,#4]           ;335  ; conf
000024  1599              ASRS     r1,r3,#22
000026  4efb              LDR      r6,|L12.1044|
000028  2500              MOVS     r5,#0                 ;337
;;;339    			PORT_PER_VERH->BSRRL = PIN_PER_VERH;	// on PIN_PER_VERH
00002a  f44f7900          MOV      r9,#0x200
00002e  f04f0a01          MOV      r10,#1                ;337
000032  4540              CMP      r0,r8                 ;335
000034  d806              BHI      |L12.68|
000036  f886a000          STRB     r10,[r6,#0]           ;337
00003a  8359              STRH     r1,[r3,#0x1a]         ;338
00003c  f8a39018          STRH     r9,[r3,#0x18]
;;;340    			kol_pribl_vkl=0;
000040  8015              STRH     r5,[r2,#0]
;;;341    		  kol_pribl_vikl=0;
000042  803d              STRH     r5,[r7,#0]
                  |L12.68|
;;;342    	} 
;;;343    	
;;;344    	if (kol_pribl_vikl>=conf.tm_antidreb)
000044  f8b78000          LDRH     r8,[r7,#0]  ; kol_pribl_vikl
000048  4540              CMP      r0,r8
00004a  d805              BHI      |L12.88|
;;;345    	{
;;;346    			sost_pribl=0;
00004c  7035              STRB     r5,[r6,#0]
;;;347    			PORT_PER_NIZ->BSRRL = PIN_PER_NIZ;  	// on  PIN_PER_NIZ
00004e  8319              STRH     r1,[r3,#0x18]
;;;348    			PORT_PER_VERH->BSRRH = PIN_PER_VERH;	// off PIN_PER_VERH
000050  f8a3901a          STRH     r9,[r3,#0x1a]
;;;349    			kol_pribl_vkl=0;
000054  8015              STRH     r5,[r2,#0]
;;;350    			kol_pribl_vikl=0;
000056  803d              STRH     r5,[r7,#0]
                  |L12.88|
;;;351    	}
;;;352    
;;;353    	
;;;354    	// проверка кнопок-состояния переключателей группы калибровок
;;;355    	// on 	GPIO_PORT[Led]->BSRRL = GPIO_PIN[Led];
;;;356    	// off  GPIO_PORT[Led]->BSRRH = GPIO_PIN[Led];    
;;;357    //	conf.tek_gr_kal
;;;358    
;;;359    		if ((PORT_K1->IDR & PIN_K1)==0)
000058  6822              LDR      r2,[r4,#0]
;;;360    			kol_gr1_vkl++;
00005a  4bef              LDR      r3,|L12.1048|
00005c  0612              LSLS     r2,r2,#24             ;359
00005e  d403              BMI      |L12.104|
000060  881a              LDRH     r2,[r3,#0]  ; kol_gr1_vkl
000062  f1020201          ADD      r2,r2,#1
000066  801a              STRH     r2,[r3,#0]
                  |L12.104|
;;;361    
;;;362    		if ((PORT_K2->IDR & PIN_K2)==0)
000068  6822              LDR      r2,[r4,#0]
00006a  0594              LSLS     r4,r2,#22
;;;363    			kol_gr2_vkl++;
00006c  4aeb              LDR      r2,|L12.1052|
00006e  d402              BMI      |L12.118|
000070  8814              LDRH     r4,[r2,#0]  ; kol_gr2_vkl
000072  1c64              ADDS     r4,r4,#1
000074  8014              STRH     r4,[r2,#0]
                  |L12.118|
;;;364    
;;;365    		if (kol_gr1_vkl>=conf.tm_antidreb)
;;;366    		{
;;;367    				conf.tek_gr_kal=0;
;;;368    	 // gr 1
;;;369    			PORT_L1->BSRRL = PIN_L1;  	// on  PIN_L1
000076  f8df9388          LDR      r9,|L12.1024|
00007a  881f              LDRH     r7,[r3,#0]            ;365  ; kol_gr1_vkl
00007c  2440              MOVS     r4,#0x40
00007e  f1090908          ADD      r9,r9,#8
;;;370    			PORT_L2->BSRRH = PIN_L2;	// off PIN_L2
000082  f1090802          ADD      r8,r9,#2
000086  42b8              CMP      r0,r7                 ;365
000088  d807              BHI      |L12.154|
00008a  f88c5003          STRB     r5,[r12,#3]           ;367
00008e  f8a94000          STRH     r4,[r9,#0]            ;369
000092  f8a81000          STRH     r1,[r8,#0]
;;;371    
;;;372    				kol_gr1_vkl=0;
000096  801d              STRH     r5,[r3,#0]
;;;373    				kol_gr2_vkl=0;
000098  8015              STRH     r5,[r2,#0]
                  |L12.154|
;;;374    		}		
;;;375    
;;;376    		if (kol_gr2_vkl>=conf.tm_antidreb)
00009a  8817              LDRH     r7,[r2,#0]  ; kol_gr2_vkl
00009c  42b8              CMP      r0,r7
00009e  d808              BHI      |L12.178|
;;;377    		{
;;;378    				conf.tek_gr_kal=1;
0000a0  4fda              LDR      r7,|L12.1036|
0000a2  f887a003          STRB     r10,[r7,#3]
;;;379    				 // gr 2
;;;380    			PORT_L1->BSRRH = PIN_L1;  	// off  PIN_L1
0000a6  f8a84000          STRH     r4,[r8,#0]
;;;381    			PORT_L2->BSRRL = PIN_L2;	// on PIN_L2
0000aa  f8a91000          STRH     r1,[r9,#0]
;;;382    				kol_gr1_vkl=0;
0000ae  801d              STRH     r5,[r3,#0]
;;;383    				kol_gr2_vkl=0;
0000b0  8015              STRH     r5,[r2,#0]
                  |L12.178|
;;;384    		}				
;;;385    	
;;;386    	/*
;;;387    	  RCC_AHB1PeriphClockCmd(GPIO_CLK[Led], ENABLE);
;;;388    
;;;389    
;;;390      GPIO_InitStructure.GPIO_Pin = GPIO_PIN[Led];
;;;391      GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
;;;392      GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
;;;393      GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
;;;394      GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
;;;395      GPIO_Init(GPIO_PORT[Led], &GPIO_InitStructure);
;;;396    	*/
;;;397    	
;;;398    			// проверяем реле на срабатывание
;;;399    	test_rele(fz[0], 0);	
0000b2  4cdb              LDR      r4,|L12.1056|
0000b4  2100              MOVS     r1,#0
0000b6  8820              LDRH     r0,[r4,#0]  ; fz
0000b8  f7fffffe          BL       test_rele
;;;400    	
;;;401    	
;;;402    	// раз в 10 мс
;;;403    	// находим среднее значение
;;;404    	summa[0]+=ADC3ConvertedValue;
0000bc  4ad9              LDR      r2,|L12.1060|
0000be  48da              LDR      r0,|L12.1064|
0000c0  8811              LDRH     r1,[r2,#0]  ; summa
0000c2  8800              LDRH     r0,[r0,#0]  ; ADC3ConvertedValue
;;;405    	 
;;;406    //		summa[0]+=100;
;;;407    	kol_average++;
0000c4  4bd9              LDR      r3,|L12.1068|
0000c6  4408              ADD      r0,r0,r1              ;404
0000c8  b281              UXTH     r1,r0                 ;404
0000ca  8011              STRH     r1,[r2,#0]            ;404
0000cc  7818              LDRB     r0,[r3,#0]  ; kol_average
0000ce  1c40              ADDS     r0,r0,#1
0000d0  b2c0              UXTB     r0,r0
0000d2  7018              STRB     r0,[r3,#0]
;;;408    	
;;;409    	if (kol_average==10)
0000d4  280a              CMP      r0,#0xa
0000d6  d004              BEQ      |L12.226|
0000d8  e0dc              B        |L12.660|
                  |L12.218|
0000da  8838              LDRH     r0,[r7,#0]            ;331  ; kol_pribl_vikl
0000dc  1c40              ADDS     r0,r0,#1              ;331
0000de  8038              STRH     r0,[r7,#0]            ;331
0000e0  e799              B        |L12.22|
                  |L12.226|
;;;410    	{			
;;;411    	
;;;412    		average[0]=summa[0]/kol_average;
0000e2  fbb1f0f0          UDIV     r0,r1,r0
0000e6  49d2              LDR      r1,|L12.1072|
;;;413    		kol_average=0;
;;;414    		summa[0]=0;
;;;415    		
;;;416    		
;;;417    		// раз в 100 мс
;;;418    		// вычисляем физическую величину
;;;419    		
;;;420    		if (conf.tek_gr_kal==0)
0000e8  4fc8              LDR      r7,|L12.1036|
0000ea  8008              STRH     r0,[r1,#0]            ;412
0000ec  701d              STRB     r5,[r3,#0]            ;413
0000ee  8015              STRH     r5,[r2,#0]            ;414
0000f0  78f9              LDRB     r1,[r7,#3]  ; conf
0000f2  2900              CMP      r1,#0
;;;421    				if (sost_pribl==0)
;;;422    					fz[0]=fiz_vel(average[0],&conf.gr_kal1.tabl1);
;;;423    				else
;;;424    					fz[0]=fiz_vel(average[0],&conf.gr_kal1.tabl2);
;;;425    		else
;;;426    				if (sost_pribl==0)
0000f4  7831              LDRB     r1,[r6,#0]  ; sost_pribl
0000f6  d028              BEQ      |L12.330|
0000f8  2900              CMP      r1,#0
;;;427    					fz[0]=fiz_vel(average[0],&conf.gr_kal2.tabl1);
;;;428    				else
;;;429    					fz[0]=fiz_vel(average[0],&conf.gr_kal2.tabl2);
0000fa  4639              MOV      r1,r7
0000fc  d02c              BEQ      |L12.344|
0000fe  3196              ADDS     r1,r1,#0x96
                  |L12.256|
000100  f7fffffe          BL       fiz_vel
000104  8020              STRH     r0,[r4,#0]            ;427
;;;430    			
;;;431    	
;;;432    	// находим среднее значение по скользящей средней
;;;433    		fz_average[0]=moving_average(fz[0],0);
000106  b280              UXTH     r0,r0
000108  2100              MOVS     r1,#0
00010a  f7fffffe          BL       moving_average
00010e  49c9              LDR      r1,|L12.1076|
;;;434    
;;;435    		// time max
;;;436    		if (time_max>=conf.time_max) {
000110  4abe              LDR      r2,|L12.1036|
000112  4cc9              LDR      r4,|L12.1080|
000114  8008              STRH     r0,[r1,#0]            ;433
000116  8952              LDRH     r2,[r2,#0xa]  ; conf
000118  8923              LDRH     r3,[r4,#8]  ; time_max
00011a  429a              CMP      r2,r3
00011c  d802              BHI      |L12.292|
;;;437    				max[0]=0;
00011e  4ac7              LDR      r2,|L12.1084|
000120  8015              STRH     r5,[r2,#0]
;;;438    				time_max=0;  }
000122  8125              STRH     r5,[r4,#8]
                  |L12.292|
;;;439    		time_max++;
000124  8922              LDRH     r2,[r4,#8]  ; time_max
;;;440    		// detect max
;;;441    		if (fz_average[0]>max[0])
000126  f8df9314          LDR      r9,|L12.1084|
00012a  1c52              ADDS     r2,r2,#1              ;439
00012c  8122              STRH     r2,[r4,#8]            ;439
00012e  f8b91000          LDRH     r1,[r9,#0]  ; max
000132  4288              CMP      r0,r1
000134  d901              BLS      |L12.314|
;;;442    			max[0]=fz_average[0];
000136  f8a90000          STRH     r0,[r9,#0]
                  |L12.314|
;;;443    
;;;444    		
;;;445    		if (number_buff)
00013a  48c1              LDR      r0,|L12.1088|
;;;446    			Buf_adc_zap2[por++]=por; //fz_average[0];			
;;;447    		else
;;;448    			Buf_adc_zap1[por++]=por; //fz_average[0];
00013c  49c1              LDR      r1,|L12.1092|
00013e  7800              LDRB     r0,[r0,#0]            ;445  ; number_buff
000140  2800              CMP      r0,#0                 ;445
000142  8808              LDRH     r0,[r1,#0]  ; por
000144  d00a              BEQ      |L12.348|
000146  4ac0              LDR      r2,|L12.1096|
000148  e009              B        |L12.350|
                  |L12.330|
00014a  2900              CMP      r1,#0                 ;421
00014c  49af              LDR      r1,|L12.1036|
00014e  d001              BEQ      |L12.340|
000150  3146              ADDS     r1,r1,#0x46           ;424
000152  e7d5              B        |L12.256|
                  |L12.340|
000154  311e              ADDS     r1,r1,#0x1e           ;422
000156  e7d3              B        |L12.256|
                  |L12.344|
000158  316e              ADDS     r1,r1,#0x6e           ;427
00015a  e7d1              B        |L12.256|
                  |L12.348|
00015c  4abb              LDR      r2,|L12.1100|
                  |L12.350|
;;;449    		
;;;450    		if (por==999)
00015e  4fb9              LDR      r7,|L12.1092|
000160  f8220010          STRH     r0,[r2,r0,LSL #1]     ;448
000164  1c40              ADDS     r0,r0,#1              ;448
000166  8008              STRH     r0,[r1,#0]            ;448
000168  8839              LDRH     r1,[r7,#0]  ; por
00016a  f24030e7          MOV      r0,#0x3e7
00016e  4281              CMP      r1,r0
000170  d100              BNE      |L12.372|
;;;451    			por=999;
000172  8038              STRH     r0,[r7,#0]
                  |L12.372|
;;;452    	
;;;453    	del++;
000174  49b6              LDR      r1,|L12.1104|
;;;454    	if (del==10)
;;;455    	{		
;;;456    		del=0;
;;;457    		tick++;
000176  f8dfb2dc          LDR      r11,|L12.1108|
00017a  8808              LDRH     r0,[r1,#0]            ;453  ; del
00017c  1c40              ADDS     r0,r0,#1              ;453
00017e  b280              UXTH     r0,r0                 ;453
000180  8008              STRH     r0,[r1,#0]            ;453
000182  280a              CMP      r0,#0xa               ;454
000184  d165              BNE      |L12.594|
000186  800d              STRH     r5,[r1,#0]            ;456
000188  f8db0000          LDR      r0,[r11,#0]  ; tick
;;;458    		time_label=tick;
00018c  49b2              LDR      r1,|L12.1112|
00018e  1c40              ADDS     r0,r0,#1              ;457
000190  f8cb0000          STR      r0,[r11,#0]  ; tick
000194  8008              STRH     r0,[r1,#0]
;;;459    		
;;;460    		rtc_Get(&DT1);
000196  48a8              LDR      r0,|L12.1080|
000198  300c              ADDS     r0,r0,#0xc
00019a  f7fffffe          BL       rtc_Get
;;;461    		
;;;462    		if (DT1.Seconds==0)
00019e  f8df8298          LDR      r8,|L12.1080|
0001a2  f108080c          ADD      r8,r8,#0xc
0001a6  f8981006          LDRB     r1,[r8,#6]  ; DT1
0001aa  b971              CBNZ     r1,|L12.458|
;;;463    		{
;;;464    			number_buff^=1;
0001ac  48a4              LDR      r0,|L12.1088|
0001ae  7802              LDRB     r2,[r0,#0]  ; number_buff
0001b0  f0820201          EOR      r2,r2,#1
0001b4  7002              STRB     r2,[r0,#0]
;;;465    			DT_zap=DT1;
0001b6  48a9              LDR      r0,|L12.1116|
0001b8  68e2              LDR      r2,[r4,#0xc]  ; DT1
0001ba  6002              STR      r2,[r0,#0]  ; DT_zap
0001bc  8a22              LDRH     r2,[r4,#0x10]  ; DT1
0001be  8082              STRH     r2,[r0,#4]
0001c0  7181              STRB     r1,[r0,#6]
;;;466    			
;;;467    			buffering=1;
0001c2  49a7              LDR      r1,|L12.1120|
0001c4  f881a000          STRB     r10,[r1,#0]
;;;468    			por=0;
0001c8  803d              STRH     r5,[r7,#0]
                  |L12.458|
;;;469    		}
;;;470    			
;;;471    	 if (tick%2==0)
0001ca  f89b0000          LDRB     r0,[r11,#0]  ; tick
0001ce  465f              MOV      r7,r11
0001d0  07c0              LSLS     r0,r0,#31
;;;472    	 {
;;;473    		 STM_EVAL_LEDOn(LED3);		 
;;;474    	 }
;;;475    	 else
;;;476    	 {
;;;477    		 STM_EVAL_LEDOff(LED3);	 
0001d2  f04f0001          MOV      r0,#1
0001d6  d009              BEQ      |L12.492|
0001d8  f7fffffe          BL       STM_EVAL_LEDOff
                  |L12.476|
;;;478    	 }
;;;479    	 
;;;480    // indicate_lin(0,(u16)fz_average[0], 4096);
;;;481    // indicate(1,(u16)(fz_average[0]/10));
;;;482    	 if (tk_null==1)
0001dc  7820              LDRB     r0,[r4,#0]  ; tk_null
0001de  2801              CMP      r0,#1
0001e0  d007              BEQ      |L12.498|
;;;483    	 {
;;;484    		 indicate_err(1);   	// tek
;;;485    		 indicate_err(2);			// lineika 
;;;486    		 indicate_err(3);			// maximum
;;;487    	//	 indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes);								//	time	
;;;488    	 }
;;;489    	 else
;;;490    	 {		
;;;491    	 if ((avariya==1)&((tick%2)==0))
0001e2  48a0              LDR      r0,|L12.1124|
0001e4  7800              LDRB     r0,[r0,#0]  ; avariya
0001e6  2801              CMP      r0,#1
0001e8  d00d              BEQ      |L12.518|
0001ea  e00f              B        |L12.524|
                  |L12.492|
0001ec  f7fffffe          BL       STM_EVAL_LEDOn
0001f0  e7f4              B        |L12.476|
                  |L12.498|
0001f2  2001              MOVS     r0,#1                 ;484
0001f4  f7fffffe          BL       indicate_err
0001f8  2002              MOVS     r0,#2                 ;485
0001fa  f7fffffe          BL       indicate_err
0001fe  2003              MOVS     r0,#3                 ;486
000200  f7fffffe          BL       indicate_err
000204  e025              B        |L12.594|
                  |L12.518|
000206  7838              LDRB     r0,[r7,#0]  ; tick
000208  07c0              LSLS     r0,r0,#31
00020a  d02b              BEQ      |L12.612|
                  |L12.524|
;;;492    	 {
;;;493    			ind_blank_all(1); 
;;;494    			ind_blank_all(2); 
;;;495    			ind_blank_all(3); 
;;;496    	//		ind_blank_all(4); 		 
;;;497    		}
;;;498    		else
;;;499    		{
;;;500    		 // dop usrednenie na vivod indicatorov???
;;;501    		 indicate(1,(u16)(u16)(fz_average[0]),3);   																// tek
00020c  4c89              LDR      r4,|L12.1076|
00020e  2203              MOVS     r2,#3
000210  2001              MOVS     r0,#1
000212  8821              LDRH     r1,[r4,#0]  ; fz_average
000214  f7fffffe          BL       indicate
;;;502    
;;;503    			if (conf.tek_gr_kal==0)
000218  487c              LDR      r0,|L12.1036|
00021a  78c1              LDRB     r1,[r0,#3]  ; conf
00021c  2900              CMP      r1,#0
;;;504    					if (sost_pribl==0)
;;;505    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max1, (u16) conf.lin.kol_st);			// lineika 
;;;506    					else
;;;507    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max2, (u16) conf.lin.kol_st);			// lineika 
;;;508    			else
;;;509    					if (sost_pribl==0)
00021e  7831              LDRB     r1,[r6,#0]  ; sost_pribl
000220  d02a              BEQ      |L12.632|
;;;510    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max3, (u16) conf.lin.kol_st);			// lineika 
;;;511    					else
;;;512    						indicate_lin(2,(u16) fz_average[0], (u16) conf.lin.max4, (u16) conf.lin.kol_st);			// lineika 
000222  7d03              LDRB     r3,[r0,#0x14]  ; conf
000224  b371              CBZ      r1,|L12.644|
000226  8b82              LDRH     r2,[r0,#0x1c]  ; conf
                  |L12.552|
000228  8821              LDRH     r1,[r4,#0]            ;510  ; fz_average
00022a  2002              MOVS     r0,#2                 ;510
00022c  f7fffffe          BL       indicate_lin
;;;513    		 
;;;514    		 indicate(3,(u16)(max[0]),3);														// maximum
000230  2203              MOVS     r2,#3
000232  f8b91000          LDRH     r1,[r9,#0]  ; max
000236  4610              MOV      r0,r2
000238  f7fffffe          BL       indicate
;;;515    		
;;;516    			if ((tick%2)==0)
00023c  7838              LDRB     r0,[r7,#0]  ; tick
;;;517    				indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes,1);				//	time	
;;;518    			else
;;;519    				indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes,0);				//	time	
00023e  f8982005          LDRB     r2,[r8,#5]  ; DT1
000242  f8981004          LDRB     r1,[r8,#4]  ; DT1
000246  07c0              LSLS     r0,r0,#31             ;516
000248  d01e              BEQ      |L12.648|
00024a  2300              MOVS     r3,#0
                  |L12.588|
00024c  2004              MOVS     r0,#4                 ;517
00024e  f7fffffe          BL       indicate_time
                  |L12.594|
;;;520    		}
;;;521    	 }	
;;;522     }	 
;;;523    		
;;;524    	if ((tick%60)==0)
000252  f8db0000          LDR      r0,[r11,#0]  ; tick
000256  213c              MOVS     r1,#0x3c
000258  fbb0f2f1          UDIV     r2,r0,r1
00025c  fb010012          MLS      r0,r1,r2,r0
000260  b1a0              CBZ      r0,|L12.652|
000262  e017              B        |L12.660|
                  |L12.612|
000264  2001              MOVS     r0,#1                 ;493
000266  f7fffffe          BL       ind_blank_all
00026a  2002              MOVS     r0,#2                 ;494
00026c  f7fffffe          BL       ind_blank_all
000270  2003              MOVS     r0,#3                 ;495
000272  f7fffffe          BL       ind_blank_all
000276  e7ec              B        |L12.594|
                  |L12.632|
000278  7d03              LDRB     r3,[r0,#0x14]         ;507  ; conf
00027a  b109              CBZ      r1,|L12.640|
00027c  8b02              LDRH     r2,[r0,#0x18]         ;507  ; conf
00027e  e7d3              B        |L12.552|
                  |L12.640|
000280  8ac2              LDRH     r2,[r0,#0x16]         ;505  ; conf
000282  e7d1              B        |L12.552|
                  |L12.644|
000284  8b42              LDRH     r2,[r0,#0x1a]         ;510  ; conf
000286  e7cf              B        |L12.552|
                  |L12.648|
000288  2301              MOVS     r3,#1                 ;517
00028a  e7df              B        |L12.588|
                  |L12.652|
;;;525    	{
;;;526    		minute++;
00028c  4976              LDR      r1,|L12.1128|
00028e  8808              LDRH     r0,[r1,#0]  ; minute
000290  1c40              ADDS     r0,r0,#1
000292  8008              STRH     r0,[r1,#0]
                  |L12.660|
;;;527    	}
;;;528    	}	
;;;529    	
;;;530    	if (new_komand)
000294  4875              LDR      r0,|L12.1132|
000296  7800              LDRB     r0,[r0,#0]  ; new_komand
000298  2800              CMP      r0,#0
00029a  d06f              BEQ      |L12.892|
;;;531    	{
;;;532    		u16 tmp=0;
;;;533    	
;;;534    		// wrt_conf
;;;535    		if ((RxBuffer[2]=='w')&(RxBuffer[3]=='r')&(RxBuffer[4]=='t')&(RxBuffer[5]=='_')&(RxBuffer[6]=='c')&(RxBuffer[7]=='o')&(RxBuffer[8]=='n')&(RxBuffer[9]=='f'))
00029c  4a74              LDR      r2,|L12.1136|
00029e  7890              LDRB     r0,[r2,#2]  ; RxBuffer
0002a0  2877              CMP      r0,#0x77
0002a2  d046              BEQ      |L12.818|
0002a4  2000              MOVS     r0,#0
                  |L12.678|
0002a6  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
0002a8  2972              CMP      r1,#0x72
0002aa  d044              BEQ      |L12.822|
0002ac  2100              MOVS     r1,#0
                  |L12.686|
0002ae  4008              ANDS     r0,r0,r1
0002b0  7911              LDRB     r1,[r2,#4]  ; RxBuffer
0002b2  2974              CMP      r1,#0x74
0002b4  d041              BEQ      |L12.826|
0002b6  2100              MOVS     r1,#0
                  |L12.696|
0002b8  4008              ANDS     r0,r0,r1
0002ba  7951              LDRB     r1,[r2,#5]  ; RxBuffer
0002bc  295f              CMP      r1,#0x5f
0002be  d03e              BEQ      |L12.830|
0002c0  2100              MOVS     r1,#0
                  |L12.706|
0002c2  4008              ANDS     r0,r0,r1
0002c4  7991              LDRB     r1,[r2,#6]  ; RxBuffer
0002c6  2963              CMP      r1,#0x63
0002c8  d03b              BEQ      |L12.834|
0002ca  2100              MOVS     r1,#0
                  |L12.716|
0002cc  4008              ANDS     r0,r0,r1
0002ce  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
0002d0  296f              CMP      r1,#0x6f
0002d2  d038              BEQ      |L12.838|
0002d4  2100              MOVS     r1,#0
                  |L12.726|
0002d6  4008              ANDS     r0,r0,r1
0002d8  7a11              LDRB     r1,[r2,#8]  ; RxBuffer
0002da  296e              CMP      r1,#0x6e
0002dc  d035              BEQ      |L12.842|
0002de  2100              MOVS     r1,#0
                  |L12.736|
0002e0  4008              ANDS     r0,r0,r1
0002e2  4963              LDR      r1,|L12.1136|
0002e4  7a49              LDRB     r1,[r1,#9]  ; RxBuffer
0002e6  2966              CMP      r1,#0x66
0002e8  d031              BEQ      |L12.846|
0002ea  2100              MOVS     r1,#0
                  |L12.748|
;;;536    		{
;;;537    			u16 i=0;
;;;538    			u8 errors=0;
;;;539    			
;;;540    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
;;;541    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
;;;542    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
;;;543    	
;;;544    		
;;;545    			for (i = 0; i < rxsize-10; i += 2)
;;;546    			{
;;;547    			  tmp1=RxBuffer[i+10];
;;;548    				tmp2=RxBuffer[i+11];
;;;549    				tmp3=0;
;;;550    				if (tmp1>'9')	
;;;551    						tmp3=(tmp1-0x37)<<4;
;;;552    				else
;;;553    						tmp3=(tmp1-0x30)<<4;
;;;554    	
;;;555    				if (tmp2>'9')	
;;;556    						tmp3+=(tmp2-0x37);
;;;557    				else
;;;558    						tmp3+=(tmp2-0x30);				
;;;559    				*(__IO uint8_t *) (BKPSRAM_BASE + (i>>1)) = tmp3;//*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i);
;;;560    				if (*(__IO uint8_t *) (BKPSRAM_BASE + (i>>1)) != tmp3)
;;;561    						errors=1;
;;;562    			}
;;;563    
;;;564    			if (errors==0)
;;;565    			{
;;;566    			TxBuffer[0]='w';
;;;567    			TxBuffer[1]='r';	
;;;568    			TxBuffer[2]='t';
;;;569    			TxBuffer[3]='_';					
;;;570    			TxBuffer[4]='c';		
;;;571    			TxBuffer[5]='o';	
;;;572    			TxBuffer[6]='n';	
;;;573    			TxBuffer[7]='f';	
;;;574    			TxBuffer[8]='_';	
;;;575    			TxBuffer[9]='o';
;;;576    			TxBuffer[10]='k';	
;;;577    			}
;;;578    			else
;;;579    			{
;;;580    				TxBuffer[0]='w';
;;;581    				TxBuffer[1]='r';	
;;;582    				TxBuffer[2]='t';
;;;583    				TxBuffer[3]='_';					
;;;584    				TxBuffer[4]='c';		
;;;585    				TxBuffer[5]='o';	
;;;586    				TxBuffer[6]='n';	
;;;587    				TxBuffer[7]='f';	
;;;588    				TxBuffer[8]='_';	
;;;589    				TxBuffer[9]='e';
;;;590    				TxBuffer[10]='r';	
;;;591    			}
;;;592    	
;;;593    			txsize=11;
;;;594    			tekper=0;
0002ec  f8dfb184          LDR      r11,|L12.1140|
0002f0  f8df9184          LDR      r9,|L12.1144|
0002f4  4c61              LDR      r4,|L12.1148|
0002f6  f8dfa188          LDR      r10,|L12.1152|
0002fa  4208              TST      r0,r1                 ;535
0002fc  d074              BEQ      |L12.1000|
0002fe  2700              MOVS     r7,#0                 ;537
000300  46b8              MOV      r8,r7                 ;538
000302  463a              MOV      r2,r7                 ;540
000304  f2405125          MOV      r1,#0x525             ;540
000308  4648              MOV      r0,r9                 ;540
00030a  f7fffffe          BL       USART_ITConfig
00030e  2201              MOVS     r2,#1                 ;541
000310  f2406126          MOV      r1,#0x626             ;541
000314  4648              MOV      r0,r9                 ;541
000316  f7fffffe          BL       USART_ITConfig
00031a  2201              MOVS     r2,#1                 ;542
00031c  2108              MOVS     r1,#8                 ;542
00031e  4859              LDR      r0,|L12.1156|
000320  f7fffffe          BL       GPIO_WriteBit
000324  f8dfc160          LDR      r12,|L12.1160|
000328  4b58              LDR      r3,|L12.1164|
00032a  4959              LDR      r1,|L12.1168|
00032c  f8dfe140          LDR      lr,|L12.1136|
000330  e034              B        |L12.924|
                  |L12.818|
000332  2001              MOVS     r0,#1                 ;535
000334  e7b7              B        |L12.678|
                  |L12.822|
000336  2101              MOVS     r1,#1                 ;535
000338  e7b9              B        |L12.686|
                  |L12.826|
00033a  2101              MOVS     r1,#1                 ;535
00033c  e7bc              B        |L12.696|
                  |L12.830|
00033e  2101              MOVS     r1,#1                 ;535
000340  e7bf              B        |L12.706|
                  |L12.834|
000342  2101              MOVS     r1,#1                 ;535
000344  e7c2              B        |L12.716|
                  |L12.838|
000346  2101              MOVS     r1,#1                 ;535
000348  e7c5              B        |L12.726|
                  |L12.842|
00034a  2101              MOVS     r1,#1                 ;535
00034c  e7c8              B        |L12.736|
                  |L12.846|
00034e  2101              MOVS     r1,#1                 ;535
000350  e7cc              B        |L12.748|
                  |L12.850|
000352  eb0e0007          ADD      r0,lr,r7              ;547
000356  7a82              LDRB     r2,[r0,#0xa]          ;547
000358  f88c2000          STRB     r2,[r12,#0]           ;547
00035c  7ac0              LDRB     r0,[r0,#0xb]          ;548
00035e  7018              STRB     r0,[r3,#0]            ;548
000360  2a39              CMP      r2,#0x39              ;550
000362  700d              STRB     r5,[r1,#0]            ;549
000364  ea4f1202          LSL      r2,r2,#4              ;553
000368  d901              BLS      |L12.878|
00036a  f5a2725c          SUB      r2,r2,#0x370          ;551
                  |L12.878|
00036e  700a              STRB     r2,[r1,#0]            ;553
000370  2839              CMP      r0,#0x39              ;555
000372  b2d2              UXTB     r2,r2                 ;558
000374  4410              ADD      r0,r0,r2              ;558
000376  d902              BLS      |L12.894|
000378  3837              SUBS     r0,r0,#0x37           ;556
00037a  e001              B        |L12.896|
                  |L12.892|
00037c  e36a              B        |L12.2644|
                  |L12.894|
00037e  3830              SUBS     r0,r0,#0x30           ;558
                  |L12.896|
000380  7008              STRB     r0,[r1,#0]            ;558
000382  b2c2              UXTB     r2,r0                 ;559
000384  4843              LDR      r0,|L12.1172|
000386  eb000057          ADD      r0,r0,r7,LSR #1       ;559
00038a  7002              STRB     r2,[r0,#0]            ;559
00038c  7800              LDRB     r0,[r0,#0]            ;560
00038e  780a              LDRB     r2,[r1,#0]            ;560  ; tmp3
000390  4290              CMP      r0,r2                 ;560
000392  d001              BEQ      |L12.920|
000394  f04f0801          MOV      r8,#1                 ;561
                  |L12.920|
000398  1cbf              ADDS     r7,r7,#2              ;545
00039a  b2bf              UXTH     r7,r7                 ;545
                  |L12.924|
00039c  483e              LDR      r0,|L12.1176|
00039e  8800              LDRH     r0,[r0,#0]            ;545  ; rxsize
0003a0  380a              SUBS     r0,r0,#0xa            ;545
0003a2  4287              CMP      r7,r0                 ;545
0003a4  dbd5              BLT      |L12.850|
0003a6  2177              MOVS     r1,#0x77              ;535
0003a8  7021              STRB     r1,[r4,#0]            ;580
0003aa  2063              MOVS     r0,#0x63              ;535
0003ac  236e              MOVS     r3,#0x6e              ;535
0003ae  2266              MOVS     r2,#0x66              ;535
0003b0  f04f0172          MOV      r1,#0x72              ;581
0003b4  f1b80f00          CMP      r8,#0                 ;564
0003b8  7061              STRB     r1,[r4,#1]            ;581
0003ba  d06f              BEQ      |L12.1180|
0003bc  2774              MOVS     r7,#0x74              ;582
0003be  70a7              STRB     r7,[r4,#2]            ;582
0003c0  275f              MOVS     r7,#0x5f              ;583
0003c2  70e7              STRB     r7,[r4,#3]            ;583
0003c4  7120              STRB     r0,[r4,#4]            ;584
0003c6  206f              MOVS     r0,#0x6f              ;585
0003c8  7160              STRB     r0,[r4,#5]            ;585
0003ca  71a3              STRB     r3,[r4,#6]            ;586
0003cc  71e2              STRB     r2,[r4,#7]            ;587
0003ce  7227              STRB     r7,[r4,#8]            ;588
0003d0  2065              MOVS     r0,#0x65              ;589
0003d2  7260              STRB     r0,[r4,#9]            ;589
0003d4  72a1              STRB     r1,[r4,#0xa]          ;590
                  |L12.982|
0003d6  200b              MOVS     r0,#0xb               ;593
0003d8  f8aa0000          STRH     r0,[r10,#0]           ;593
0003dc  f8ab5000          STRH     r5,[r11,#0]
;;;595    			USART_SendData(USART2, 0x3A);
0003e0  213a              MOVS     r1,#0x3a
0003e2  4648              MOV      r0,r9
0003e4  f7fffffe          BL       USART_SendData
                  |L12.1000|
;;;596    		}
;;;597    
;;;598    		// who?
;;;599    		if ((RxBuffer[2]=='w')&(RxBuffer[3]=='h')&(RxBuffer[4]=='o')&(RxBuffer[5]=='?'))
0003e8  4f21              LDR      r7,|L12.1136|
0003ea  78b8              LDRB     r0,[r7,#2]  ; RxBuffer
0003ec  2877              CMP      r0,#0x77
0003ee  d07d              BEQ      |L12.1260|
0003f0  2000              MOVS     r0,#0
                  |L12.1010|
0003f2  78f9              LDRB     r1,[r7,#3]  ; RxBuffer
0003f4  2968              CMP      r1,#0x68
0003f6  d07a              BEQ      |L12.1262|
0003f8  2100              MOVS     r1,#0
                  |L12.1018|
0003fa  4008              ANDS     r0,r0,r1
0003fc  7939              LDRB     r1,[r7,#4]  ; RxBuffer
0003fe  e04e              B        |L12.1182|
                  |L12.1024|
                          DCD      0x40020810
                  |L12.1028|
                          DCD      kol_pribl_vkl
                  |L12.1032|
                          DCD      kol_pribl_vikl
                  |L12.1036|
                          DCD      conf
                  |L12.1040|
                          DCD      0x40020000
                  |L12.1044|
                          DCD      sost_pribl
                  |L12.1048|
                          DCD      kol_gr1_vkl
                  |L12.1052|
                          DCD      kol_gr2_vkl
                  |L12.1056|
                          DCD      ||fz||
                  |L12.1060|
                          DCD      summa
                  |L12.1064|
                          DCD      ADC3ConvertedValue
                  |L12.1068|
                          DCD      kol_average
                  |L12.1072|
                          DCD      average
                  |L12.1076|
                          DCD      fz_average
                  |L12.1080|
                          DCD      ||.data||
                  |L12.1084|
                          DCD      max
                  |L12.1088|
                          DCD      number_buff
                  |L12.1092|
                          DCD      por
                  |L12.1096|
                          DCD      Buf_adc_zap2
                  |L12.1100|
                          DCD      Buf_adc_zap1
                  |L12.1104|
                          DCD      ||del||
                  |L12.1108|
                          DCD      tick
                  |L12.1112|
                          DCD      time_label
                  |L12.1116|
                          DCD      DT_zap
                  |L12.1120|
                          DCD      buffering
                  |L12.1124|
                          DCD      avariya
                  |L12.1128|
                          DCD      minute
                  |L12.1132|
                          DCD      new_komand
                  |L12.1136|
                          DCD      RxBuffer
                  |L12.1140|
                          DCD      tekper
                  |L12.1144|
                          DCD      0x40004400
                  |L12.1148|
                          DCD      TxBuffer
                  |L12.1152|
                          DCD      txsize
                  |L12.1156|
                          DCD      0x40020c00
                  |L12.1160|
                          DCD      tmp1
                  |L12.1164|
                          DCD      tmp2
                  |L12.1168|
                          DCD      tmp3
                  |L12.1172|
                          DCD      0x40024000
                  |L12.1176|
                          DCD      rxsize
                  |L12.1180|
00049c  e2dc              B        |L12.2648|
                  |L12.1182|
00049e  296f              CMP      r1,#0x6f
0004a0  d07e              BEQ      |L12.1440|
0004a2  2100              MOVS     r1,#0
                  |L12.1188|
0004a4  4008              ANDS     r0,r0,r1
0004a6  7979              LDRB     r1,[r7,#5]  ; RxBuffer
0004a8  293f              CMP      r1,#0x3f
0004aa  d07a              BEQ      |L12.1442|
0004ac  2100              MOVS     r1,#0
                  |L12.1198|
0004ae  4208              TST      r0,r1
;;;600    		{
;;;601    			
;;;602    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
;;;603    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
;;;604    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
;;;605    			
;;;606    			TxBuffer[0]='u';
;;;607    			TxBuffer[1]='s';	
0004b0  f04f0873          MOV      r8,#0x73
0004b4  d031              BEQ      |L12.1306|
0004b6  2200              MOVS     r2,#0                 ;602
0004b8  f2405125          MOV      r1,#0x525             ;602
0004bc  4648              MOV      r0,r9                 ;602
0004be  f7fffffe          BL       USART_ITConfig
0004c2  2201              MOVS     r2,#1                 ;603
0004c4  f2406126          MOV      r1,#0x626             ;603
0004c8  4648              MOV      r0,r9                 ;603
0004ca  f7fffffe          BL       USART_ITConfig
0004ce  2201              MOVS     r2,#1                 ;604
0004d0  2108              MOVS     r1,#8                 ;604
0004d2  48fe              LDR      r0,|L12.2252|
0004d4  f7fffffe          BL       GPIO_WriteBit
0004d8  2075              MOVS     r0,#0x75              ;606
0004da  7020              STRB     r0,[r4,#0]            ;606
0004dc  f8848001          STRB     r8,[r4,#1]
;;;608    			TxBuffer[2]='o';
0004e0  206f              MOVS     r0,#0x6f
0004e2  70a0              STRB     r0,[r4,#2]
;;;609    			TxBuffer[3]='_';					
0004e4  215f              MOVS     r1,#0x5f
0004e6  70e1              STRB     r1,[r4,#3]
;;;610    			TxBuffer[4]='a';		
0004e8  2061              MOVS     r0,#0x61
0004ea  e001              B        |L12.1264|
                  |L12.1260|
0004ec  e2c2              B        |L12.2676|
                  |L12.1262|
0004ee  e2c3              B        |L12.2680|
                  |L12.1264|
0004f0  7120              STRB     r0,[r4,#4]
;;;611    			TxBuffer[5]='r';	
0004f2  2072              MOVS     r0,#0x72
0004f4  7160              STRB     r0,[r4,#5]
;;;612    			TxBuffer[6]='m';	
0004f6  206d              MOVS     r0,#0x6d
0004f8  71a0              STRB     r0,[r4,#6]
;;;613    			TxBuffer[7]='_';	
0004fa  71e1              STRB     r1,[r4,#7]
;;;614    			TxBuffer[8]='k';	
0004fc  206b              MOVS     r0,#0x6b
0004fe  7220              STRB     r0,[r4,#8]
;;;615    			TxBuffer[9]='e';
000500  2065              MOVS     r0,#0x65
000502  7260              STRB     r0,[r4,#9]
;;;616    			TxBuffer[10]='y';	
000504  2079              MOVS     r0,#0x79
000506  72a0              STRB     r0,[r4,#0xa]
;;;617    	
;;;618    			txsize=11;
000508  210b              MOVS     r1,#0xb
00050a  f8aa1000          STRH     r1,[r10,#0]
;;;619    			tekper=0;
00050e  f8ab5000          STRH     r5,[r11,#0]
;;;620    			USART_SendData(USART2, 0x3A);
000512  213a              MOVS     r1,#0x3a
000514  4648              MOV      r0,r9
000516  f7fffffe          BL       USART_SendData
                  |L12.1306|
;;;621    		}
;;;622    	
;;;623    		// restart
;;;624    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='e')&(RxBuffer[4]=='s')&(RxBuffer[5]=='t')&(RxBuffer[6]=='a')&(RxBuffer[7]=='r')&(RxBuffer[8]=='t'))
00051a  78b8              LDRB     r0,[r7,#2]  ; RxBuffer
00051c  2872              CMP      r0,#0x72
00051e  d07d              BEQ      |L12.1564|
000520  2000              MOVS     r0,#0
                  |L12.1314|
000522  78f9              LDRB     r1,[r7,#3]  ; RxBuffer
000524  2965              CMP      r1,#0x65
000526  d07a              BEQ      |L12.1566|
000528  2100              MOVS     r1,#0
                  |L12.1322|
00052a  4008              ANDS     r0,r0,r1
00052c  7939              LDRB     r1,[r7,#4]  ; RxBuffer
00052e  2973              CMP      r1,#0x73
000530  d076              BEQ      |L12.1568|
000532  2100              MOVS     r1,#0
                  |L12.1332|
000534  4008              ANDS     r0,r0,r1
000536  7979              LDRB     r1,[r7,#5]  ; RxBuffer
000538  2974              CMP      r1,#0x74
00053a  d072              BEQ      |L12.1570|
00053c  2100              MOVS     r1,#0
                  |L12.1342|
00053e  4008              ANDS     r0,r0,r1
000540  79b9              LDRB     r1,[r7,#6]  ; RxBuffer
000542  2961              CMP      r1,#0x61
000544  d06e              BEQ      |L12.1572|
000546  2100              MOVS     r1,#0
                  |L12.1352|
000548  4008              ANDS     r0,r0,r1
00054a  79f9              LDRB     r1,[r7,#7]  ; RxBuffer
00054c  2972              CMP      r1,#0x72
00054e  d06a              BEQ      |L12.1574|
000550  2100              MOVS     r1,#0
                  |L12.1362|
000552  4008              ANDS     r0,r0,r1
000554  7a39              LDRB     r1,[r7,#8]  ; RxBuffer
000556  2974              CMP      r1,#0x74
000558  d066              BEQ      |L12.1576|
00055a  2100              MOVS     r1,#0
                  |L12.1372|
00055c  4208              TST      r0,r1
00055e  d031              BEQ      |L12.1476|
;;;625    		{
;;;626    			
;;;627    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
000560  2200              MOVS     r2,#0
000562  f2405125          MOV      r1,#0x525
000566  4648              MOV      r0,r9
000568  f7fffffe          BL       USART_ITConfig
;;;628    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
00056c  2201              MOVS     r2,#1
00056e  f2406126          MOV      r1,#0x626
000572  4648              MOV      r0,r9
000574  f7fffffe          BL       USART_ITConfig
;;;629    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
000578  2201              MOVS     r2,#1
00057a  2108              MOVS     r1,#8
00057c  48d3              LDR      r0,|L12.2252|
00057e  f7fffffe          BL       GPIO_WriteBit
;;;630    			
;;;631    			TxBuffer[0]='r';
000582  2172              MOVS     r1,#0x72
000584  7021              STRB     r1,[r4,#0]
;;;632    			TxBuffer[1]='e';	
000586  2065              MOVS     r0,#0x65
000588  7060              STRB     r0,[r4,#1]
;;;633    			TxBuffer[2]='s';
00058a  f8848002          STRB     r8,[r4,#2]
;;;634    			TxBuffer[3]='t';					
00058e  2074              MOVS     r0,#0x74
000590  70e0              STRB     r0,[r4,#3]
;;;635    			TxBuffer[4]='a';		
000592  2261              MOVS     r2,#0x61
000594  7122              STRB     r2,[r4,#4]
;;;636    			TxBuffer[5]='r';	
000596  7161              STRB     r1,[r4,#5]
;;;637    			TxBuffer[6]='t';	
000598  71a0              STRB     r0,[r4,#6]
;;;638    			TxBuffer[7]='_';	
00059a  205f              MOVS     r0,#0x5f
00059c  71e0              STRB     r0,[r4,#7]
;;;639    			TxBuffer[8]='o';	
00059e  e001              B        |L12.1444|
                  |L12.1440|
0005a0  e26c              B        |L12.2684|
                  |L12.1442|
0005a2  e26d              B        |L12.2688|
                  |L12.1444|
0005a4  206f              MOVS     r0,#0x6f
0005a6  7220              STRB     r0,[r4,#8]
;;;640    			TxBuffer[9]='k';
0005a8  206b              MOVS     r0,#0x6b
0005aa  7260              STRB     r0,[r4,#9]
;;;641    	
;;;642    			txsize=10;
0005ac  210a              MOVS     r1,#0xa
0005ae  f8aa1000          STRH     r1,[r10,#0]
;;;643    			tekper=0;
0005b2  f8ab5000          STRH     r5,[r11,#0]
;;;644    			USART_SendData(USART2, 0x3A);
0005b6  213a              MOVS     r1,#0x3a
0005b8  4648              MOV      r0,r9
0005ba  f7fffffe          BL       USART_SendData
;;;645    			
;;;646    			SCB->AIRCR = 0x05FA0004;
0005be  48c5              LDR      r0,|L12.2260|
0005c0  49c3              LDR      r1,|L12.2256|
0005c2  6001              STR      r1,[r0,#0]
                  |L12.1476|
;;;647    			
;;;648    			
;;;649    			
;;;650    			// need restart
;;;651    		}
;;;652    	
;;;653    		// set_time
;;;654    		if ((RxBuffer[2]=='s')&(RxBuffer[3]=='e')&(RxBuffer[4]=='t')&(RxBuffer[5]=='_')&(RxBuffer[6]=='t')&(RxBuffer[7]=='i')&(RxBuffer[8]=='m')&(RxBuffer[9]=='e'))
0005c4  78b8              LDRB     r0,[r7,#2]  ; RxBuffer
0005c6  2873              CMP      r0,#0x73
0005c8  d07e              BEQ      |L12.1736|
0005ca  2000              MOVS     r0,#0
                  |L12.1484|
0005cc  78f9              LDRB     r1,[r7,#3]  ; RxBuffer
0005ce  2965              CMP      r1,#0x65
0005d0  d07b              BEQ      |L12.1738|
0005d2  2100              MOVS     r1,#0
                  |L12.1492|
0005d4  4008              ANDS     r0,r0,r1
0005d6  7939              LDRB     r1,[r7,#4]  ; RxBuffer
0005d8  2974              CMP      r1,#0x74
0005da  d077              BEQ      |L12.1740|
0005dc  2100              MOVS     r1,#0
                  |L12.1502|
0005de  4008              ANDS     r0,r0,r1
0005e0  7979              LDRB     r1,[r7,#5]  ; RxBuffer
0005e2  295f              CMP      r1,#0x5f
0005e4  d073              BEQ      |L12.1742|
0005e6  2100              MOVS     r1,#0
                  |L12.1512|
0005e8  4008              ANDS     r0,r0,r1
0005ea  79b9              LDRB     r1,[r7,#6]  ; RxBuffer
0005ec  2974              CMP      r1,#0x74
0005ee  d06f              BEQ      |L12.1744|
0005f0  2100              MOVS     r1,#0
                  |L12.1522|
0005f2  4008              ANDS     r0,r0,r1
0005f4  79f9              LDRB     r1,[r7,#7]  ; RxBuffer
0005f6  2969              CMP      r1,#0x69
0005f8  d06b              BEQ      |L12.1746|
0005fa  2100              MOVS     r1,#0
                  |L12.1532|
0005fc  4008              ANDS     r0,r0,r1
0005fe  7a39              LDRB     r1,[r7,#8]  ; RxBuffer
000600  296d              CMP      r1,#0x6d
000602  d067              BEQ      |L12.1748|
000604  2100              MOVS     r1,#0
                  |L12.1542|
000606  4008              ANDS     r0,r0,r1
000608  7a79              LDRB     r1,[r7,#9]  ; RxBuffer
00060a  2965              CMP      r1,#0x65
00060c  d07d              BEQ      |L12.1802|
00060e  2100              MOVS     r1,#0
                  |L12.1552|
000610  4208              TST      r0,r1
000612  d07b              BEQ      |L12.1804|
;;;655    		{		
;;;656    			extern void rtc_SetDate(uint8_t Day, uint8_t Month, uint8_t Year, uint8_t DayOfWeek);
;;;657    			extern  void rtc_SetTime(uint8_t Hours, uint8_t Minutes, uint8_t Seconds);
;;;658    			extern  void rtc_Unlock(void);
;;;659    			extern void rtc_Lock(void);
;;;660    			
;;;661    			uint32_t Tens, Units;
;;;662          uint32_t TempReg = 0;
;;;663    			u8 i=0;
;;;664    			
;;;665    			
;;;666    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
000614  2200              MOVS     r2,#0
000616  f2405125          MOV      r1,#0x525
00061a  e006              B        |L12.1578|
                  |L12.1564|
00061c  e232              B        |L12.2692|
                  |L12.1566|
00061e  e233              B        |L12.2696|
                  |L12.1568|
000620  e234              B        |L12.2700|
                  |L12.1570|
000622  e235              B        |L12.2704|
                  |L12.1572|
000624  e236              B        |L12.2708|
                  |L12.1574|
000626  e237              B        |L12.2712|
                  |L12.1576|
000628  e238              B        |L12.2716|
                  |L12.1578|
00062a  4648              MOV      r0,r9
00062c  f7fffffe          BL       USART_ITConfig
;;;667    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
000630  2201              MOVS     r2,#1
000632  f2406126          MOV      r1,#0x626
000636  4648              MOV      r0,r9
000638  f7fffffe          BL       USART_ITConfig
;;;668    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
00063c  2201              MOVS     r2,#1
00063e  2108              MOVS     r1,#8
000640  48a2              LDR      r0,|L12.2252|
000642  f7fffffe          BL       GPIO_WriteBit
;;;669    
;;;670    
;;;671    			// set time
;;;672    		rtc_Unlock();
000646  f7fffffe          BL       rtc_Unlock
;;;673    		RTC->ISR |= RTC_ISR_INIT;
00064a  48a3              LDR      r0,|L12.2264|
00064c  6801              LDR      r1,[r0,#0]
00064e  f0410180          ORR      r1,r1,#0x80
000652  6001              STR      r1,[r0,#0]
                  |L12.1620|
;;;674    		while(!(RTC->ISR & RTC_ISR_INITF)) {}
000654  48a0              LDR      r0,|L12.2264|
000656  6800              LDR      r0,[r0,#0]
000658  0640              LSLS     r0,r0,#25
00065a  d5fb              BPL      |L12.1620|
;;;675    
;;;676    		RTC->PRER = 263; //Sync;         
00065c  489e              LDR      r0,|L12.2264|
00065e  f2401107          MOV      r1,#0x107
000662  1d00              ADDS     r0,r0,#4
000664  6001              STR      r1,[r0,#0]
;;;677        RTC->PRER =263 | (127<<16); //Sync | (Async << 16);
000666  499d              LDR      r1,|L12.2268|
000668  6001              STR      r1,[r0,#0]
;;;678    			
;;;679    			
;;;680    			TxBuffer[0]='s';
00066a  f8848000          STRB     r8,[r4,#0]
;;;681    			TxBuffer[1]='e';	
00066e  2265              MOVS     r2,#0x65
000670  7062              STRB     r2,[r4,#1]
;;;682    			TxBuffer[2]='t';
000672  2174              MOVS     r1,#0x74
000674  70a1              STRB     r1,[r4,#2]
;;;683    			TxBuffer[3]='_';					
000676  205f              MOVS     r0,#0x5f
000678  70e0              STRB     r0,[r4,#3]
;;;684    			TxBuffer[4]='t';		
00067a  7121              STRB     r1,[r4,#4]
;;;685    			TxBuffer[5]='i';	
00067c  2169              MOVS     r1,#0x69
00067e  7161              STRB     r1,[r4,#5]
;;;686    			TxBuffer[6]='m';	
000680  216d              MOVS     r1,#0x6d
000682  71a1              STRB     r1,[r4,#6]
;;;687    			TxBuffer[7]='e';	
000684  71e2              STRB     r2,[r4,#7]
;;;688    			TxBuffer[8]='_';	
000686  7220              STRB     r0,[r4,#8]
;;;689    			TxBuffer[9]='o';
000688  206f              MOVS     r0,#0x6f
00068a  7260              STRB     r0,[r4,#9]
;;;690    			TxBuffer[10]='k';
00068c  206b              MOVS     r0,#0x6b
00068e  72a0              STRB     r0,[r4,#0xa]
;;;691    			
;;;692    
;;;693        // set time
;;;694    rtc_SetTime((RxBuffer[16]-0x30)*10+(RxBuffer[17]-0x30), (RxBuffer[18]-0x30)*10+(RxBuffer[19]-0x30), (RxBuffer[20]-0x30)*10+(RxBuffer[21]-0x30));
000690  7d38              LDRB     r0,[r7,#0x14]  ; RxBuffer
000692  7d79              LDRB     r1,[r7,#0x15]  ; RxBuffer
000694  3830              SUBS     r0,r0,#0x30
000696  eb000280          ADD      r2,r0,r0,LSL #2
00069a  f06f082f          MVN      r8,#0x2f
00069e  eb080042          ADD      r0,r8,r2,LSL #1
0006a2  4408              ADD      r0,r0,r1
0006a4  b2c2              UXTB     r2,r0
0006a6  7cb8              LDRB     r0,[r7,#0x12]  ; RxBuffer
0006a8  7cf9              LDRB     r1,[r7,#0x13]  ; RxBuffer
0006aa  3830              SUBS     r0,r0,#0x30
0006ac  eb000380          ADD      r3,r0,r0,LSL #2
0006b0  eb080043          ADD      r0,r8,r3,LSL #1
0006b4  4408              ADD      r0,r0,r1
0006b6  b2c1              UXTB     r1,r0
0006b8  7c38              LDRB     r0,[r7,#0x10]  ; RxBuffer
0006ba  7c7b              LDRB     r3,[r7,#0x11]  ; RxBuffer
0006bc  3830              SUBS     r0,r0,#0x30
0006be  eb000c80          ADD      r12,r0,r0,LSL #2
0006c2  eb08004c          ADD      r0,r8,r12,LSL #1
0006c6  e006              B        |L12.1750|
                  |L12.1736|
0006c8  e1ea              B        |L12.2720|
                  |L12.1738|
0006ca  e1eb              B        |L12.2724|
                  |L12.1740|
0006cc  e1ec              B        |L12.2728|
                  |L12.1742|
0006ce  e1f0              B        |L12.2738|
                  |L12.1744|
0006d0  e1f1              B        |L12.2742|
                  |L12.1746|
0006d2  e1f2              B        |L12.2746|
                  |L12.1748|
0006d4  e1f3              B        |L12.2750|
                  |L12.1750|
0006d6  4418              ADD      r0,r0,r3
0006d8  b2c0              UXTB     r0,r0
0006da  f7fffffe          BL       rtc_SetTime
;;;695    
;;;696    rtc_SetDate((RxBuffer[10]-0x30)*10+(RxBuffer[11]-0x30), (RxBuffer[12]-0x30)*10+(RxBuffer[13]-0x30), (RxBuffer[14]-0x30)*10+(RxBuffer[15]-0x30),1);
0006de  7bb8              LDRB     r0,[r7,#0xe]  ; RxBuffer
0006e0  7bf9              LDRB     r1,[r7,#0xf]  ; RxBuffer
0006e2  3830              SUBS     r0,r0,#0x30
0006e4  eb000280          ADD      r2,r0,r0,LSL #2
0006e8  eb080042          ADD      r0,r8,r2,LSL #1
0006ec  4408              ADD      r0,r0,r1
0006ee  b2c2              UXTB     r2,r0
0006f0  7b38              LDRB     r0,[r7,#0xc]  ; RxBuffer
0006f2  7b79              LDRB     r1,[r7,#0xd]  ; RxBuffer
0006f4  3830              SUBS     r0,r0,#0x30
0006f6  eb000380          ADD      r3,r0,r0,LSL #2
0006fa  eb080043          ADD      r0,r8,r3,LSL #1
0006fe  4408              ADD      r0,r0,r1
000700  b2c1              UXTB     r1,r0
000702  7ab8              LDRB     r0,[r7,#0xa]  ; RxBuffer
000704  7afb              LDRB     r3,[r7,#0xb]  ; RxBuffer
000706  3830              SUBS     r0,r0,#0x30
000708  e001              B        |L12.1806|
                  |L12.1802|
00070a  e1da              B        |L12.2754|
                  |L12.1804|
00070c  e02d              B        |L12.1898|
                  |L12.1806|
00070e  eb000c80          ADD      r12,r0,r0,LSL #2
000712  eb08004c          ADD      r0,r8,r12,LSL #1
000716  4418              ADD      r0,r0,r3
000718  b2c0              UXTB     r0,r0
00071a  2301              MOVS     r3,#1
00071c  f7fffffe          BL       rtc_SetDate
;;;697    /*
;;;698    if (1)
;;;699    {
;;;700    
;;;701        TempReg = 0;
;;;702        {
;;;703            Tens  = ((RxBuffer[10]-0x30) / 10) & 0x0f;          // ??????? ???
;;;704            Units = (RxBuffer[11]-0x30) & 0x0f; // ??????? ???
;;;705            
;;;706            TempReg |= (Tens  << 20); // YT, 20
;;;707            TempReg |= (Units << 16); // YU, 16
;;;708        }
;;;709        {
;;;710            Tens  = (RxBuffer[12]-0x30) & 0x01;          // ??????? ???????
;;;711            Units = (RxBuffer[13]-0x30) & 0x0f; // ??????? ???????
;;;712            
;;;713            TempReg |= (Tens  << 12); // MT, 12
;;;714            TempReg |= (Units << 8);  // MU, 8
;;;715        }
;;;716        {
;;;717            Tens  = (RxBuffer[14]-0x30) & 0x03;          // ??????? ????
;;;718            Units = (RxBuffer[15]-0x30) & 0x0f; // ??????? ????
;;;719            
;;;720            TempReg |= (Tens  << 4); // DT, 4
;;;721            TempReg |= (Units << 0);  // DU, 0
;;;722        }
;;;723        {
;;;724            TempReg |= ((1 & 0x07) << 13); // WDU, 13
;;;725        }
;;;726        RTC->DR = TempReg;	
;;;727    	}	
;;;728    */
;;;729    		RTC->CR |= RTC_CR_FMT;
000720  486d              LDR      r0,|L12.2264|
000722  1f00              SUBS     r0,r0,#4
000724  6801              LDR      r1,[r0,#0]
000726  f0410140          ORR      r1,r1,#0x40
00072a  6001              STR      r1,[r0,#0]
;;;730        RTC->ISR &= ~RTC_ISR_INIT;
00072c  1d00              ADDS     r0,r0,#4
00072e  6801              LDR      r1,[r0,#0]
000730  f0210180          BIC      r1,r1,#0x80
000734  6001              STR      r1,[r0,#0]
;;;731    		rtc_Lock();
000736  f7fffffe          BL       rtc_Lock
                  |L12.1850|
;;;732    
;;;733    	
;;;734    		rtc_Get(&DT1);
;;;735    //			while (TempReg!=RTC->DR)
;;;736    		while (((RxBuffer[10]-0x30)*10+(RxBuffer[11]-0x30))!=DT1.Day)
;;;737    				rtc_Get(&DT1);
00073a  4869              LDR      r0,|L12.2272|
00073c  f7fffffe          BL       rtc_Get
000740  7ab8              LDRB     r0,[r7,#0xa]          ;736  ; RxBuffer
000742  7af9              LDRB     r1,[r7,#0xb]          ;736  ; RxBuffer
000744  3830              SUBS     r0,r0,#0x30           ;736
000746  eb000280          ADD      r2,r0,r0,LSL #2       ;736
00074a  eb080042          ADD      r0,r8,r2,LSL #1       ;736
00074e  4401              ADD      r1,r1,r0              ;736
000750  4863              LDR      r0,|L12.2272|
000752  7880              LDRB     r0,[r0,#2]            ;736  ; DT1
000754  4281              CMP      r1,r0                 ;736
000756  d1f0              BNE      |L12.1850|
;;;738    
;;;739    				
;;;740    			txsize=11;
000758  200b              MOVS     r0,#0xb
00075a  f8aa0000          STRH     r0,[r10,#0]
;;;741    			tekper=0;
00075e  f8ab5000          STRH     r5,[r11,#0]
;;;742    			USART_SendData(USART2, 0x3A);
000762  213a              MOVS     r1,#0x3a
000764  4648              MOV      r0,r9
000766  f7fffffe          BL       USART_SendData
                  |L12.1898|
;;;743    			
;;;744    			// need restart
;;;745    		}
;;;746    		
;;;747    		// read
;;;748    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='e')&(RxBuffer[4]=='a')&(RxBuffer[5]=='d'))
00076a  78b8              LDRB     r0,[r7,#2]  ; RxBuffer
00076c  2872              CMP      r0,#0x72
00076e  d07d              BEQ      |L12.2156|
000770  2000              MOVS     r0,#0
                  |L12.1906|
000772  78f9              LDRB     r1,[r7,#3]  ; RxBuffer
000774  2965              CMP      r1,#0x65
000776  d07a              BEQ      |L12.2158|
000778  2100              MOVS     r1,#0
                  |L12.1914|
00077a  4008              ANDS     r0,r0,r1
00077c  7939              LDRB     r1,[r7,#4]  ; RxBuffer
00077e  2961              CMP      r1,#0x61
000780  d076              BEQ      |L12.2160|
000782  2100              MOVS     r1,#0
                  |L12.1924|
000784  4008              ANDS     r0,r0,r1
000786  4957              LDR      r1,|L12.2276|
000788  7949              LDRB     r1,[r1,#5]  ; RxBuffer
00078a  2964              CMP      r1,#0x64
00078c  d071              BEQ      |L12.2162|
00078e  2100              MOVS     r1,#0
                  |L12.1936|
000790  4208              TST      r0,r1
000792  d06f              BEQ      |L12.2164|
;;;749    		{
;;;750    			
;;;751    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
000794  2200              MOVS     r2,#0
000796  f2405125          MOV      r1,#0x525
00079a  4648              MOV      r0,r9
00079c  f7fffffe          BL       USART_ITConfig
;;;752    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
0007a0  2201              MOVS     r2,#1
0007a2  f2406126          MOV      r1,#0x626
0007a6  4648              MOV      r0,r9
0007a8  f7fffffe          BL       USART_ITConfig
;;;753    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
0007ac  2201              MOVS     r2,#1
0007ae  2108              MOVS     r1,#8
0007b0  4846              LDR      r0,|L12.2252|
0007b2  f7fffffe          BL       GPIO_WriteBit
;;;754    			
;;;755    			// test zapis for controlling time on fleshka
;;;756    			tmp=por;
0007b6  484c              LDR      r0,|L12.2280|
;;;757    			TxBuffer[0]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
0007b8  f44f727a          MOV      r2,#0x3e8
;;;758    			tmp%=1000;
;;;759    			TxBuffer[1]=(uint8_t)(tmp/100)+(uint8_t)0x30;
;;;760    			tmp%=100;		
;;;761    			TxBuffer[2]=(uint8_t)(tmp/10)+(uint8_t)0x30;
;;;762    			tmp%=10;	
;;;763    			TxBuffer[3]=(uint8_t)(tmp)+(uint8_t)0x30;		
;;;764    				
;;;765    			TxBuffer[4]=0x20;	
;;;766    
;;;767    			// date
;;;768    			TxBuffer[5]=(uint8_t)(DT1.Year/10)+(uint8_t)0x30;	
0007bc  f8df8120          LDR      r8,|L12.2272|
0007c0  8800              LDRH     r0,[r0,#0]            ;756  ; por
0007c2  fbb0f1f2          UDIV     r1,r0,r2              ;757
0007c6  f1010330          ADD      r3,r1,#0x30           ;757
0007ca  7023              STRB     r3,[r4,#0]            ;757
0007cc  fb020011          MLS      r0,r2,r1,r0           ;758
0007d0  2364              MOVS     r3,#0x64              ;759
0007d2  fbb0f1f3          UDIV     r1,r0,r3              ;759
0007d6  f1010730          ADD      r7,r1,#0x30           ;759
0007da  fb030111          MLS      r1,r3,r1,r0           ;760
0007de  7067              STRB     r7,[r4,#1]            ;759
0007e0  200a              MOVS     r0,#0xa               ;761
0007e2  fbb1f7f0          UDIV     r7,r1,r0              ;761
0007e6  fb001117          MLS      r1,r0,r7,r1           ;762
0007ea  f1070c30          ADD      r12,r7,#0x30          ;761
0007ee  f884c002          STRB     r12,[r4,#2]           ;761
0007f2  3130              ADDS     r1,r1,#0x30           ;763
0007f4  70e1              STRB     r1,[r4,#3]            ;763
0007f6  2120              MOVS     r1,#0x20              ;765
0007f8  7121              STRB     r1,[r4,#4]            ;765
0007fa  f898c000          LDRB     r12,[r8,#0]  ; DT1
0007fe  fbbcfef0          UDIV     lr,r12,r0
000802  f10e0730          ADD      r7,lr,#0x30
000806  7167              STRB     r7,[r4,#5]
;;;769    			TxBuffer[6]=(uint8_t)(DT1.Year%10)+(uint8_t)0x30;	
000808  fb00c71e          MLS      r7,r0,lr,r12
00080c  3730              ADDS     r7,r7,#0x30
00080e  71a7              STRB     r7,[r4,#6]
;;;770    			TxBuffer[7]=(uint8_t)(DT1.Month/10)+(uint8_t)0x30;	
000810  f898c001          LDRB     r12,[r8,#1]  ; DT1
000814  fbbcfef0          UDIV     lr,r12,r0
000818  f10e0730          ADD      r7,lr,#0x30
00081c  71e7              STRB     r7,[r4,#7]
;;;771    			TxBuffer[8]=(uint8_t)(DT1.Month%10)+(uint8_t)0x30;	
00081e  fb00c71e          MLS      r7,r0,lr,r12
000822  3730              ADDS     r7,r7,#0x30
000824  7227              STRB     r7,[r4,#8]
;;;772    			TxBuffer[9]=(uint8_t)(DT1.Day/10)+(uint8_t)0x30;	
000826  f898c002          LDRB     r12,[r8,#2]  ; DT1
00082a  fbbcfef0          UDIV     lr,r12,r0
00082e  f10e0730          ADD      r7,lr,#0x30
000832  7267              STRB     r7,[r4,#9]
;;;773    			TxBuffer[10]=(uint8_t)(DT1.Day%10)+(uint8_t)0x30;	
000834  fb00c71e          MLS      r7,r0,lr,r12
000838  3730              ADDS     r7,r7,#0x30
00083a  72a7              STRB     r7,[r4,#0xa]
;;;774    			TxBuffer[11]=0x20;				
00083c  72e1              STRB     r1,[r4,#0xb]
;;;775    			
;;;776    			// time
;;;777    			TxBuffer[12]=(uint8_t)(DT1.Hours/10)+(uint8_t)0x30;	
00083e  f898c004          LDRB     r12,[r8,#4]  ; DT1
000842  fbbcfef0          UDIV     lr,r12,r0
000846  f10e0730          ADD      r7,lr,#0x30
00084a  7327              STRB     r7,[r4,#0xc]
;;;778    			TxBuffer[13]=(uint8_t)(DT1.Hours%10)+(uint8_t)0x30;			
00084c  fb00c71e          MLS      r7,r0,lr,r12
000850  3730              ADDS     r7,r7,#0x30
000852  7367              STRB     r7,[r4,#0xd]
;;;779    			TxBuffer[14]=(uint8_t)(DT1.Minutes/10)+(uint8_t)0x30;	
000854  f898c005          LDRB     r12,[r8,#5]  ; DT1
000858  fbbcfef0          UDIV     lr,r12,r0
00085c  f10e0730          ADD      r7,lr,#0x30
000860  73a7              STRB     r7,[r4,#0xe]
;;;780    			TxBuffer[15]=(uint8_t)(DT1.Minutes%10)+(uint8_t)0x30;	
000862  fb00c71e          MLS      r7,r0,lr,r12
000866  3730              ADDS     r7,r7,#0x30
000868  73e7              STRB     r7,[r4,#0xf]
;;;781    			TxBuffer[16]=(uint8_t)(DT1.Seconds/10)+(uint8_t)0x30;	
00086a  e004              B        |L12.2166|
                  |L12.2156|
00086c  e12e              B        |L12.2764|
                  |L12.2158|
00086e  e12f              B        |L12.2768|
                  |L12.2160|
000870  e130              B        |L12.2772|
                  |L12.2162|
000872  e131              B        |L12.2776|
                  |L12.2164|
000874  e0a5              B        |L12.2498|
                  |L12.2166|
000876  f898c006          LDRB     r12,[r8,#6]  ; DT1
00087a  fbbcf8f0          UDIV     r8,r12,r0
00087e  f1080730          ADD      r7,r8,#0x30
000882  7427              STRB     r7,[r4,#0x10]
;;;782    			TxBuffer[17]=(uint8_t)(DT1.Seconds%10)+(uint8_t)0x30;	
000884  fb00c718          MLS      r7,r0,r8,r12
000888  3730              ADDS     r7,r7,#0x30
00088a  7467              STRB     r7,[r4,#0x11]
;;;783    			TxBuffer[18]=0x20;
00088c  74a1              STRB     r1,[r4,#0x12]
;;;784    			
;;;785    			// dat pribl
;;;786    			TxBuffer[19]=sost_pribl+0x30;
00088e  7836              LDRB     r6,[r6,#0]  ; sost_pribl
000890  3630              ADDS     r6,r6,#0x30
000892  74e6              STRB     r6,[r4,#0x13]
;;;787    			TxBuffer[20]=0x20;
;;;788    			
;;;789    			
;;;790    			// zn from adc with calibr and averaging
;;;791    			tmp=ADC3ConvertedValue%10000;
000894  4e15              LDR      r6,|L12.2284|
000896  7521              STRB     r1,[r4,#0x14]         ;787
000898  8836              LDRH     r6,[r6,#0]  ; ADC3ConvertedValue
00089a  f2427710          MOV      r7,#0x2710
00089e  fbb6fcf7          UDIV     r12,r6,r7
0008a2  fb07661c          MLS      r6,r7,r12,r6
;;;792    			TxBuffer[21]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
0008a6  fbb6f8f2          UDIV     r8,r6,r2
0008aa  f1080c30          ADD      r12,r8,#0x30
;;;793    			tmp%=1000;
0008ae  fb026618          MLS      r6,r2,r8,r6
;;;794    			TxBuffer[22]=(uint8_t)(tmp/100)+(uint8_t)0x30;
0008b2  fbb6f8f3          UDIV     r8,r6,r3
0008b6  f884c015          STRB     r12,[r4,#0x15]        ;792
0008ba  f1080c30          ADD      r12,r8,#0x30
;;;795    			tmp%=100;		
0008be  fb036618          MLS      r6,r3,r8,r6
;;;796    			TxBuffer[23]=(uint8_t)(tmp/10)+(uint8_t)0x30;
0008c2  fbb6f8f0          UDIV     r8,r6,r0
0008c6  f884c016          STRB     r12,[r4,#0x16]        ;794
0008ca  e011              B        |L12.2288|
                  |L12.2252|
                          DCD      0x40020c00
                  |L12.2256|
                          DCD      0x05fa0004
                  |L12.2260|
                          DCD      0xe000ed0c
                  |L12.2264|
                          DCD      0x4000280c
                  |L12.2268|
                          DCD      0x007f0107
                  |L12.2272|
                          DCD      ||.data||+0xc
                  |L12.2276|
                          DCD      RxBuffer
                  |L12.2280|
                          DCD      por
                  |L12.2284|
                          DCD      ADC3ConvertedValue
                  |L12.2288|
;;;797    			tmp%=10;	
0008f0  fb006618          MLS      r6,r0,r8,r6
0008f4  f1080c30          ADD      r12,r8,#0x30
0008f8  f884c017          STRB     r12,[r4,#0x17]        ;796
;;;798    			TxBuffer[24]=(uint8_t)(tmp)+(uint8_t)0x30;
0008fc  3630              ADDS     r6,r6,#0x30
0008fe  7626              STRB     r6,[r4,#0x18]
;;;799    			TxBuffer[25]=0x20;		
;;;800    			
;;;801    			tmp=fz_average[0]%10000;
000900  4e7e              LDR      r6,|L12.2812|
000902  7661              STRB     r1,[r4,#0x19]         ;799
000904  8836              LDRH     r6,[r6,#0]  ; fz_average
000906  fbb6fcf7          UDIV     r12,r6,r7
00090a  fb07661c          MLS      r6,r7,r12,r6
;;;802    			TxBuffer[26]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
00090e  fbb6f8f2          UDIV     r8,r6,r2
000912  f1080c30          ADD      r12,r8,#0x30
;;;803    			tmp%=1000;
000916  fb026618          MLS      r6,r2,r8,r6
;;;804    			TxBuffer[27]=(uint8_t)(tmp/100)+(uint8_t)0x30;
00091a  fbb6f8f3          UDIV     r8,r6,r3
00091e  f884c01a          STRB     r12,[r4,#0x1a]        ;802
000922  f1080c30          ADD      r12,r8,#0x30
;;;805    			tmp%=100;		
000926  fb036618          MLS      r6,r3,r8,r6
;;;806    			TxBuffer[28]=(uint8_t)(tmp/10)+(uint8_t)0x30;
00092a  fbb6f8f0          UDIV     r8,r6,r0
00092e  f884c01b          STRB     r12,[r4,#0x1b]        ;804
;;;807    			tmp%=10;	
000932  fb006618          MLS      r6,r0,r8,r6
000936  f1080c30          ADD      r12,r8,#0x30          ;806
00093a  f884c01c          STRB     r12,[r4,#0x1c]        ;806
;;;808    			TxBuffer[29]=(uint8_t)(tmp)+(uint8_t)0x30;		
00093e  3630              ADDS     r6,r6,#0x30
000940  7766              STRB     r6,[r4,#0x1d]
;;;809    			TxBuffer[30]=0x20;
;;;810    			
;;;811    			tmp=max[0]%10000;
000942  4e6f              LDR      r6,|L12.2816|
000944  77a1              STRB     r1,[r4,#0x1e]         ;809
000946  8836              LDRH     r6,[r6,#0]  ; max
000948  fbb6fcf7          UDIV     r12,r6,r7
00094c  fb07661c          MLS      r6,r7,r12,r6
;;;812    			TxBuffer[31]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
000950  fbb6f7f2          UDIV     r7,r6,r2
;;;813    			tmp%=1000;
000954  fb026217          MLS      r2,r2,r7,r6
;;;814    			TxBuffer[32]=(uint8_t)(tmp/100)+(uint8_t)0x30;
000958  fbb2f6f3          UDIV     r6,r2,r3
;;;815    			tmp%=100;		
00095c  fb032216          MLS      r2,r3,r6,r2
;;;816    			TxBuffer[33]=(uint8_t)(tmp/10)+(uint8_t)0x30;
000960  fbb2f3f0          UDIV     r3,r2,r0
000964  f1070c30          ADD      r12,r7,#0x30          ;812
000968  f1060730          ADD      r7,r6,#0x30           ;814
00096c  f884c01f          STRB     r12,[r4,#0x1f]        ;812
;;;817    			tmp%=10;	
000970  fb002013          MLS      r0,r0,r3,r2
000974  f8847020          STRB     r7,[r4,#0x20]         ;814
000978  f1030630          ADD      r6,r3,#0x30           ;816
00097c  f8846021          STRB     r6,[r4,#0x21]         ;816
;;;818    			TxBuffer[34]=(uint8_t)(tmp)+(uint8_t)0x30;		
000980  3030              ADDS     r0,r0,#0x30
000982  f8840022          STRB     r0,[r4,#0x22]
;;;819    
;;;820    			TxBuffer[35]=0x20;
;;;821    			TxBuffer[36]=(uint8_t)(avariya)+(uint8_t)0x30;	
000986  485f              LDR      r0,|L12.2820|
000988  f8841023          STRB     r1,[r4,#0x23]         ;820
00098c  7800              LDRB     r0,[r0,#0]  ; avariya
00098e  3030              ADDS     r0,r0,#0x30
000990  f8840024          STRB     r0,[r4,#0x24]
;;;822    
;;;823    			TxBuffer[37]=0x20;
;;;824    			TxBuffer[38]=(uint8_t)(sost_flesh)+(uint8_t)0x30;
000994  485c              LDR      r0,|L12.2824|
000996  f8841025          STRB     r1,[r4,#0x25]         ;823
00099a  7800              LDRB     r0,[r0,#0]  ; sost_flesh
00099c  3030              ADDS     r0,r0,#0x30
00099e  f8840026          STRB     r0,[r4,#0x26]
;;;825    			
;;;826    			TxBuffer[39]=0x20;
;;;827    			TxBuffer[40]=(uint8_t)(conf.tek_gr_kal)+(uint8_t)0x30;
0009a2  485a              LDR      r0,|L12.2828|
0009a4  f8841027          STRB     r1,[r4,#0x27]         ;826
;;;828    		/*
;;;829         + need:
;;;830    			1 avariya   
;;;831    			2 zapis norm or error  
;;;832    			3 tek gr kal
;;;833    */
;;;834    			txsize=41;
0009a8  2129              MOVS     r1,#0x29
0009aa  78c0              LDRB     r0,[r0,#3]            ;827  ; conf
0009ac  3030              ADDS     r0,r0,#0x30           ;827
0009ae  f8840028          STRB     r0,[r4,#0x28]         ;827
0009b2  f8aa1000          STRH     r1,[r10,#0]
;;;835    			tekper=0;
0009b6  f8ab5000          STRH     r5,[r11,#0]
;;;836    			USART_SendData(USART2, 0x3A);
0009ba  213a              MOVS     r1,#0x3a
0009bc  4648              MOV      r0,r9
0009be  f7fffffe          BL       USART_SendData
                  |L12.2498|
;;;837    		}		
;;;838    		
;;;839    		// read_conf
;;;840    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='d')&(RxBuffer[4]=='_')&(RxBuffer[5]=='c')&(RxBuffer[6]=='o')&(RxBuffer[7]=='n')&(RxBuffer[8]=='f'))
0009c2  4a53              LDR      r2,|L12.2832|
0009c4  7890              LDRB     r0,[r2,#2]  ; RxBuffer
0009c6  2872              CMP      r0,#0x72
0009c8  d070              BEQ      |L12.2732|
0009ca  2000              MOVS     r0,#0
                  |L12.2508|
0009cc  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
0009ce  2964              CMP      r1,#0x64
0009d0  d06d              BEQ      |L12.2734|
0009d2  2100              MOVS     r1,#0
                  |L12.2516|
0009d4  4008              ANDS     r0,r0,r1
0009d6  7911              LDRB     r1,[r2,#4]  ; RxBuffer
0009d8  295f              CMP      r1,#0x5f
0009da  d069              BEQ      |L12.2736|
0009dc  2100              MOVS     r1,#0
                  |L12.2526|
0009de  4008              ANDS     r0,r0,r1
0009e0  7951              LDRB     r1,[r2,#5]  ; RxBuffer
0009e2  2963              CMP      r1,#0x63
0009e4  d06f              BEQ      |L12.2758|
0009e6  2100              MOVS     r1,#0
                  |L12.2536|
0009e8  4008              ANDS     r0,r0,r1
0009ea  7991              LDRB     r1,[r2,#6]  ; RxBuffer
0009ec  296f              CMP      r1,#0x6f
0009ee  d07e              BEQ      |L12.2798|
0009f0  2100              MOVS     r1,#0
                  |L12.2546|
0009f2  4008              ANDS     r0,r0,r1
0009f4  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
0009f6  296e              CMP      r1,#0x6e
0009f8  d07b              BEQ      |L12.2802|
0009fa  2100              MOVS     r1,#0
                  |L12.2556|
0009fc  4008              ANDS     r0,r0,r1
0009fe  7a11              LDRB     r1,[r2,#8]  ; RxBuffer
000a00  2966              CMP      r1,#0x66
000a02  d078              BEQ      |L12.2806|
000a04  2100              MOVS     r1,#0
                  |L12.2566|
000a06  4208              TST      r0,r1
000a08  d022              BEQ      |L12.2640|
;;;841    		{
;;;842    			u16 i=0;
000a0a  2600              MOVS     r6,#0
;;;843    			extern st_conf conf;		
;;;844    			
;;;845    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
000a0c  4632              MOV      r2,r6
000a0e  f2405125          MOV      r1,#0x525
000a12  464f              MOV      r7,r9
000a14  4648              MOV      r0,r9
000a16  f7fffffe          BL       USART_ITConfig
;;;846    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
000a1a  2201              MOVS     r2,#1
000a1c  f2406126          MOV      r1,#0x626
000a20  4638              MOV      r0,r7
000a22  f7fffffe          BL       USART_ITConfig
;;;847    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
000a26  2201              MOVS     r2,#1
000a28  2108              MOVS     r1,#8
000a2a  483a              LDR      r0,|L12.2836|
000a2c  f7fffffe          BL       GPIO_WriteBit
;;;848    /*
;;;849    		u8 address;
;;;850    		u8 ver_po_st;
;;;851    		u8 ver_po_ml;
;;;852    	  u8 tek_gr_kal; 
;;;853    	  u8 tm_antidreb;
;;;854    		u8 revers_group_select;
;;;855    		u8 revers_peredacha_select;
;;;856    		u8 rez8;
;;;857    	
;;;858    		u16	per_usr;
;;;859    		u16	time_max;
;;;860    		u16 por_rele;
;;;861    		u16 tm_rele_on;
;;;862    		u16 tm_rele_off;
;;;863    		u16 rez16;
;;;864    	*/	
;;;865    /*
;;;866    			conf.address=1;
;;;867    			conf.ver_po_st=2;
;;;868    			conf.ver_po_ml=3;
;;;869    			conf.tek_gr_kal=4;
;;;870    			conf.tm_antidreb=5;
;;;871    			conf.revers_group_select=6;
;;;872    			conf.revers_peredacha_select=7;
;;;873    			conf.rez8=8;
;;;874    			conf.per_usr=9;
;;;875    			conf.time_max=10;
;;;876    			conf.por_rele=11;
;;;877    			conf.tm_rele_on=12;
;;;878    			conf.tm_rele_off=13;
;;;879    			conf.rez16=14;
;;;880    			
;;;881    		conf.lin.kol_st=15;
;;;882    		conf.lin.max1=16;	
;;;883    		conf.lin.max2=17;
;;;884    		conf.lin.max3=18;
;;;885    		conf.lin.max4=19;
;;;886    		*/
;;;887    			/*
;;;888    			conf.indicators[0].numb=15;
;;;889    			conf.indicators[0].kol_cifr=16;
;;;890    			conf.indicators[0].type_ind=17;
;;;891    			conf.indicators[0].yark=18;
;;;892    			conf.indicators[0].rez_viv=19;
;;;893    			conf.indicators[0].pol_zap=20;
;;;894    			conf.indicators[0].r1=21;
;;;895    			conf.indicators[0].r2=22;
;;;896    			conf.indicators[0].chislo=23;
;;;897    			conf.indicators[0].porog=24;
;;;898    
;;;899    			conf.indicators[1].numb=25;
;;;900    			conf.indicators[1].kol_cifr=26;
;;;901    			conf.indicators[1].type_ind=27;
;;;902    			conf.indicators[1].yark=28;
;;;903    			conf.indicators[1].rez_viv=29;
;;;904    			conf.indicators[1].pol_zap=30;
;;;905    			conf.indicators[1].r1=31;
;;;906    			conf.indicators[1].r2=32;
;;;907    			conf.indicators[1].chislo=33;
;;;908    			conf.indicators[1].porog=34;
;;;909    		
;;;910    
;;;911    		
;;;912    
;;;913    		
;;;914    			conf.indicators[2].numb=35;
;;;915    			conf.indicators[2].kol_cifr=36;
;;;916    			conf.indicators[2].type_ind=37;
;;;917    			conf.indicators[2].yark=38;
;;;918    			conf.indicators[2].rez_viv=39;
;;;919    			conf.indicators[2].pol_zap=40;
;;;920    			conf.indicators[2].r1=41;
;;;921    			conf.indicators[2].r2=42;
;;;922    			conf.indicators[2].chislo=43;
;;;923    			conf.indicators[2].porog=44;
;;;924    			
;;;925    			conf.indicators[3].numb=45;
;;;926    			conf.indicators[3].kol_cifr=46;
;;;927    			conf.indicators[3].type_ind=47;
;;;928    			conf.indicators[3].yark=48;
;;;929    			conf.indicators[3].rez_viv=49;
;;;930    			conf.indicators[3].pol_zap=50;
;;;931    			conf.indicators[3].r1=51;
;;;932    			conf.indicators[3].r2=52;
;;;933    			conf.indicators[3].chislo=53;
;;;934    			conf.indicators[3].porog=54;
;;;935    				*/
;;;936    		/*		
;;;937    			conf.gr_kal1.tabl1.fz[0]=55;
;;;938    			conf.gr_kal1.tabl1.fz[1]=56;
;;;939    			conf.gr_kal1.tabl1.fz[2]=57;
;;;940    			conf.gr_kal1.tabl1.fz[3]=58;
;;;941    			conf.gr_kal1.tabl1.fz[4]=59;
;;;942    			conf.gr_kal1.tabl1.fz[5]=60;
;;;943    			conf.gr_kal1.tabl1.fz[6]=61;
;;;944    			conf.gr_kal1.tabl1.fz[7]=62;
;;;945    			conf.gr_kal1.tabl1.fz[8]=63;
;;;946    			conf.gr_kal1.tabl1.fz[9]=64;
;;;947    
;;;948    			conf.gr_kal1.tabl1.kod[0]=65;
;;;949    			conf.gr_kal1.tabl1.kod[1]=66;
;;;950    			conf.gr_kal1.tabl1.kod[2]=67;
;;;951    			conf.gr_kal1.tabl1.kod[3]=68;
;;;952    			conf.gr_kal1.tabl1.kod[4]=69;
;;;953    			conf.gr_kal1.tabl1.kod[5]=70;
;;;954    			conf.gr_kal1.tabl1.kod[6]=71;
;;;955    			conf.gr_kal1.tabl1.kod[7]=72;
;;;956    			conf.gr_kal1.tabl1.kod[8]=73;
;;;957    			conf.gr_kal1.tabl1.kod[9]=74;
;;;958    	
;;;959    			conf.gr_kal1.tabl2.fz[0]=75;
;;;960    			conf.gr_kal1.tabl2.fz[1]=76;
;;;961    			conf.gr_kal1.tabl2.fz[2]=77;
;;;962    			conf.gr_kal1.tabl2.fz[3]=78;
;;;963    			conf.gr_kal1.tabl2.fz[4]=79;
;;;964    			conf.gr_kal1.tabl2.fz[5]=80;
;;;965    			conf.gr_kal1.tabl2.fz[6]=81;
;;;966    			conf.gr_kal1.tabl2.fz[7]=82;
;;;967    			conf.gr_kal1.tabl2.fz[8]=83;
;;;968    			conf.gr_kal1.tabl2.fz[9]=84;
;;;969    
;;;970    			conf.gr_kal1.tabl2.kod[0]=85;
;;;971    			conf.gr_kal1.tabl2.kod[1]=86;
;;;972    			conf.gr_kal1.tabl2.kod[2]=87;
;;;973    			conf.gr_kal1.tabl2.kod[3]=88;
;;;974    			conf.gr_kal1.tabl2.kod[4]=89;
;;;975    			conf.gr_kal1.tabl2.kod[5]=90;
;;;976    			conf.gr_kal1.tabl2.kod[6]=91;
;;;977    			conf.gr_kal1.tabl2.kod[7]=92;
;;;978    			conf.gr_kal1.tabl2.kod[8]=93;
;;;979    			conf.gr_kal1.tabl2.kod[9]=94;	
;;;980    			
;;;981    			// dr2
;;;982    			conf.gr_kal2.tabl1.fz[0]=95;
;;;983    			conf.gr_kal2.tabl1.fz[1]=96;
;;;984    			conf.gr_kal2.tabl1.fz[2]=97;
;;;985    			conf.gr_kal2.tabl1.fz[3]=98;
;;;986    			conf.gr_kal2.tabl1.fz[4]=99;
;;;987    			conf.gr_kal2.tabl1.fz[5]=100;
;;;988    			conf.gr_kal2.tabl1.fz[6]=101;
;;;989    			conf.gr_kal2.tabl1.fz[7]=102;
;;;990    			conf.gr_kal2.tabl1.fz[8]=103;
;;;991    			conf.gr_kal2.tabl1.fz[9]=104;
;;;992    
;;;993    			conf.gr_kal2.tabl1.kod[0]=105;
;;;994    			conf.gr_kal2.tabl1.kod[1]=106;
;;;995    			conf.gr_kal2.tabl1.kod[2]=107;
;;;996    			conf.gr_kal2.tabl1.kod[3]=108;
;;;997    			conf.gr_kal2.tabl1.kod[4]=109;
;;;998    			conf.gr_kal2.tabl1.kod[5]=100;
;;;999    			conf.gr_kal2.tabl1.kod[6]=111;
;;;1000   			conf.gr_kal2.tabl1.kod[7]=112;
;;;1001   			conf.gr_kal2.tabl1.kod[8]=113;
;;;1002   			conf.gr_kal2.tabl1.kod[9]=114;
;;;1003   	
;;;1004   			conf.gr_kal2.tabl2.fz[0]=115;
;;;1005   			conf.gr_kal2.tabl2.fz[1]=116;
;;;1006   			conf.gr_kal2.tabl2.fz[2]=117;
;;;1007   			conf.gr_kal2.tabl2.fz[3]=118;
;;;1008   			conf.gr_kal2.tabl2.fz[4]=119;
;;;1009   			conf.gr_kal2.tabl2.fz[5]=120;
;;;1010   			conf.gr_kal2.tabl2.fz[6]=121;
;;;1011   			conf.gr_kal2.tabl2.fz[7]=122;
;;;1012   			conf.gr_kal2.tabl2.fz[8]=123;
;;;1013   			conf.gr_kal2.tabl2.fz[9]=124;
;;;1014   
;;;1015   			conf.gr_kal2.tabl2.kod[0]=125;
;;;1016   			conf.gr_kal2.tabl2.kod[1]=126;
;;;1017   			conf.gr_kal2.tabl2.kod[2]=127;
;;;1018   			conf.gr_kal2.tabl2.kod[3]=128;
;;;1019   			conf.gr_kal2.tabl2.kod[4]=129;
;;;1020   			conf.gr_kal2.tabl2.kod[5]=130;
;;;1021   			conf.gr_kal2.tabl2.kod[6]=131;
;;;1022   			conf.gr_kal2.tabl2.kod[7]=132;
;;;1023   			conf.gr_kal2.tabl2.kod[8]=133;
;;;1024   			conf.gr_kal2.tabl2.kod[9]=134;	
;;;1025   */		
;;;1026   		/*
;;;1027   			txsize=sizeof(st_conf)<<1;
;;;1028   	
;;;1029   			for (i = 0; i < (txsize); i += 1)
;;;1030   			{
;;;1031   				u16 tmp=0;
;;;1032   	//			TxBuffer[i]=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1033   				tmp=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1034   				TxBuffer[i<<1]=(tmp>>8)+0x30;
;;;1035   				TxBuffer[(i<<1)+1]=tmp+0x30;
;;;1036   			}	
;;;1037   */
;;;1038   
;;;1039   			txsize=sizeof(st_conf);  // dl = 228
000a30  21be              MOVS     r1,#0xbe
000a32  4839              LDR      r0,|L12.2840|
000a34  f8aa1000          STRH     r1,[r10,#0]
                  |L12.2616|
;;;1040   	
;;;1041   			for (i = 0; i < (txsize); i += 1)
;;;1042   			{
;;;1043   		//		TxBuffer[i]=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1044   				TxBuffer[i]=(*(__IO uint8_t *) (BKPSRAM_BASE + i));
000a38  5c32              LDRB     r2,[r6,r0]
000a3a  55a2              STRB     r2,[r4,r6]
000a3c  1c76              ADDS     r6,r6,#1              ;1041
000a3e  b2b6              UXTH     r6,r6                 ;1041
000a40  428e              CMP      r6,r1                 ;1041
000a42  d3f9              BCC      |L12.2616|
;;;1045   			}	
;;;1046   			tekper=0;
000a44  f8ab5000          STRH     r5,[r11,#0]
;;;1047   			USART_SendData(USART2, 0x3A);
000a48  213a              MOVS     r1,#0x3a
000a4a  4638              MOV      r0,r7
000a4c  f7fffffe          BL       USART_SendData
                  |L12.2640|
;;;1048   		}		
;;;1049   		
;;;1050   		new_komand=0;
000a50  4832              LDR      r0,|L12.2844|
000a52  7005              STRB     r5,[r0,#0]
                  |L12.2644|
;;;1051   	}
;;;1052   	
;;;1053   
;;;1054   	
;;;1055   				//	indicators[0].chislo=1234;
;;;1056   		//		indicators[1].chislo=1234;
;;;1057   		//		indicate (0);
;;;1058   		//		indicate (1);
;;;1059   				
;;;1060   }
000a54  e8bd9ff0          POP      {r4-r12,pc}
                  |L12.2648|
000a58  2174              MOVS     r1,#0x74              ;568
000a5a  70a1              STRB     r1,[r4,#2]            ;568
000a5c  215f              MOVS     r1,#0x5f              ;569
000a5e  70e1              STRB     r1,[r4,#3]            ;569
000a60  7120              STRB     r0,[r4,#4]            ;570
000a62  206f              MOVS     r0,#0x6f              ;571
000a64  7160              STRB     r0,[r4,#5]            ;571
000a66  71a3              STRB     r3,[r4,#6]            ;572
000a68  71e2              STRB     r2,[r4,#7]            ;573
000a6a  7221              STRB     r1,[r4,#8]            ;574
000a6c  7260              STRB     r0,[r4,#9]            ;575
000a6e  206b              MOVS     r0,#0x6b              ;576
000a70  72a0              STRB     r0,[r4,#0xa]          ;576
000a72  e4b0              B        |L12.982|
                  |L12.2676|
000a74  2001              MOVS     r0,#1                 ;599
000a76  e4bc              B        |L12.1010|
                  |L12.2680|
000a78  2101              MOVS     r1,#1                 ;599
000a7a  e4be              B        |L12.1018|
                  |L12.2684|
000a7c  2101              MOVS     r1,#1                 ;599
000a7e  e511              B        |L12.1188|
                  |L12.2688|
000a80  2101              MOVS     r1,#1                 ;599
000a82  e514              B        |L12.1198|
                  |L12.2692|
000a84  2001              MOVS     r0,#1                 ;624
000a86  e54c              B        |L12.1314|
                  |L12.2696|
000a88  2101              MOVS     r1,#1                 ;624
000a8a  e54e              B        |L12.1322|
                  |L12.2700|
000a8c  2101              MOVS     r1,#1                 ;624
000a8e  e551              B        |L12.1332|
                  |L12.2704|
000a90  2101              MOVS     r1,#1                 ;624
000a92  e554              B        |L12.1342|
                  |L12.2708|
000a94  2101              MOVS     r1,#1                 ;624
000a96  e557              B        |L12.1352|
                  |L12.2712|
000a98  2101              MOVS     r1,#1                 ;624
000a9a  e55a              B        |L12.1362|
                  |L12.2716|
000a9c  2101              MOVS     r1,#1                 ;624
000a9e  e55d              B        |L12.1372|
                  |L12.2720|
000aa0  2001              MOVS     r0,#1                 ;654
000aa2  e593              B        |L12.1484|
                  |L12.2724|
000aa4  2101              MOVS     r1,#1                 ;654
000aa6  e595              B        |L12.1492|
                  |L12.2728|
000aa8  2101              MOVS     r1,#1                 ;654
000aaa  e598              B        |L12.1502|
                  |L12.2732|
000aac  e016              B        |L12.2780|
                  |L12.2734|
000aae  e017              B        |L12.2784|
                  |L12.2736|
000ab0  e019              B        |L12.2790|
                  |L12.2738|
000ab2  2101              MOVS     r1,#1                 ;654
000ab4  e598              B        |L12.1512|
                  |L12.2742|
000ab6  2101              MOVS     r1,#1                 ;654
000ab8  e59b              B        |L12.1522|
                  |L12.2746|
000aba  2101              MOVS     r1,#1                 ;654
000abc  e59e              B        |L12.1532|
                  |L12.2750|
000abe  2101              MOVS     r1,#1                 ;654
000ac0  e5a1              B        |L12.1542|
                  |L12.2754|
000ac2  2101              MOVS     r1,#1                 ;654
000ac4  e5a4              B        |L12.1552|
                  |L12.2758|
000ac6  e010              B        |L12.2794|
000ac8  e011              B        |L12.2798|
000aca  e012              B        |L12.2802|
                  |L12.2764|
000acc  2001              MOVS     r0,#1                 ;748
000ace  e650              B        |L12.1906|
                  |L12.2768|
000ad0  2101              MOVS     r1,#1                 ;748
000ad2  e652              B        |L12.1914|
                  |L12.2772|
000ad4  2101              MOVS     r1,#1                 ;748
000ad6  e655              B        |L12.1924|
                  |L12.2776|
000ad8  2101              MOVS     r1,#1                 ;748
000ada  e659              B        |L12.1936|
                  |L12.2780|
000adc  2001              MOVS     r0,#1                 ;840
000ade  e775              B        |L12.2508|
                  |L12.2784|
000ae0  2101              MOVS     r1,#1                 ;840
000ae2  e777              B        |L12.2516|
000ae4  e007              B        |L12.2806|
                  |L12.2790|
000ae6  2101              MOVS     r1,#1                 ;840
000ae8  e779              B        |L12.2526|
                  |L12.2794|
000aea  2101              MOVS     r1,#1                 ;840
000aec  e77c              B        |L12.2536|
                  |L12.2798|
000aee  2101              MOVS     r1,#1                 ;840
000af0  e77f              B        |L12.2546|
                  |L12.2802|
000af2  2101              MOVS     r1,#1                 ;840
000af4  e782              B        |L12.2556|
                  |L12.2806|
000af6  2101              MOVS     r1,#1                 ;840
000af8  e785              B        |L12.2566|
;;;1061   
                          ENDP

000afa  0000              DCW      0x0000
                  |L12.2812|
                          DCD      fz_average
                  |L12.2816|
                          DCD      max
                  |L12.2820|
                          DCD      avariya
                  |L12.2824|
                          DCD      sost_flesh
                  |L12.2828|
                          DCD      conf
                  |L12.2832|
                          DCD      RxBuffer
                  |L12.2836|
                          DCD      0x40020c00
                  |L12.2840|
                          DCD      0x40024000
                  |L12.2844|
                          DCD      new_komand

                          AREA ||i.TIM2_IRQHandler||, CODE, READONLY, ALIGN=1

                  TIM2_IRQHandler PROC
;;;1194     */
;;;1195   void TIM2_IRQHandler(void)
000000  f7ffbffe          B.W      USB_OTG_BSP_TimerIRQ
;;;1196   {
;;;1197     USB_OTG_BSP_TimerIRQ();
;;;1198   }
;;;1199   
                          ENDP


                          AREA ||i.TIM4_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM4_IRQHandler PROC
;;;1100     */
;;;1101   void TIM4_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1102   {
;;;1103      uint8_t clickreg = 0;
;;;1104   
;;;1105   	
;;;1106     /* Checks whether the TIM interrupt has occurred */
;;;1107     if (TIM_GetITStatus(TIM4, TIM_IT_CC1) != RESET)
000002  4c0d              LDR      r4,|L14.56|
000004  2102              MOVS     r1,#2
000006  4620              MOV      r0,r4
000008  f7fffffe          BL       TIM_GetITStatus
00000c  2800              CMP      r0,#0
00000e  d011              BEQ      |L14.52|
;;;1108     {
;;;1109       TIM_ClearITPendingBit(TIM4, TIM_IT_CC1);
000010  2102              MOVS     r1,#2
000012  4620              MOV      r0,r4
000014  f7fffffe          BL       TIM_ClearITPendingBit
;;;1110   		/*
;;;1111       if( LED_Toggle == 3)
;;;1112       {
;;;1113         // LED3 Orange toggling 
;;;1114         STM_EVAL_LEDToggle(LED3);
;;;1115         STM_EVAL_LEDOff(LED6);
;;;1116         STM_EVAL_LEDOff(LED4);
;;;1117       }
;;;1118       else if( LED_Toggle == 4)
;;;1119       {
;;;1120         // LED4 Green toggling 
;;;1121         STM_EVAL_LEDToggle(LED4);
;;;1122         STM_EVAL_LEDOff(LED6);
;;;1123         STM_EVAL_LEDOff(LED3);
;;;1124       }
;;;1125       else if( LED_Toggle == 6)
;;;1126       {
;;;1127         // LED6 Blue toggling 
;;;1128         STM_EVAL_LEDOff(LED3);
;;;1129         STM_EVAL_LEDOff(LED4);
;;;1130         STM_EVAL_LEDToggle(LED6);
;;;1131       }
;;;1132       else if (LED_Toggle ==0)
;;;1133       {
;;;1134         // LED6 Blue On to signal Pause 
;;;1135         STM_EVAL_LEDOn(LED6);
;;;1136       }
;;;1137       else if (LED_Toggle == 7)
;;;1138       {
;;;1139         // LED4 toggling with frequency = 439.4 Hz 
;;;1140         STM_EVAL_LEDOff(LED3);
;;;1141         STM_EVAL_LEDOff(LED4);
;;;1142         STM_EVAL_LEDOff(LED5);
;;;1143         STM_EVAL_LEDOff(LED6);
;;;1144       }
;;;1145   		*/
;;;1146   	
;;;1147   
;;;1148       capture = TIM_GetCapture1(TIM4);
000018  4620              MOV      r0,r4
00001a  f7fffffe          BL       TIM_GetCapture1
00001e  b281              UXTH     r1,r0
000020  4806              LDR      r0,|L14.60|
000022  8141              STRH     r1,[r0,#0xa]
;;;1149       TIM_SetCompare1(TIM4, capture + CCR_Val);
000024  4806              LDR      r0,|L14.64|
000026  8800              LDRH     r0,[r0,#0]  ; CCR_Val
000028  4401              ADD      r1,r1,r0
00002a  4620              MOV      r0,r4
00002c  e8bd4010          POP      {r4,lr}
000030  f7ffbffe          B.W      TIM_SetCompare1
                  |L14.52|
;;;1150     }
;;;1151   }
000034  bd10              POP      {r4,pc}
;;;1152   
                          ENDP

000036  0000              DCW      0x0000
                  |L14.56|
                          DCD      0x40000800
                  |L14.60|
                          DCD      ||.data||
                  |L14.64|
                          DCD      CCR_Val

                          AREA ||i.UsageFault_Handler||, CODE, READONLY, ALIGN=1

                  UsageFault_Handler PROC
                  |L15.0|
;;;150      */
;;;151    void UsageFault_Handler(void)
000000  e7fe              B        |L15.0|
;;;152    {
;;;153      /* Go to infinite loop when Usage Fault exception occurs */
;;;154      while (1)
;;;155      {
;;;156      }
;;;157    }
;;;158    
                          ENDP


                          AREA ||i.fiz_vel||, CODE, READONLY, ALIGN=2

                  fiz_vel PROC
;;;185    
;;;186    u16 fiz_vel(u16 kod, st_tab_kal* tk)
000000  b570              PUSH     {r4-r6,lr}
;;;187    {
;;;188    	u8 i=0, nul=0;
;;;189    	st_tab_kal *tab = tk;
;;;190    //	tab_kal
;;;191    	/*
;;;192    	    
;;;193           
;;;194                    
;;;195                    if kod[1:]==[0,0,0,0,0,0,0,0,0]:
;;;196                        print 'no tabl' 
;;;197                        return kodadc
;;;198                        
;;;199                    if kodadc<kod[0]:
;;;200                        return fz[0]
;;;201                    
;;;202                    for i in range(1,10):
;;;203                        
;;;204                        if kodadc<kod[i]:
;;;205                            if i==0:
;;;206                                print 'i=0',fz[0]
;;;207                                return fz[0]
;;;208                            else:
;;;209                                if kod[i]==0:
;;;210                                    print 'kod=0',fz[i-1]
;;;211                                    return fz[i-1]
;;;212                                else:
;;;213                                    print 'norm',
;;;214                                    return (fz[i]-fz[i-1])*(kodadc-kod[i-1])/(kod[i]-kod[i-1])+fz[i-1]
;;;215                                    
;;;216                        if  kod[i-1]>0 and kod[i]==0:
;;;217                            return fz[i-1]
;;;218                    
;;;219                    return fz[9]
;;;220    
;;;221    	*/
;;;222    	
;;;223    	
;;;224    	/*	
;;;225    	conf.gr_kal1.tabl1.fz[0]
;;;226    	conf.gr_kal1.tabl1.kod[0]=65;
;;;227      conf.tek_gr_kal=4;
;;;228      sost_pribl	
;;;229    	tk
;;;230    	*/
;;;231    		tk_null=0;
000002  4c24              LDR      r4,|L16.148|
000004  2300              MOVS     r3,#0                 ;188
;;;232    		for (i = 1; i < 10; i += 1)
000006  2201              MOVS     r2,#1
000008  7023              STRB     r3,[r4,#0]            ;231
                  |L16.10|
;;;233    			if (tk->kod[i]==0) 
00000a  f8315012          LDRH     r5,[r1,r2,LSL #1]
00000e  b90d              CBNZ     r5,|L16.20|
;;;234    					nul++;	
000010  1c5b              ADDS     r3,r3,#1
000012  b2db              UXTB     r3,r3
                  |L16.20|
000014  1c52              ADDS     r2,r2,#1              ;232
000016  b2d2              UXTB     r2,r2                 ;232
000018  2a0a              CMP      r2,#0xa               ;232
00001a  d3f6              BCC      |L16.10|
;;;235    	  if (nul==9)
00001c  2b09              CMP      r3,#9
00001e  d024              BEQ      |L16.106|
;;;236    		{		tk_null=1;
;;;237    				return kod; }
;;;238    		
;;;239    		if (kod<tk->kod[0])
000020  880a              LDRH     r2,[r1,#0]
000022  4282              CMP      r2,r0
000024  d824              BHI      |L16.112|
;;;240            return tk->fz[0];
;;;241    		
;;;242    		for (i = 1; i < 10; i += 1)	
000026  2201              MOVS     r2,#1
                  |L16.40|
;;;243    		{
;;;244    			float tmp=0;
;;;245    			if (kod<tk->kod[i]) {
000028  f8313012          LDRH     r3,[r1,r2,LSL #1]
00002c  4283              CMP      r3,r0
00002e  d921              BLS      |L16.116|
;;;246    					if (i==0)
000030  b1f2              CBZ      r2,|L16.112|
;;;247    							return tk->fz[0];
;;;248    					else  {
;;;249    							if (tk->kod[i]==0)
000032  041c              LSLS     r4,r3,#16
000034  0c24              LSRS     r4,r4,#16
000036  d029              BEQ      |L16.140|
;;;250    									return tk->fz[i-1];
;;;251    							else  {
;;;252    								  tmp=(tk->fz[i]-tk->fz[i-1])*(kod-tk->kod[i-1])/(tk->kod[i]-tk->kod[i-1])+tk->fz[i-1]+0.5;
000038  eb010142          ADD      r1,r1,r2,LSL #1
00003c  8a8c              LDRH     r4,[r1,#0x14]
00003e  8a4a              LDRH     r2,[r1,#0x12]
000040  f8311c02          LDRH     r1,[r1,#-2]
000044  1aa4              SUBS     r4,r4,r2
000046  1a40              SUBS     r0,r0,r1
000048  4344              MULS     r4,r0,r4
00004a  1a58              SUBS     r0,r3,r1
00004c  fb94f0f0          SDIV     r0,r4,r0
000050  4410              ADD      r0,r0,r2
000052  f7fffffe          BL       __aeabi_i2d
000056  2200              MOVS     r2,#0
000058  4b0f              LDR      r3,|L16.152|
00005a  f7fffffe          BL       __aeabi_dadd
00005e  f7fffffe          BL       __aeabi_d2f
;;;253    									return (u16) tmp;  } } }
000062  f7fffffe          BL       __aeabi_f2uiz
000066  b280              UXTH     r0,r0
;;;254    									
;;;255    			if  ((tk->kod[i-1]>0)&(tk->kod[i]==0))
;;;256    					return tk->fz[i-1];
;;;257      	}	
;;;258        
;;;259    		return tk->fz[9];		
;;;260    }
000068  bd70              POP      {r4-r6,pc}
                  |L16.106|
00006a  2101              MOVS     r1,#1                 ;236
00006c  7021              STRB     r1,[r4,#0]            ;236
00006e  bd70              POP      {r4-r6,pc}
                  |L16.112|
000070  8a88              LDRH     r0,[r1,#0x14]         ;247
000072  bd70              POP      {r4-r6,pc}
                  |L16.116|
000074  eb010442          ADD      r4,r1,r2,LSL #1       ;255
000078  f8344c02          LDRH     r4,[r4,#-2]           ;255
00007c  b104              CBZ      r4,|L16.128|
00007e  b12b              CBZ      r3,|L16.140|
                  |L16.128|
000080  1c52              ADDS     r2,r2,#1              ;242
000082  b2d2              UXTB     r2,r2                 ;242
000084  2a0a              CMP      r2,#0xa               ;242
000086  d3cf              BCC      |L16.40|
000088  8cc8              LDRH     r0,[r1,#0x26]         ;259
00008a  bd70              POP      {r4-r6,pc}
                  |L16.140|
00008c  eb010042          ADD      r0,r1,r2,LSL #1       ;256
000090  8a40              LDRH     r0,[r0,#0x12]         ;256
000092  bd70              POP      {r4-r6,pc}
;;;261    
                          ENDP

                  |L16.148|
                          DCD      ||.data||
                  |L16.152|
                          DCD      0x3fe00000

                          AREA ||i.moving_average||, CODE, READONLY, ALIGN=2

                  moving_average PROC
;;;262    
;;;263    u16 moving_average(u16 kod, u8 numb)
000000  b570              PUSH     {r4-r6,lr}
;;;264    {
;;;265    	extern u16 tek_kol;
;;;266    	extern u16 kol_usr;
;;;267    	extern u32 buf_sum;
;;;268    	u16 tmp=0;
;;;269    	
;;;270    	if (kol_usr==0)
000002  4916              LDR      r1,|L17.92|
000004  880a              LDRH     r2,[r1,#0]  ; kol_usr
000006  2a00              CMP      r2,#0                 ;264
000008  d018              BEQ      |L17.60|
;;;271    		return kod;
;;;272    
;;;273    	if (kol_usr==1)
00000a  2a01              CMP      r2,#1
00000c  d016              BEQ      |L17.60|
;;;274    		return kod;
;;;275    	
;;;276    	if (tek_kol<kol_usr)
00000e  4b14              LDR      r3,|L17.96|
;;;277    	{
;;;278    		buf_sum+=kod;
000010  4d14              LDR      r5,|L17.100|
;;;279    		tek_kol++;
;;;280    		return (u16)((buf_sum/tek_kol)+0.5);
000012  4e15              LDR      r6,|L17.104|
000014  8819              LDRH     r1,[r3,#0]            ;276  ; tek_kol
000016  682c              LDR      r4,[r5,#0]            ;278
000018  4291              CMP      r1,r2                 ;276
00001a  4404              ADD      r4,r4,r0              ;278
00001c  d20f              BCS      |L17.62|
00001e  1c49              ADDS     r1,r1,#1              ;279
000020  b288              UXTH     r0,r1                 ;279
000022  602c              STR      r4,[r5,#0]            ;279  ; buf_sum
000024  8018              STRH     r0,[r3,#0]            ;279
000026  fbb4f0f0          UDIV     r0,r4,r0
00002a  f7fffffe          BL       __aeabi_ui2d
00002e  2200              MOVS     r2,#0
000030  4633              MOV      r3,r6
000032  f7fffffe          BL       __aeabi_dadd
000036  f7fffffe          BL       __aeabi_d2uiz
00003a  b280              UXTH     r0,r0
                  |L17.60|
;;;281    	}
;;;282    	else
;;;283    	{
;;;284    		buf_sum+=kod;
;;;285    		tmp=(u16) ((buf_sum/tek_kol)+0.5);
;;;286    		buf_sum-=tmp;
;;;287    		return  tmp;
;;;288    	}
;;;289    }
00003c  bd70              POP      {r4-r6,pc}
                  |L17.62|
00003e  fbb4f0f1          UDIV     r0,r4,r1              ;285
000042  f7fffffe          BL       __aeabi_ui2d
000046  2200              MOVS     r2,#0                 ;285
000048  4633              MOV      r3,r6                 ;285
00004a  f7fffffe          BL       __aeabi_dadd
00004e  f7fffffe          BL       __aeabi_d2uiz
000052  b280              UXTH     r0,r0                 ;285
000054  1a21              SUBS     r1,r4,r0              ;286
000056  6029              STR      r1,[r5,#0]            ;286  ; buf_sum
000058  bd70              POP      {r4-r6,pc}
;;;290    
                          ENDP

00005a  0000              DCW      0x0000
                  |L17.92|
                          DCD      kol_usr
                  |L17.96|
                          DCD      tek_kol
                  |L17.100|
                          DCD      buf_sum
                  |L17.104|
                          DCD      0x3fe00000

                          AREA ||i.test_rele||, CODE, READONLY, ALIGN=2

                  test_rele PROC
;;;290    
;;;291    u8 test_rele(u16 fz, u8 numb)
000000  b5f0              PUSH     {r4-r7,lr}
;;;292    {
;;;293    	extern st_conf conf;
;;;294    	
;;;295    	if (fz>conf.por_rele)
000002  4d11              LDR      r5,|L18.72|
;;;296    			kol_rele_on++;			
000004  4911              LDR      r1,|L18.76|
000006  89aa              LDRH     r2,[r5,#0xc]          ;295  ; conf
000008  4282              CMP      r2,r0                 ;295
00000a  d203              BCS      |L18.20|
00000c  8888              LDRH     r0,[r1,#4]  ; kol_rele_on
00000e  1c40              ADDS     r0,r0,#1
000010  8088              STRH     r0,[r1,#4]
000012  e002              B        |L18.26|
                  |L18.20|
;;;297    	else
;;;298    			kol_rele_off++;
000014  88c8              LDRH     r0,[r1,#6]  ; kol_rele_off
000016  1c40              ADDS     r0,r0,#1
000018  80c8              STRH     r0,[r1,#6]
                  |L18.26|
;;;299    		
;;;300    	if (kol_rele_on>=conf.tm_rele_on)
00001a  89ee              LDRH     r6,[r5,#0xe]  ; conf
00001c  888f              LDRH     r7,[r1,#4]  ; kol_rele_on
00001e  2000              MOVS     r0,#0
;;;301    	{
;;;302    		kol_rele_on=0;
;;;303    		kol_rele_off=0;
;;;304    		avariya=1;
000020  4a0b              LDR      r2,|L18.80|
;;;305    		PORT_AVARIYA->BSRRL = PIN_AVARIYA;	// on PIN_AVARIYA
000022  4c0c              LDR      r4,|L18.84|
000024  f44f4300          MOV      r3,#0x8000
000028  42be              CMP      r6,r7                 ;300
00002a  d804              BHI      |L18.54|
00002c  8088              STRH     r0,[r1,#4]            ;302
00002e  80c8              STRH     r0,[r1,#6]            ;303
000030  2601              MOVS     r6,#1                 ;304
000032  7016              STRB     r6,[r2,#0]            ;304
000034  8323              STRH     r3,[r4,#0x18]
                  |L18.54|
;;;306    	}
;;;307    	
;;;308    	if (kol_rele_off>=conf.tm_rele_off)
000036  8a2d              LDRH     r5,[r5,#0x10]  ; conf
000038  88ce              LDRH     r6,[r1,#6]  ; kol_rele_off
00003a  42b5              CMP      r5,r6
00003c  d803              BHI      |L18.70|
;;;309    	{
;;;310    		kol_rele_on=0;
00003e  8088              STRH     r0,[r1,#4]
;;;311    		kol_rele_off=0;
000040  80c8              STRH     r0,[r1,#6]
;;;312    		avariya=0;
000042  7010              STRB     r0,[r2,#0]
;;;313    		PORT_AVARIYA->BSRRH = PIN_AVARIYA;  	// off  PIN_AVARIYA
000044  8363              STRH     r3,[r4,#0x1a]
                  |L18.70|
;;;314    	}
;;;315    }
000046  bdf0              POP      {r4-r7,pc}
;;;316    
                          ENDP

                  |L18.72|
                          DCD      conf
                  |L18.76|
                          DCD      ||.data||
                  |L18.80|
                          DCD      avariya
                  |L18.84|
                          DCD      0x40020000

                          AREA ||.data||, DATA, ALIGN=1

                  tk_null
000000  00                DCB      0x00
                  PauseResumeStatus
000001  02                DCB      0x02
                  Count
000002  0000              DCB      0x00,0x00
                  kol_rele_on
000004  0000              DCW      0x0000
                  kol_rele_off
000006  0000              DCW      0x0000
                  time_max
000008  0000              DCW      0x0000
                  capture
00000a  0000              DCW      0x0000
                  ||DT1||
                          DCDU     0x00000000
000010  000000            DCB      0x00,0x00,0x00

                          AREA ||area_number.22||, DATA, ALIGN=0

                          EXPORTAS ||area_number.22||, ||.data||
                  LED_Toggle
000000  00                DCB      0x00

                          AREA ||area_number.23||, DATA, ALIGN=1

                          EXPORTAS ||area_number.23||, ||.data||
                  Time_Rec_Base
000000  0000              DCW      0x0000

;*** Start embedded assembler ***

#line 1 "src\\stm32f4xx_it.c"
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_stm32f4xx_it_c_52b4fc9b____REV16|
#line 114 ".\\Libraries\\CMSIS\\core_cmInstr.h"
|__asm___14_stm32f4xx_it_c_52b4fc9b____REV16| PROC
#line 115

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_stm32f4xx_it_c_52b4fc9b____REVSH|
#line 128
|__asm___14_stm32f4xx_it_c_52b4fc9b____REVSH| PROC
#line 129

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
