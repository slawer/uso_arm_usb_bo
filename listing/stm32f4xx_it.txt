; generated by ARM C/C++ Compiler, 5.03 [Build 76]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o.\media_usb_key\stm32f4xx_it.o --asm_dir=.\listing\ --list_dir=.\listing\ --depend=.\media_usb_key\stm32f4xx_it.d --cpu=Cortex-M4 --apcs=interwork -I.\Libraries -I.\Utilities -I.\Libraries\CMSIS\ST\STM32F4xx\Include -I.\inc -I.\src -I.\Libraries\STM32F4xx_StdPeriph_Driver -I.\Libraries\STM32_USB_HOST_Library -I.\Libraries\STM32_USB_OTG_Driver -I.\Utilities\STM32F4-Discovery -I.\Libraries\CMSIS -I.\Utilities\Third_Party\fat_fs -IC:\Keil4\ARM\RV31\INC -IC:\Keil4\ARM\CMSIS\Include -IC:\Keil4\ARM\Inc\ST\STM32F4xx -D__MICROLIB -DUSE_STDPERIPH_DRIVER -DUSE_USB_OTG_FS -DSTM32F4XX -DMEDIA_USB_KEY -D__FPU_PRESENT=0 --omf_browse=.\media_usb_key\stm32f4xx_it.crf src\stm32f4xx_it.c]
                          THUMB

                          AREA ||i.BusFault_Handler||, CODE, READONLY, ALIGN=1

                  BusFault_Handler PROC
                  |L1.0|
;;;200      */
;;;201    void BusFault_Handler(void)
000000  e7fe              B        |L1.0|
;;;202    {
;;;203      /* Go to infinite loop when Bus Fault exception occurs */
;;;204      while (1)
;;;205      {
;;;206      }
;;;207    }
;;;208    
                          ENDP


                          AREA ||i.DebugMon_Handler||, CODE, READONLY, ALIGN=1

                  DebugMon_Handler PROC
;;;235      */
;;;236    void DebugMon_Handler(void)
000000  4770              BX       lr
;;;237    {
;;;238    }
;;;239    
                          ENDP


                          AREA ||i.EXTI0_IRQHandler||, CODE, READONLY, ALIGN=2

                  EXTI0_IRQHandler PROC
;;;1294     */
;;;1295   void EXTI0_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1296   {
;;;1297     /* Checks whether the User Button EXTI line is asserted*/
;;;1298     if (EXTI_GetITStatus(EXTI_Line0) != RESET) 
000002  2001              MOVS     r0,#1
000004  f7fffffe          BL       EXTI_GetITStatus
000008  b158              CBZ      r0,|L3.34|
;;;1299     { 
;;;1300       if (Command_index == 1)
00000a  4808              LDR      r0,|L3.44|
00000c  7803              LDRB     r3,[r0,#0]  ; Command_index
00000e  2100              MOVS     r1,#0
;;;1301       {
;;;1302         RepeatState = 0;
000010  4a07              LDR      r2,|L3.48|
000012  2b01              CMP      r3,#1                 ;1300
000014  d001              BEQ      |L3.26|
;;;1303         /* Switch to play command */
;;;1304         Command_index = 0;
;;;1305       }
;;;1306       else if (Command_index == 0)
000016  7803              LDRB     r3,[r0,#0]  ; Command_index
000018  b10b              CBZ      r3,|L3.30|
                  |L3.26|
00001a  7011              STRB     r1,[r2,#0]            ;1302
00001c  e000              B        |L3.32|
                  |L3.30|
;;;1307       {
;;;1308         /* Switch to record command */
;;;1309         Command_index = 1;
00001e  2101              MOVS     r1,#1
                  |L3.32|
000020  7001              STRB     r1,[r0,#0]
                  |L3.34|
;;;1310     //    XferCplt = 1;
;;;1311     //    EVAL_AUDIO_Stop(CODEC_PDWN_SW);
;;;1312       }
;;;1313       else
;;;1314       {
;;;1315         RepeatState = 0;
;;;1316         /* Switch to play command */
;;;1317         Command_index = 0; 
;;;1318       }
;;;1319     } 
;;;1320     /* Clears the EXTI's line pending bit.*/ 
;;;1321     EXTI_ClearITPendingBit(EXTI_Line0);
000022  e8bd4010          POP      {r4,lr}
000026  2001              MOVS     r0,#1
000028  f7ffbffe          B.W      EXTI_ClearITPendingBit
;;;1322   }
;;;1323   
                          ENDP

                  |L3.44|
                          DCD      Command_index
                  |L3.48|
                          DCD      RepeatState

                          AREA ||i.EXTI1_IRQHandler||, CODE, READONLY, ALIGN=2

                  EXTI1_IRQHandler PROC
;;;1210     */
;;;1211   void EXTI1_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1212   {
;;;1213     /* Check the clic on the accelerometer to Pause/Resume Playing */
;;;1214     if(EXTI_GetITStatus(EXTI_Line1) != RESET)
000002  2002              MOVS     r0,#2
000004  f7fffffe          BL       EXTI_GetITStatus
000008  2800              CMP      r0,#0
00000a  d00f              BEQ      |L4.44|
;;;1215     {
;;;1216       if( Count==1)
00000c  4808              LDR      r0,|L4.48|
00000e  7883              LDRB     r3,[r0,#2]  ; Count
000010  2200              MOVS     r2,#0
;;;1217       {
;;;1218         PauseResumeStatus = 1;
000012  2101              MOVS     r1,#1
000014  2b01              CMP      r3,#1                 ;1216
000016  d006              BEQ      |L4.38|
;;;1219         Count = 0;
;;;1220       }
;;;1221       else
;;;1222       {
;;;1223         PauseResumeStatus = 0;
000018  7042              STRB     r2,[r0,#1]
;;;1224         Count = 1;
00001a  7081              STRB     r1,[r0,#2]
                  |L4.28|
;;;1225       }
;;;1226       /* Clear the EXTI line 1 pending bit */
;;;1227       EXTI_ClearITPendingBit(EXTI_Line1);
00001c  e8bd4010          POP      {r4,lr}
000020  2002              MOVS     r0,#2
000022  f7ffbffe          B.W      EXTI_ClearITPendingBit
                  |L4.38|
000026  7041              STRB     r1,[r0,#1]            ;1218
000028  7082              STRB     r2,[r0,#2]            ;1219
00002a  e7f7              B        |L4.28|
                  |L4.44|
;;;1228     }
;;;1229   }
00002c  bd10              POP      {r4,pc}
;;;1230   
                          ENDP

00002e  0000              DCW      0x0000
                  |L4.48|
                          DCD      ||.data||

                          AREA ||i.HardFault_Handler||, CODE, READONLY, ALIGN=1

                  HardFault_Handler PROC
                  |L5.0|
;;;174      */
;;;175    void HardFault_Handler(void)
000000  e7fe              B        |L5.0|
;;;176    {
;;;177      /* Go to infinite loop when Hard Fault exception occurs */
;;;178      while (1)
;;;179      {
;;;180      }
;;;181    }
;;;182    
                          ENDP


                          AREA ||i.MemManage_Handler||, CODE, READONLY, ALIGN=1

                  MemManage_Handler PROC
                  |L6.0|
;;;187      */
;;;188    void MemManage_Handler(void)
000000  e7fe              B        |L6.0|
;;;189    {
;;;190      /* Go to infinite loop when Memory Manage exception occurs */
;;;191      while (1)
;;;192      {
;;;193      }
;;;194    }
;;;195    
                          ENDP


                          AREA ||i.NMI_Handler||, CODE, READONLY, ALIGN=1

                  NMI_Handler PROC
;;;144      */
;;;145    void NMI_Handler(void)
000000  b510              PUSH     {r4,lr}
;;;146    {
;;;147      /* This interrupt is generated when HSE clock fails */
;;;148    
;;;149      if (RCC_GetITStatus(RCC_IT_CSS) != RESET)
000002  2080              MOVS     r0,#0x80
000004  f7fffffe          BL       RCC_GetITStatus
000008  2800              CMP      r0,#0
00000a  d00b              BEQ      |L7.36|
;;;150      {
;;;151        /* At this stage: HSE, PLL are disabled (but no change on PLL config) and HSI
;;;152           is selected as system clock source */
;;;153    
;;;154        /* Enable HSE */
;;;155        RCC_HSEConfig(RCC_HSE_ON);
00000c  2001              MOVS     r0,#1
00000e  f7fffffe          BL       RCC_HSEConfig
;;;156    
;;;157        /* Enable HSE Ready and PLL Ready interrupts */
;;;158        RCC_ITConfig(RCC_IT_HSERDY | RCC_IT_PLLRDY, ENABLE);
000012  2101              MOVS     r1,#1
000014  2018              MOVS     r0,#0x18
000016  f7fffffe          BL       RCC_ITConfig
;;;159    
;;;160        /* Clear Clock Security System interrupt pending bit */
;;;161        RCC_ClearITPendingBit(RCC_IT_CSS);
00001a  e8bd4010          POP      {r4,lr}
00001e  2080              MOVS     r0,#0x80
000020  f7ffbffe          B.W      RCC_ClearITPendingBit
                  |L7.36|
;;;162    
;;;163        /* Once HSE clock recover, the HSERDY interrupt is generated and in the RCC ISR
;;;164           routine the system clock will be reconfigured to its previous state (before
;;;165           HSE clock failure) */
;;;166      }
;;;167    }
000024  bd10              POP      {r4,pc}
;;;168    
                          ENDP


                          AREA ||i.OTG_FS_IRQHandler||, CODE, READONLY, ALIGN=2

                  OTG_FS_IRQHandler PROC
;;;1340     */
;;;1341   void OTG_FS_IRQHandler(void)
000000  4801              LDR      r0,|L8.8|
;;;1342   {
;;;1343     USBH_OTG_ISR_Handler(&USB_OTG_Core);
000002  f7ffbffe          B.W      USBH_OTG_ISR_Handler
;;;1344   }
;;;1345   #endif /* MEDIA_USB_KEY */
                          ENDP

000006  0000              DCW      0x0000
                  |L8.8|
                          DCD      USB_OTG_Core

                          AREA ||i.PendSV_Handler||, CODE, READONLY, ALIGN=1

                  PendSV_Handler PROC
;;;244      */
;;;245    void PendSV_Handler(void)
000000  4770              BX       lr
;;;246    {
;;;247    }
;;;248    
                          ENDP


                          AREA ||i.RCC_IRQHandler||, CODE, READONLY, ALIGN=1

                  RCC_IRQHandler PROC
;;;1361     */
;;;1362   void RCC_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1363   {
;;;1364     if(RCC_GetITStatus(RCC_IT_HSERDY) != RESET)
000002  2008              MOVS     r0,#8
000004  f7fffffe          BL       RCC_GetITStatus
000008  b148              CBZ      r0,|L10.30|
;;;1365     { 
;;;1366       /* Clear HSERDY interrupt pending bit */
;;;1367       RCC_ClearITPendingBit(RCC_IT_HSERDY);
00000a  2008              MOVS     r0,#8
00000c  f7fffffe          BL       RCC_ClearITPendingBit
;;;1368   
;;;1369       /* Check if the HSE clock is still available */
;;;1370       if (RCC_GetFlagStatus(RCC_FLAG_HSERDY) != RESET)
000010  2031              MOVS     r0,#0x31
000012  f7fffffe          BL       RCC_GetFlagStatus
000016  b110              CBZ      r0,|L10.30|
;;;1371       { 
;;;1372         /* Enable PLL: once the PLL is ready the PLLRDY interrupt is generated */ 
;;;1373         RCC_PLLCmd(ENABLE);     
000018  2001              MOVS     r0,#1
00001a  f7fffffe          BL       RCC_PLLCmd
                  |L10.30|
;;;1374       }
;;;1375     }
;;;1376   
;;;1377     if(RCC_GetITStatus(RCC_IT_PLLRDY) != RESET)
00001e  2010              MOVS     r0,#0x10
000020  f7fffffe          BL       RCC_GetITStatus
000024  2800              CMP      r0,#0
000026  d00c              BEQ      |L10.66|
;;;1378     { 
;;;1379       /* Clear PLLRDY interrupt pending bit */
;;;1380       RCC_ClearITPendingBit(RCC_IT_PLLRDY);
000028  2010              MOVS     r0,#0x10
00002a  f7fffffe          BL       RCC_ClearITPendingBit
;;;1381   
;;;1382       /* Check if the PLL is still locked */
;;;1383       if (RCC_GetFlagStatus(RCC_FLAG_PLLRDY) != RESET)
00002e  2039              MOVS     r0,#0x39
000030  f7fffffe          BL       RCC_GetFlagStatus
000034  2800              CMP      r0,#0
000036  d004              BEQ      |L10.66|
;;;1384       { 
;;;1385         /* Select PLL as system clock source */
;;;1386         RCC_SYSCLKConfig(RCC_SYSCLKSource_PLLCLK);
000038  e8bd4010          POP      {r4,lr}
00003c  2002              MOVS     r0,#2
00003e  f7ffbffe          B.W      RCC_SYSCLKConfig
                  |L10.66|
;;;1387       }
;;;1388     }
;;;1389   }
000042  bd10              POP      {r4,pc}
;;;1390   
                          ENDP


                          AREA ||i.SVC_Handler||, CODE, READONLY, ALIGN=1

                  SVC_Handler PROC
;;;226      */
;;;227    void SVC_Handler(void)
000000  4770              BX       lr
;;;228    {
;;;229    }
;;;230    
                          ENDP


                          AREA ||i.SysTick_Handler||, CODE, READONLY, ALIGN=2

                  SysTick_Handler PROC
;;;386      */
;;;387    void SysTick_Handler(void)
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;388    {
;;;389    	extern __IO uint16_t ADC3ConvertedValue;
;;;390    	extern u32 tick;
;;;391    	extern st_conf conf;
;;;392    	
;;;393     //  проверка состояния датчика приближений - 
;;;394    	
;;;395    	if ((PORT_PRIBL->IDR & PIN_PRIBL)==0)
000004  4efa              LDR      r6,|L12.1008|
000006  6830              LDR      r0,[r6,#0]
;;;396    	{
;;;397    		kol_pribl_vikl++;
;;;398    	}
;;;399    	else
;;;400    	{
;;;401    		kol_pribl_vkl++;
000008  49fa              LDR      r1,|L12.1012|
00000a  4afb              LDR      r2,|L12.1016|
00000c  0780              LSLS     r0,r0,#30             ;395
00000e  d403              BMI      |L12.24|
000010  8810              LDRH     r0,[r2,#0]            ;397  ; kol_pribl_vikl
000012  1c40              ADDS     r0,r0,#1              ;397
000014  8010              STRH     r0,[r2,#0]            ;397
000016  e002              B        |L12.30|
                  |L12.24|
000018  8808              LDRH     r0,[r1,#0]  ; kol_pribl_vkl
00001a  1c40              ADDS     r0,r0,#1
00001c  8008              STRH     r0,[r1,#0]
                  |L12.30|
;;;402    	}
;;;403    	conf.tm_antidreb=2;
00001e  4bf7              LDR      r3,|L12.1020|
000020  2002              MOVS     r0,#2
;;;404    	if (kol_pribl_vkl>=conf.tm_antidreb)
;;;405    	{
;;;406    			sost_pribl=1;	
;;;407    			PORT_PER_NIZ->BSRRH = PIN_PER_NIZ;  	// off  PIN_PER_NIZ
000022  2708              MOVS     r7,#8
000024  7118              STRB     r0,[r3,#4]            ;403
000026  f8b18000          LDRH     r8,[r1,#0]            ;404  ; kol_pribl_vkl
00002a  f8dfc3d4          LDR      r12,|L12.1024|
;;;408    			PORT_PER_VERH->BSRRL = PIN_PER_VERH;	// on PIN_PER_VERH
00002e  f8df93d4          LDR      r9,|L12.1028|
000032  01c0              LSLS     r0,r0,#7
000034  4df4              LDR      r5,|L12.1032|
000036  2400              MOVS     r4,#0                 ;406
000038  f04f0a01          MOV      r10,#1                ;406
00003c  f1b80f02          CMP      r8,#2                 ;404
000040  d306              BCC      |L12.80|
000042  f885a000          STRB     r10,[r5,#0]           ;406
000046  f8ac701a          STRH     r7,[r12,#0x1a]        ;407
00004a  f8a90018          STRH     r0,[r9,#0x18]
;;;409    			kol_pribl_vkl=0;
;;;410    		  kol_pribl_vikl=0;
00004e  e009              B        |L12.100|
                  |L12.80|
;;;411    	} 
;;;412    	
;;;413    	if (kol_pribl_vikl>=conf.tm_antidreb)
000050  f8b28000          LDRH     r8,[r2,#0]  ; kol_pribl_vikl
000054  f1b80f02          CMP      r8,#2
000058  d306              BCC      |L12.104|
;;;414    	{
;;;415    			sost_pribl=0;	
00005a  702c              STRB     r4,[r5,#0]
;;;416    			PORT_PER_NIZ->BSRRL = PIN_PER_NIZ;  	// on  PIN_PER_NIZ
00005c  f8ac7018          STRH     r7,[r12,#0x18]
;;;417    			PORT_PER_VERH->BSRRH = PIN_PER_VERH;	// off PIN_PER_VERH
000060  f8a9001a          STRH     r0,[r9,#0x1a]
                  |L12.100|
000064  800c              STRH     r4,[r1,#0]            ;409
000066  8014              STRH     r4,[r2,#0]            ;410
                  |L12.104|
;;;418    			kol_pribl_vkl=0;
;;;419    			kol_pribl_vikl=0;
;;;420    	}
;;;421    
;;;422    	
;;;423    	// проверка кнопок-состояния переключателей группы калибровок
;;;424    	// on 	GPIO_PORT[Led]->BSRRL = GPIO_PIN[Led];
;;;425    	// off  GPIO_PORT[Led]->BSRRH = GPIO_PIN[Led];    
;;;426    //	conf.tek_gr_kal
;;;427    
;;;428    		if ((PORT_K1->IDR & PIN_K1)==0)
000068  6831              LDR      r1,[r6,#0]
;;;429    		{
;;;430    			kol_gr1_vkl++;
00006a  4ae8              LDR      r2,|L12.1036|
00006c  0609              LSLS     r1,r1,#24             ;428
00006e  d403              BMI      |L12.120|
000070  8811              LDRH     r1,[r2,#0]  ; kol_gr1_vkl
000072  f1010101          ADD      r1,r1,#1
000076  8011              STRH     r1,[r2,#0]
                  |L12.120|
;;;431    		}
;;;432    
;;;433    		if ((PORT_K2->IDR & PIN_K2)==0)
000078  6831              LDR      r1,[r6,#0]
00007a  058e              LSLS     r6,r1,#22
;;;434    		{
;;;435    			kol_gr2_vkl++;
00007c  49e4              LDR      r1,|L12.1040|
00007e  d402              BMI      |L12.134|
000080  880e              LDRH     r6,[r1,#0]  ; kol_gr2_vkl
000082  1c76              ADDS     r6,r6,#1
000084  800e              STRH     r6,[r1,#0]
                  |L12.134|
;;;436    
;;;437    		}
;;;438    
;;;439    
;;;440    		if (kol_gr1_vkl>=conf.tm_antidreb)
;;;441    		{
;;;442    				conf.tek_gr_kal=0;
;;;443    	 // gr 1
;;;444    			PORT_L1->BSRRL = PIN_L1;  	// on  PIN_L1
000086  4bda              LDR      r3,|L12.1008|
000088  8816              LDRH     r6,[r2,#0]            ;440  ; kol_gr1_vkl
00008a  2740              MOVS     r7,#0x40
00008c  3308              ADDS     r3,r3,#8
00008e  2e02              CMP      r6,#2                 ;440
;;;445    			PORT_L2->BSRRH = PIN_L2;	// off PIN_L2
;;;446    
;;;447    				kol_gr1_vkl=0;
;;;448    				kol_gr2_vkl=0;
;;;449    		}		
;;;450    
;;;451    		if (kol_gr2_vkl>=conf.tm_antidreb)
000090  4eda              LDR      r6,|L12.1020|
000092  f1030c02          ADD      r12,r3,#2             ;445
000096  d304              BCC      |L12.162|
000098  70f4              STRB     r4,[r6,#3]            ;442
00009a  801f              STRH     r7,[r3,#0]            ;444
00009c  f8ac0000          STRH     r0,[r12,#0]           ;445
0000a0  e009              B        |L12.182|
                  |L12.162|
0000a2  f8b18000          LDRH     r8,[r1,#0]  ; kol_gr2_vkl
0000a6  f1b80f02          CMP      r8,#2
0000aa  d306              BCC      |L12.186|
;;;452    		{
;;;453    				conf.tek_gr_kal=1;
0000ac  f886a003          STRB     r10,[r6,#3]
;;;454    				 // gr 2
;;;455    			PORT_L1->BSRRH = PIN_L1;  	// off  PIN_L1
0000b0  f8ac7000          STRH     r7,[r12,#0]
;;;456    			PORT_L2->BSRRL = PIN_L2;	// on PIN_L2
0000b4  8018              STRH     r0,[r3,#0]
                  |L12.182|
0000b6  8014              STRH     r4,[r2,#0]            ;447
0000b8  800c              STRH     r4,[r1,#0]            ;448
                  |L12.186|
;;;457    				kol_gr1_vkl=0;
;;;458    				kol_gr2_vkl=0;
;;;459    		}				
;;;460    	
;;;461    	/*
;;;462    	  RCC_AHB1PeriphClockCmd(GPIO_CLK[Led], ENABLE);
;;;463    
;;;464    
;;;465      GPIO_InitStructure.GPIO_Pin = GPIO_PIN[Led];
;;;466      GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
;;;467      GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
;;;468      GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
;;;469      GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
;;;470      GPIO_Init(GPIO_PORT[Led], &GPIO_InitStructure);
;;;471    	*/
;;;472    	
;;;473    			// проверяем реле на срабатывание
;;;474    	test_rele(fz[0], 0);	
0000ba  4ed6              LDR      r6,|L12.1044|
0000bc  2100              MOVS     r1,#0
0000be  8830              LDRH     r0,[r6,#0]  ; fz
0000c0  f7fffffe          BL       test_rele
;;;475    	
;;;476    	
;;;477    	// раз в 10 мс
;;;478    	// находим среднее значение
;;;479    	summa[0]+=ADC3ConvertedValue;
0000c4  4ad4              LDR      r2,|L12.1048|
0000c6  48d5              LDR      r0,|L12.1052|
0000c8  8811              LDRH     r1,[r2,#0]  ; summa
0000ca  8800              LDRH     r0,[r0,#0]  ; ADC3ConvertedValue
;;;480    	 
;;;481    //		summa[0]+=100;
;;;482    	kol_average++;
0000cc  4bd4              LDR      r3,|L12.1056|
0000ce  4408              ADD      r0,r0,r1              ;479
0000d0  b281              UXTH     r1,r0                 ;479
0000d2  8011              STRH     r1,[r2,#0]            ;479
0000d4  7818              LDRB     r0,[r3,#0]  ; kol_average
0000d6  1c40              ADDS     r0,r0,#1
0000d8  b2c0              UXTB     r0,r0
0000da  7018              STRB     r0,[r3,#0]
;;;483    	
;;;484    	if (kol_average==10)
0000dc  280a              CMP      r0,#0xa
0000de  d17d              BNE      |L12.476|
;;;485    	{			
;;;486    	
;;;487    		
;;;488    		average[0]=summa[0]/kol_average;
0000e0  fbb1f0f0          UDIV     r0,r1,r0
0000e4  4fcf              LDR      r7,|L12.1060|
0000e6  8038              STRH     r0,[r7,#0]
;;;489    		kol_average=0;
0000e8  701c              STRB     r4,[r3,#0]
;;;490    		summa[0]=0;
0000ea  8014              STRH     r4,[r2,#0]
;;;491    		
;;;492    		
;;;493    		read_dat_clock();
0000ec  f7fffffe          BL       read_dat_clock
;;;494    		// раз в 100 мс
;;;495    		// вычисляем физическую величину
;;;496    		
;;;497    		if (conf.tek_gr_kal==0)
0000f0  f8df8308          LDR      r8,|L12.1020|
0000f4  f8980003          LDRB     r0,[r8,#3]  ; conf
0000f8  2800              CMP      r0,#0
;;;498    				if (sost_pribl==0)
;;;499    					fz[0]=fiz_vel(average[0],&conf.gr_kal1.tabl1);
;;;500    				else
;;;501    					fz[0]=fiz_vel(average[0],&conf.gr_kal1.tabl2);
;;;502    		else
;;;503    				if (sost_pribl==0)
0000fa  7828              LDRB     r0,[r5,#0]  ; sost_pribl
0000fc  d029              BEQ      |L12.338|
0000fe  2800              CMP      r0,#0
;;;504    					fz[0]=fiz_vel(average[0],&conf.gr_kal2.tabl1);
;;;505    				else
;;;506    					fz[0]=fiz_vel(average[0],&conf.gr_kal2.tabl2);
000100  8838              LDRH     r0,[r7,#0]  ; average
000102  4641              MOV      r1,r8
000104  d02d              BEQ      |L12.354|
000106  3196              ADDS     r1,r1,#0x96
                  |L12.264|
000108  f7fffffe          BL       fiz_vel
;;;507    			
;;;508    	
;;;509    	// находим среднее значение по скользящей средней
;;;510    //		fz_average[0]=moving_average(fz[0],0);
;;;511    				fz_average[0]++;
00010c  49c6              LDR      r1,|L12.1064|
00010e  8030              STRH     r0,[r6,#0]            ;504
;;;512    
;;;513    		// time max
;;;514    		if (time_max>=conf.time_max) {
000110  4fc6              LDR      r7,|L12.1068|
000112  8808              LDRH     r0,[r1,#0]            ;511  ; fz_average
000114  46c3              MOV      r11,r8
000116  1c40              ADDS     r0,r0,#1              ;511
000118  b280              UXTH     r0,r0                 ;511
00011a  8008              STRH     r0,[r1,#0]            ;511
00011c  f8b8200a          LDRH     r2,[r8,#0xa]  ; conf
000120  893b              LDRH     r3,[r7,#8]  ; time_max
000122  429a              CMP      r2,r3
000124  d802              BHI      |L12.300|
;;;515    				max[0]=0;
000126  4ac2              LDR      r2,|L12.1072|
000128  8014              STRH     r4,[r2,#0]
;;;516    				time_max=0;  }
00012a  813c              STRH     r4,[r7,#8]
                  |L12.300|
;;;517    		time_max++;
00012c  893a              LDRH     r2,[r7,#8]  ; time_max
;;;518    		// detect max
;;;519    		if (fz_average[0]>max[0])
00012e  f8df9300          LDR      r9,|L12.1072|
000132  1c52              ADDS     r2,r2,#1              ;517
000134  813a              STRH     r2,[r7,#8]            ;517
000136  f8b91000          LDRH     r1,[r9,#0]  ; max
00013a  4288              CMP      r0,r1
00013c  d901              BLS      |L12.322|
;;;520    			max[0]=fz_average[0];
00013e  f8a90000          STRH     r0,[r9,#0]
                  |L12.322|
;;;521    
;;;522    		
;;;523    		if (number_buff)
000142  48bc              LDR      r0,|L12.1076|
;;;524    			Buf_adc_zap2[por++]=por; //fz_average[0];			
;;;525    		else
;;;526    			Buf_adc_zap1[por++]=por; //fz_average[0];
000144  49bc              LDR      r1,|L12.1080|
000146  7800              LDRB     r0,[r0,#0]            ;523  ; number_buff
000148  2800              CMP      r0,#0                 ;523
00014a  8808              LDRH     r0,[r1,#0]  ; por
00014c  d00b              BEQ      |L12.358|
00014e  4abb              LDR      r2,|L12.1084|
000150  e00a              B        |L12.360|
                  |L12.338|
000152  2800              CMP      r0,#0                 ;498
000154  8838              LDRH     r0,[r7,#0]            ;501  ; average
000156  49a9              LDR      r1,|L12.1020|
000158  d001              BEQ      |L12.350|
00015a  3146              ADDS     r1,r1,#0x46           ;501
00015c  e7d4              B        |L12.264|
                  |L12.350|
00015e  311e              ADDS     r1,r1,#0x1e           ;499
000160  e7d2              B        |L12.264|
                  |L12.354|
000162  316e              ADDS     r1,r1,#0x6e           ;504
000164  e7d0              B        |L12.264|
                  |L12.358|
000166  4ab6              LDR      r2,|L12.1088|
                  |L12.360|
;;;527    		
;;;528    		if (por==999)
000168  f8df82cc          LDR      r8,|L12.1080|
00016c  f8220010          STRH     r0,[r2,r0,LSL #1]     ;526
000170  1c40              ADDS     r0,r0,#1              ;526
000172  8008              STRH     r0,[r1,#0]            ;526
000174  f8b81000          LDRH     r1,[r8,#0]  ; por
000178  f24030e7          MOV      r0,#0x3e7
00017c  4281              CMP      r1,r0
00017e  d101              BNE      |L12.388|
;;;529    			por=999;
000180  f8a80000          STRH     r0,[r8,#0]
                  |L12.388|
;;;530    	
;;;531    	del++;
000184  49af              LDR      r1,|L12.1092|
;;;532    	if (del==10)
;;;533    	{		
;;;534    		// раз в секунду
;;;535    		
;;;536    		del=0;
;;;537    		tick++;
000186  4eb0              LDR      r6,|L12.1096|
000188  8808              LDRH     r0,[r1,#0]            ;531  ; del
00018a  1c40              ADDS     r0,r0,#1              ;531
00018c  b280              UXTH     r0,r0                 ;531
00018e  8008              STRH     r0,[r1,#0]            ;531
000190  280a              CMP      r0,#0xa               ;532
000192  d135              BNE      |L12.512|
000194  800c              STRH     r4,[r1,#0]            ;536
000196  6830              LDR      r0,[r6,#0]  ; tick
;;;538    		time_label=tick;
000198  49ac              LDR      r1,|L12.1100|
00019a  1c40              ADDS     r0,r0,#1              ;537
00019c  6030              STR      r0,[r6,#0]  ; tick
00019e  8008              STRH     r0,[r1,#0]
;;;539    		
;;;540    		rtc_Get(&DT1);
0001a0  48a2              LDR      r0,|L12.1068|
0001a2  300c              ADDS     r0,r0,#0xc
0001a4  f7fffffe          BL       rtc_Get
;;;541    		
;;;542    		if (DT1.Seconds==0)
0001a8  48a0              LDR      r0,|L12.1068|
0001aa  300c              ADDS     r0,r0,#0xc
0001ac  7981              LDRB     r1,[r0,#6]  ; DT1
0001ae  b979              CBNZ     r1,|L12.464|
;;;543    		{
;;;544    			number_buff^=1;
0001b0  48a0              LDR      r0,|L12.1076|
0001b2  7802              LDRB     r2,[r0,#0]  ; number_buff
0001b4  f0820201          EOR      r2,r2,#1
0001b8  7002              STRB     r2,[r0,#0]
;;;545    			DT_zap=DT1;
0001ba  48a5              LDR      r0,|L12.1104|
0001bc  68fa              LDR      r2,[r7,#0xc]  ; DT1
0001be  6002              STR      r2,[r0,#0]  ; DT_zap
0001c0  8a3a              LDRH     r2,[r7,#0x10]  ; DT1
0001c2  8082              STRH     r2,[r0,#4]
0001c4  7181              STRB     r1,[r0,#6]
;;;546    			
;;;547    			buffering=1;
0001c6  49a3              LDR      r1,|L12.1108|
0001c8  f881a000          STRB     r10,[r1,#0]
;;;548    			por=0;
0001cc  f8a84000          STRH     r4,[r8,#0]
                  |L12.464|
;;;549    		}
;;;550    			
;;;551    	 if (tick%2==0)
0001d0  7830              LDRB     r0,[r6,#0]  ; tick
0001d2  07c0              LSLS     r0,r0,#31
;;;552    	 {
;;;553    		 STM_EVAL_LEDOn(LED3);		 
;;;554    //		 STM_EVAL_LEDOn(LED5);		
;;;555    	 }
;;;556    	 else
;;;557    	 {
;;;558    		 STM_EVAL_LEDOff(LED3);	 
0001d4  f04f0001          MOV      r0,#1
0001d8  d00b              BEQ      |L12.498|
0001da  e000              B        |L12.478|
                  |L12.476|
0001dc  e04b              B        |L12.630|
                  |L12.478|
0001de  f7fffffe          BL       STM_EVAL_LEDOff
                  |L12.482|
;;;559    //		 STM_EVAL_LEDOff(LED5);		
;;;560    	 }
;;;561    	 
;;;562    		
;;;563    	if ((tick%60)==0)
0001e2  6830              LDR      r0,[r6,#0]  ; tick
0001e4  213c              MOVS     r1,#0x3c
0001e6  fbb0f2f1          UDIV     r2,r0,r1
0001ea  fb010012          MLS      r0,r1,r2,r0
0001ee  b118              CBZ      r0,|L12.504|
0001f0  e006              B        |L12.512|
                  |L12.498|
0001f2  f7fffffe          BL       STM_EVAL_LEDOn
0001f6  e7f4              B        |L12.482|
                  |L12.504|
;;;564    	{
;;;565    		minute++;
0001f8  4997              LDR      r1,|L12.1112|
0001fa  8808              LDRH     r0,[r1,#0]  ; minute
0001fc  1c40              ADDS     r0,r0,#1
0001fe  8008              STRH     r0,[r1,#0]
                  |L12.512|
;;;566    	}
;;;567    	
;;;568    	// конец раз секунду
;;;569    	 }	
;;;570    	// indicate_lin(0,(u16)fz_average[0], 4096);
;;;571    // indicate(1,(u16)(fz_average[0]/10));
;;;572    	 if (tk_null==1)
000200  7838              LDRB     r0,[r7,#0]  ; tk_null
000202  2801              CMP      r0,#1
000204  d004              BEQ      |L12.528|
;;;573    	 {
;;;574    		 indicate_err(1);   	// tek
;;;575    		 indicate_err(2);			// lineika 
;;;576    		 indicate_err(3);			// maximum
;;;577    	//	 indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes);								//	time	
;;;578    	 }
;;;579    	 else
;;;580    	 {		
;;;581    	 if ((avariya==1)&((tick%2)==0))
000206  4895              LDR      r0,|L12.1116|
000208  7800              LDRB     r0,[r0,#0]  ; avariya
00020a  2801              CMP      r0,#1
00020c  d00a              BEQ      |L12.548|
00020e  e00c              B        |L12.554|
                  |L12.528|
000210  2001              MOVS     r0,#1                 ;574
000212  f7fffffe          BL       indicate_err
000216  2002              MOVS     r0,#2                 ;575
000218  f7fffffe          BL       indicate_err
00021c  2003              MOVS     r0,#3                 ;576
00021e  f7fffffe          BL       indicate_err
000222  e01c              B        |L12.606|
                  |L12.548|
000224  7830              LDRB     r0,[r6,#0]  ; tick
000226  07c0              LSLS     r0,r0,#31
000228  d076              BEQ      |L12.792|
                  |L12.554|
;;;582    	 {
;;;583    			ind_blank_all(1); 
;;;584    			ind_blank_all(2); 
;;;585    			ind_blank_all(3); 
;;;586    	//		ind_blank_all(4); 		 
;;;587    		}
;;;588    		else
;;;589    		{
;;;590    		 // dop usrednenie na vivod indicatorov???
;;;591    		 indicate(2,(u16)(u16)(fz_average[0]),3);   																// tek
00022a  4f7f              LDR      r7,|L12.1064|
00022c  2203              MOVS     r2,#3
00022e  2002              MOVS     r0,#2
000230  8839              LDRH     r1,[r7,#0]  ; fz_average
000232  f7fffffe          BL       indicate
;;;592    
;;;593    			if (conf.tek_gr_kal==0)
000236  f89b1003          LDRB     r1,[r11,#3]  ; conf
00023a  4658              MOV      r0,r11
00023c  2900              CMP      r1,#0
;;;594    					if (sost_pribl==0)
;;;595    						indicate_lin(1,(u16) fz_average[0], (u16) conf.lin.max1, (u16) conf.lin.kol_st);			// lineika 
;;;596    					else
;;;597    						indicate_lin(1,(u16) fz_average[0], (u16) conf.lin.max2, (u16) conf.lin.kol_st);			// lineika 
;;;598    			else
;;;599    					if (sost_pribl==0)
00023e  7829              LDRB     r1,[r5,#0]  ; sost_pribl
000240  d074              BEQ      |L12.812|
;;;600    						indicate_lin(1,(u16) fz_average[0], (u16) conf.lin.max3, (u16) conf.lin.kol_st);			// lineika 
;;;601    					else
;;;602    						indicate_lin(1,(u16) fz_average[0], (u16) conf.lin.max4, (u16) conf.lin.kol_st);			// lineika 
000242  7d03              LDRB     r3,[r0,#0x14]  ; conf
000244  b3f1              CBZ      r1,|L12.708|
000246  f8bb201c          LDRH     r2,[r11,#0x1c]  ; conf
                  |L12.586|
00024a  8839              LDRH     r1,[r7,#0]            ;600  ; fz_average
00024c  2001              MOVS     r0,#1                 ;600
00024e  f7fffffe          BL       indicate_lin
;;;603    		 
;;;604    		 indicate(3,(u16)(max[0]),3);														// maximum
000252  2203              MOVS     r2,#3
000254  f8b91000          LDRH     r1,[r9,#0]  ; max
000258  4610              MOV      r0,r2
00025a  f7fffffe          BL       indicate
                  |L12.606|
;;;605    	 }	
;;;606    	}
;;;607    	if ((tick%2)==0)
00025e  7830              LDRB     r0,[r6,#0]  ; tick
000260  07c0              LSLS     r0,r0,#31
;;;608    			indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes,1);				//	time	
;;;609    	else
;;;610    			indicate_time(4,(u8)DT1.Hours,(u8) DT1.Minutes,0);				//	time	 
000262  4872              LDR      r0,|L12.1068|
000264  f100000c          ADD      r0,r0,#0xc
000268  7942              LDRB     r2,[r0,#5]  ; DT1
00026a  7901              LDRB     r1,[r0,#4]  ; DT1
00026c  d069              BEQ      |L12.834|
00026e  2300              MOVS     r3,#0
                  |L12.624|
000270  2004              MOVS     r0,#4                 ;608
000272  f7fffffe          BL       indicate_time
                  |L12.630|
;;;611     // конец раз в 100 мс
;;;612    	}	
;;;613    	
;;;614    	if (new_komand)
000276  487a              LDR      r0,|L12.1120|
000278  7800              LDRB     r0,[r0,#0]  ; new_komand
00027a  2800              CMP      r0,#0
00027c  d06f              BEQ      |L12.862|
;;;615    	{
;;;616    		u16 tmp=0;
;;;617    	
;;;618    		// wrt_conf
;;;619    		if ((RxBuffer[2]=='w')&(RxBuffer[3]=='r')&(RxBuffer[4]=='t')&(RxBuffer[5]=='_')&(RxBuffer[6]=='c')&(RxBuffer[7]=='o')&(RxBuffer[8]=='n')&(RxBuffer[9]=='f'))
00027e  4a79              LDR      r2,|L12.1124|
000280  7890              LDRB     r0,[r2,#2]  ; RxBuffer
000282  2877              CMP      r0,#0x77
000284  d05f              BEQ      |L12.838|
000286  2000              MOVS     r0,#0
                  |L12.648|
000288  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
00028a  2972              CMP      r1,#0x72
00028c  d05d              BEQ      |L12.842|
00028e  2100              MOVS     r1,#0
                  |L12.656|
000290  4008              ANDS     r0,r0,r1
000292  7911              LDRB     r1,[r2,#4]  ; RxBuffer
000294  2974              CMP      r1,#0x74
000296  d05a              BEQ      |L12.846|
000298  2100              MOVS     r1,#0
                  |L12.666|
00029a  4008              ANDS     r0,r0,r1
00029c  7951              LDRB     r1,[r2,#5]  ; RxBuffer
00029e  295f              CMP      r1,#0x5f
0002a0  d057              BEQ      |L12.850|
0002a2  2100              MOVS     r1,#0
                  |L12.676|
0002a4  4008              ANDS     r0,r0,r1
0002a6  7991              LDRB     r1,[r2,#6]  ; RxBuffer
0002a8  2963              CMP      r1,#0x63
0002aa  d054              BEQ      |L12.854|
0002ac  2100              MOVS     r1,#0
                  |L12.686|
0002ae  4008              ANDS     r0,r0,r1
0002b0  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
0002b2  296f              CMP      r1,#0x6f
0002b4  d051              BEQ      |L12.858|
0002b6  2100              MOVS     r1,#0
                  |L12.696|
0002b8  4008              ANDS     r0,r0,r1
0002ba  7a11              LDRB     r1,[r2,#8]  ; RxBuffer
0002bc  296e              CMP      r1,#0x6e
0002be  d04f              BEQ      |L12.864|
0002c0  2100              MOVS     r1,#0
                  |L12.706|
0002c2  e000              B        |L12.710|
                  |L12.708|
0002c4  e03a              B        |L12.828|
                  |L12.710|
0002c6  4008              ANDS     r0,r0,r1
0002c8  4966              LDR      r1,|L12.1124|
0002ca  7a49              LDRB     r1,[r1,#9]  ; RxBuffer
0002cc  2966              CMP      r1,#0x66
0002ce  d049              BEQ      |L12.868|
0002d0  2100              MOVS     r1,#0
                  |L12.722|
;;;620    		{
;;;621    			u16 i=0;
;;;622    			u8 errors=0;
;;;623    			
;;;624    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
;;;625    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
;;;626    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
;;;627    	
;;;628    		
;;;629    			for (i = 0; i < rxsize-10; i += 2)
;;;630    			{
;;;631    			  tmp1=RxBuffer[i+10];
;;;632    				tmp2=RxBuffer[i+11];
;;;633    				tmp3=0;
;;;634    				if (tmp1>'9')	
;;;635    						tmp3=(tmp1-0x37)<<4;
;;;636    				else
;;;637    						tmp3=(tmp1-0x30)<<4;
;;;638    	
;;;639    				if (tmp2>'9')	
;;;640    						tmp3+=(tmp2-0x37);
;;;641    				else
;;;642    						tmp3+=(tmp2-0x30);				
;;;643    				*(__IO uint8_t *) (BKPSRAM_BASE + (i>>1)) = tmp3;//*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i);
;;;644    				if (*(__IO uint8_t *) (BKPSRAM_BASE + (i>>1)) != tmp3)
;;;645    						errors=1;
;;;646    			}
;;;647    			
;;;648    		//	flash_unlock();
;;;649    			FLASH_Unlock();
;;;650    			FLASH_ClearFlag(FLASH_FLAG_EOP | FLASH_FLAG_OPERR | FLASH_FLAG_WRPERR |FLASH_FLAG_PGAERR | FLASH_FLAG_PGPERR|FLASH_FLAG_PGSERR);
;;;651    			FLASH_EraseSector(ADDR_FLASH,VoltageRange_3);
;;;652    			
;;;653    			
;;;654    			// Program the user Flash area word by word
;;;655    
;;;656    
;;;657    			
;;;658    	//		flash_erase_page(ADDR_FLASH);
;;;659    
;;;660    			for (i = 0; i < rxsize-10; i += 2)
;;;661    			{						
;;;662    				u8 k1, k2, b;					
;;;663    				
;;;664    			  k1=RxBuffer[i+10];
;;;665    				k2=RxBuffer[i+11];
;;;666    				b=0;
;;;667    				if (k1>'9')	
;;;668    						b=(k1-0x37)<<4;
;;;669    				else
;;;670    						b=(k1-0x30)<<4;
;;;671    	
;;;672    				if (k1>'9')	
;;;673    						b+=(k2-0x37);
;;;674    				else
;;;675    						b+=(k2-0x30);					
;;;676    
;;;677    				FLASH_ProgramByte(ADDR_FLASH+(i>>1),(uint8_t) b);
;;;678    			}
;;;679    			
;;;680    //			flash_lock();
;;;681    			  // Lock the Flash to disable the flash control register access
;;;682      //   (recommended to protect the FLASH memory against possible unwanted operation).
;;;683      FLASH_Lock();
;;;684    
;;;685    			if (errors==0)
;;;686    			{
;;;687    			TxBuffer[0]='w';
;;;688    			TxBuffer[1]='r';	
;;;689    			TxBuffer[2]='t';
;;;690    			TxBuffer[3]='_';					
;;;691    			TxBuffer[4]='c';		
;;;692    			TxBuffer[5]='o';	
;;;693    			TxBuffer[6]='n';	
;;;694    			TxBuffer[7]='f';	
;;;695    			TxBuffer[8]='_';	
;;;696    			TxBuffer[9]='o';
;;;697    			TxBuffer[10]='k';	
;;;698    			}
;;;699    			else
;;;700    			{
;;;701    				TxBuffer[0]='w';
;;;702    				TxBuffer[1]='r';	
;;;703    				TxBuffer[2]='t';
;;;704    				TxBuffer[3]='_';					
;;;705    				TxBuffer[4]='c';		
;;;706    				TxBuffer[5]='o';	
;;;707    				TxBuffer[6]='n';	
;;;708    				TxBuffer[7]='f';	
;;;709    				TxBuffer[8]='_';	
;;;710    				TxBuffer[9]='e';
;;;711    				TxBuffer[10]='r';	
;;;712    			}
;;;713    	
;;;714    			txsize=11;
;;;715    			tekper=0;
0002d2  f8dfa194          LDR      r10,|L12.1128|
0002d6  f8df9194          LDR      r9,|L12.1132|
0002da  4f65              LDR      r7,|L12.1136|
0002dc  4208              TST      r0,r1                 ;619
0002de  d079              BEQ      |L12.980|
0002e0  2600              MOVS     r6,#0                 ;621
0002e2  46b0              MOV      r8,r6                 ;622
0002e4  4632              MOV      r2,r6                 ;624
0002e6  f2405125          MOV      r1,#0x525             ;624
0002ea  4648              MOV      r0,r9                 ;624
0002ec  f7fffffe          BL       USART_ITConfig
0002f0  2201              MOVS     r2,#1                 ;625
0002f2  f2406126          MOV      r1,#0x626             ;625
0002f6  4648              MOV      r0,r9                 ;625
0002f8  f7fffffe          BL       USART_ITConfig
0002fc  2201              MOVS     r2,#1                 ;626
0002fe  2108              MOVS     r1,#8                 ;626
000300  485c              LDR      r0,|L12.1140|
000302  f7fffffe          BL       GPIO_WriteBit
000306  4b5c              LDR      r3,|L12.1144|
000308  f8dfc170          LDR      r12,|L12.1148|
00030c  495c              LDR      r1,|L12.1152|
00030e  f8dfb174          LDR      r11,|L12.1156|
000312  e04d              B        |L12.944|
000314  e000              B        |L12.792|
000316  e009              B        |L12.812|
                  |L12.792|
000318  2001              MOVS     r0,#1                 ;583
00031a  f7fffffe          BL       ind_blank_all
00031e  2002              MOVS     r0,#2                 ;584
000320  f7fffffe          BL       ind_blank_all
000324  2003              MOVS     r0,#3                 ;585
000326  f7fffffe          BL       ind_blank_all
00032a  e798              B        |L12.606|
                  |L12.812|
00032c  7d03              LDRB     r3,[r0,#0x14]         ;597  ; conf
00032e  b111              CBZ      r1,|L12.822|
000330  f8bb2018          LDRH     r2,[r11,#0x18]        ;597  ; conf
000334  e789              B        |L12.586|
                  |L12.822|
000336  f8bb2016          LDRH     r2,[r11,#0x16]        ;595  ; conf
00033a  e786              B        |L12.586|
                  |L12.828|
00033c  f8bb201a          LDRH     r2,[r11,#0x1a]        ;600  ; conf
000340  e783              B        |L12.586|
                  |L12.834|
000342  2301              MOVS     r3,#1                 ;608
000344  e794              B        |L12.624|
                  |L12.838|
000346  2001              MOVS     r0,#1                 ;619
000348  e79e              B        |L12.648|
                  |L12.842|
00034a  2101              MOVS     r1,#1                 ;619
00034c  e7a0              B        |L12.656|
                  |L12.846|
00034e  2101              MOVS     r1,#1                 ;619
000350  e7a3              B        |L12.666|
                  |L12.850|
000352  2101              MOVS     r1,#1                 ;619
000354  e7a6              B        |L12.676|
                  |L12.854|
000356  2101              MOVS     r1,#1                 ;619
000358  e7a9              B        |L12.686|
                  |L12.858|
00035a  2101              MOVS     r1,#1                 ;619
00035c  e7ac              B        |L12.696|
                  |L12.862|
00035e  e3ef              B        |L12.2880|
                  |L12.864|
000360  2101              MOVS     r1,#1                 ;619
000362  e7ae              B        |L12.706|
                  |L12.868|
000364  2101              MOVS     r1,#1                 ;619
000366  e7b4              B        |L12.722|
                  |L12.872|
000368  483e              LDR      r0,|L12.1124|
00036a  4430              ADD      r0,r0,r6              ;631
00036c  7a82              LDRB     r2,[r0,#0xa]          ;631
00036e  701a              STRB     r2,[r3,#0]            ;631
000370  7ac0              LDRB     r0,[r0,#0xb]          ;632
000372  f88c0000          STRB     r0,[r12,#0]           ;632
000376  2a39              CMP      r2,#0x39              ;634
000378  700c              STRB     r4,[r1,#0]            ;633
00037a  ea4f1202          LSL      r2,r2,#4              ;637
00037e  d901              BLS      |L12.900|
000380  f5a2725c          SUB      r2,r2,#0x370          ;635
                  |L12.900|
000384  700a              STRB     r2,[r1,#0]            ;637
000386  2839              CMP      r0,#0x39              ;639
000388  b2d2              UXTB     r2,r2                 ;642
00038a  4410              ADD      r0,r0,r2              ;642
00038c  d901              BLS      |L12.914|
00038e  3837              SUBS     r0,r0,#0x37           ;640
000390  e000              B        |L12.916|
                  |L12.914|
000392  3830              SUBS     r0,r0,#0x30           ;642
                  |L12.916|
000394  7008              STRB     r0,[r1,#0]            ;642
000396  b2c2              UXTB     r2,r0                 ;643
000398  483b              LDR      r0,|L12.1160|
00039a  eb000056          ADD      r0,r0,r6,LSR #1       ;643
00039e  7002              STRB     r2,[r0,#0]            ;643
0003a0  7800              LDRB     r0,[r0,#0]            ;644
0003a2  780a              LDRB     r2,[r1,#0]            ;644  ; tmp3
0003a4  4290              CMP      r0,r2                 ;644
0003a6  d001              BEQ      |L12.940|
0003a8  f04f0801          MOV      r8,#1                 ;645
                  |L12.940|
0003ac  1cb6              ADDS     r6,r6,#2              ;629
0003ae  b2b6              UXTH     r6,r6                 ;629
                  |L12.944|
0003b0  f8bb0000          LDRH     r0,[r11,#0]           ;629  ; rxsize
0003b4  380a              SUBS     r0,r0,#0xa            ;629
0003b6  4286              CMP      r6,r0                 ;629
0003b8  dbd6              BLT      |L12.872|
0003ba  f7fffffe          BL       FLASH_Unlock
0003be  20f3              MOVS     r0,#0xf3              ;650
0003c0  f7fffffe          BL       FLASH_ClearFlag
0003c4  2102              MOVS     r1,#2                 ;651
0003c6  4831              LDR      r0,|L12.1164|
0003c8  f7fffffe          BL       FLASH_EraseSector
0003cc  2600              MOVS     r6,#0                 ;660
0003ce  f8dfb094          LDR      r11,|L12.1124|
0003d2  e067              B        |L12.1188|
                  |L12.980|
0003d4  e08e              B        |L12.1268|
                  |L12.982|
0003d6  eb0b0106          ADD      r1,r11,r6             ;664
0003da  7a88              LDRB     r0,[r1,#0xa]          ;664
0003dc  7ac9              LDRB     r1,[r1,#0xb]          ;665
0003de  2839              CMP      r0,#0x39              ;667
0003e0  ea4f1000          LSL      r0,r0,#4              ;670
0003e4  d954              BLS      |L12.1168|
0003e6  f5a0705c          SUB      r0,r0,#0x370          ;668
0003ea  4408              ADD      r0,r0,r1              ;673
0003ec  3837              SUBS     r0,r0,#0x37           ;673
0003ee  e051              B        |L12.1172|
                  |L12.1008|
                          DCD      0x40020810
                  |L12.1012|
                          DCD      kol_pribl_vkl
                  |L12.1016|
                          DCD      kol_pribl_vikl
                  |L12.1020|
                          DCD      conf
                  |L12.1024|
                          DCD      0x40021000
                  |L12.1028|
                          DCD      0x40020000
                  |L12.1032|
                          DCD      sost_pribl
                  |L12.1036|
                          DCD      kol_gr1_vkl
                  |L12.1040|
                          DCD      kol_gr2_vkl
                  |L12.1044|
                          DCD      ||fz||
                  |L12.1048|
                          DCD      summa
                  |L12.1052|
                          DCD      ADC3ConvertedValue
                  |L12.1056|
                          DCD      kol_average
                  |L12.1060|
                          DCD      average
                  |L12.1064|
                          DCD      fz_average
                  |L12.1068|
                          DCD      ||.data||
                  |L12.1072|
                          DCD      max
                  |L12.1076|
                          DCD      number_buff
                  |L12.1080|
                          DCD      por
                  |L12.1084|
                          DCD      Buf_adc_zap2
                  |L12.1088|
                          DCD      Buf_adc_zap1
                  |L12.1092|
                          DCD      ||del||
                  |L12.1096|
                          DCD      tick
                  |L12.1100|
                          DCD      time_label
                  |L12.1104|
                          DCD      DT_zap
                  |L12.1108|
                          DCD      buffering
                  |L12.1112|
                          DCD      minute
                  |L12.1116|
                          DCD      avariya
                  |L12.1120|
                          DCD      new_komand
                  |L12.1124|
                          DCD      RxBuffer
                  |L12.1128|
                          DCD      tekper
                  |L12.1132|
                          DCD      0x40004400
                  |L12.1136|
                          DCD      TxBuffer
                  |L12.1140|
                          DCD      0x40020c00
                  |L12.1144|
                          DCD      tmp1
                  |L12.1148|
                          DCD      tmp2
                  |L12.1152|
                          DCD      tmp3
                  |L12.1156|
                          DCD      rxsize
                  |L12.1160|
                          DCD      0x40024000
                  |L12.1164|
                          DCD      0x0800c000
                  |L12.1168|
000490  4408              ADD      r0,r0,r1              ;675
000492  3830              SUBS     r0,r0,#0x30           ;675
                  |L12.1172|
000494  b2c1              UXTB     r1,r0                 ;675
000496  48fe              LDR      r0,|L12.2192|
000498  eb000056          ADD      r0,r0,r6,LSR #1       ;677
00049c  f7fffffe          BL       FLASH_ProgramByte
0004a0  1cb6              ADDS     r6,r6,#2              ;660
0004a2  b2b6              UXTH     r6,r6                 ;660
                  |L12.1188|
0004a4  48fb              LDR      r0,|L12.2196|
0004a6  8800              LDRH     r0,[r0,#0]            ;660  ; rxsize
0004a8  380a              SUBS     r0,r0,#0xa            ;660
0004aa  4286              CMP      r6,r0                 ;660
0004ac  db93              BLT      |L12.982|
0004ae  f7fffffe          BL       FLASH_Lock
0004b2  2077              MOVS     r0,#0x77              ;619
0004b4  7038              STRB     r0,[r7,#0]            ;701
0004b6  2163              MOVS     r1,#0x63              ;619
0004b8  226e              MOVS     r2,#0x6e              ;619
0004ba  2366              MOVS     r3,#0x66              ;619
0004bc  f04f0072          MOV      r0,#0x72              ;702
0004c0  f1b80f00          CMP      r8,#0                 ;685
0004c4  7078              STRB     r0,[r7,#1]            ;702
0004c6  d07d              BEQ      |L12.1476|
0004c8  2674              MOVS     r6,#0x74              ;703
0004ca  70be              STRB     r6,[r7,#2]            ;703
0004cc  265f              MOVS     r6,#0x5f              ;704
0004ce  70fe              STRB     r6,[r7,#3]            ;704
0004d0  7139              STRB     r1,[r7,#4]            ;705
0004d2  216f              MOVS     r1,#0x6f              ;706
0004d4  7179              STRB     r1,[r7,#5]            ;706
0004d6  71ba              STRB     r2,[r7,#6]            ;707
0004d8  71fb              STRB     r3,[r7,#7]            ;708
0004da  723e              STRB     r6,[r7,#8]            ;709
0004dc  2165              MOVS     r1,#0x65              ;710
0004de  7279              STRB     r1,[r7,#9]            ;710
                  |L12.1248|
0004e0  49ed              LDR      r1,|L12.2200|
0004e2  72b8              STRB     r0,[r7,#0xa]          ;711
0004e4  200b              MOVS     r0,#0xb               ;714
0004e6  8008              STRH     r0,[r1,#0]            ;714
0004e8  f8aa4000          STRH     r4,[r10,#0]
;;;716    			USART_SendData(USART2, 0x3A);
0004ec  213a              MOVS     r1,#0x3a
0004ee  4648              MOV      r0,r9
0004f0  f7fffffe          BL       USART_SendData
                  |L12.1268|
;;;717    		}
;;;718    
;;;719    		// who?
;;;720    		if ((RxBuffer[2]=='w')&(RxBuffer[3]=='h')&(RxBuffer[4]=='o')&(RxBuffer[5]=='?'))
0004f4  4ee9              LDR      r6,|L12.2204|
0004f6  78b0              LDRB     r0,[r6,#2]  ; RxBuffer
0004f8  2877              CMP      r0,#0x77
0004fa  d07d              BEQ      |L12.1528|
0004fc  2000              MOVS     r0,#0
                  |L12.1278|
0004fe  78f1              LDRB     r1,[r6,#3]  ; RxBuffer
000500  2968              CMP      r1,#0x68
000502  d07a              BEQ      |L12.1530|
000504  2100              MOVS     r1,#0
                  |L12.1286|
000506  4008              ANDS     r0,r0,r1
000508  7931              LDRB     r1,[r6,#4]  ; RxBuffer
00050a  296f              CMP      r1,#0x6f
00050c  d076              BEQ      |L12.1532|
00050e  2100              MOVS     r1,#0
                  |L12.1296|
000510  4008              ANDS     r0,r0,r1
000512  7971              LDRB     r1,[r6,#5]  ; RxBuffer
000514  293f              CMP      r1,#0x3f
000516  d072              BEQ      |L12.1534|
000518  2100              MOVS     r1,#0
                  |L12.1306|
00051a  4208              TST      r0,r1
;;;721    		{
;;;722    			
;;;723    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
;;;724    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
;;;725    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
;;;726    			
;;;727    			TxBuffer[0]='u';
;;;728    			TxBuffer[1]='s';	
;;;729    			TxBuffer[2]='o';
;;;730    			TxBuffer[3]='_';					
;;;731    			TxBuffer[4]='a';		
00051c  f04f0b61          MOV      r11,#0x61
000520  f04f0873          MOV      r8,#0x73              ;728
000524  d02e              BEQ      |L12.1412|
000526  2200              MOVS     r2,#0                 ;723
000528  f2405125          MOV      r1,#0x525             ;723
00052c  4648              MOV      r0,r9                 ;723
00052e  f7fffffe          BL       USART_ITConfig
000532  2201              MOVS     r2,#1                 ;724
000534  f2406126          MOV      r1,#0x626             ;724
000538  4648              MOV      r0,r9                 ;724
00053a  f7fffffe          BL       USART_ITConfig
00053e  2201              MOVS     r2,#1                 ;725
000540  2108              MOVS     r1,#8                 ;725
000542  48d7              LDR      r0,|L12.2208|
000544  f7fffffe          BL       GPIO_WriteBit
000548  2075              MOVS     r0,#0x75              ;727
00054a  7038              STRB     r0,[r7,#0]            ;727
00054c  f8878001          STRB     r8,[r7,#1]            ;728
000550  206f              MOVS     r0,#0x6f              ;729
000552  70b8              STRB     r0,[r7,#2]            ;729
000554  205f              MOVS     r0,#0x5f              ;730
000556  70f8              STRB     r0,[r7,#3]            ;730
000558  f887b004          STRB     r11,[r7,#4]
;;;732    			TxBuffer[5]='r';	
00055c  2172              MOVS     r1,#0x72
00055e  7179              STRB     r1,[r7,#5]
;;;733    			TxBuffer[6]='m';	
000560  216d              MOVS     r1,#0x6d
000562  71b9              STRB     r1,[r7,#6]
;;;734    			TxBuffer[7]='_';	
000564  71f8              STRB     r0,[r7,#7]
;;;735    			TxBuffer[8]='k';	
000566  206b              MOVS     r0,#0x6b
000568  7238              STRB     r0,[r7,#8]
;;;736    			TxBuffer[9]='e';
00056a  2065              MOVS     r0,#0x65
00056c  7278              STRB     r0,[r7,#9]
;;;737    			TxBuffer[10]='y';	
00056e  2079              MOVS     r0,#0x79
;;;738    	
;;;739    			txsize=11;
000570  49c9              LDR      r1,|L12.2200|
000572  72b8              STRB     r0,[r7,#0xa]          ;737
000574  200b              MOVS     r0,#0xb
000576  8008              STRH     r0,[r1,#0]
;;;740    			tekper=0;
000578  f8aa4000          STRH     r4,[r10,#0]
;;;741    			USART_SendData(USART2, 0x3A);
00057c  213a              MOVS     r1,#0x3a
00057e  4648              MOV      r0,r9
000580  f7fffffe          BL       USART_SendData
                  |L12.1412|
;;;742    		}
;;;743    	
;;;744    		// restart
;;;745    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='e')&(RxBuffer[4]=='s')&(RxBuffer[5]=='t')&(RxBuffer[6]=='a')&(RxBuffer[7]=='r')&(RxBuffer[8]=='t'))
000584  78b0              LDRB     r0,[r6,#2]  ; RxBuffer
000586  2872              CMP      r0,#0x72
000588  d07e              BEQ      |L12.1672|
00058a  2000              MOVS     r0,#0
                  |L12.1420|
00058c  78f1              LDRB     r1,[r6,#3]  ; RxBuffer
00058e  2965              CMP      r1,#0x65
000590  d07b              BEQ      |L12.1674|
000592  2100              MOVS     r1,#0
                  |L12.1428|
000594  4008              ANDS     r0,r0,r1
000596  7931              LDRB     r1,[r6,#4]  ; RxBuffer
000598  2973              CMP      r1,#0x73
00059a  d077              BEQ      |L12.1676|
00059c  2100              MOVS     r1,#0
                  |L12.1438|
00059e  4008              ANDS     r0,r0,r1
0005a0  7971              LDRB     r1,[r6,#5]  ; RxBuffer
0005a2  2974              CMP      r1,#0x74
0005a4  d073              BEQ      |L12.1678|
0005a6  2100              MOVS     r1,#0
                  |L12.1448|
0005a8  4008              ANDS     r0,r0,r1
0005aa  79b1              LDRB     r1,[r6,#6]  ; RxBuffer
0005ac  2961              CMP      r1,#0x61
0005ae  d06f              BEQ      |L12.1680|
0005b0  2100              MOVS     r1,#0
                  |L12.1458|
0005b2  4008              ANDS     r0,r0,r1
0005b4  79f1              LDRB     r1,[r6,#7]  ; RxBuffer
0005b6  2972              CMP      r1,#0x72
0005b8  d06b              BEQ      |L12.1682|
0005ba  2100              MOVS     r1,#0
                  |L12.1468|
0005bc  4008              ANDS     r0,r0,r1
0005be  7a31              LDRB     r1,[r6,#8]  ; RxBuffer
0005c0  2974              CMP      r1,#0x74
0005c2  e000              B        |L12.1478|
                  |L12.1476|
0005c4  e0fb              B        |L12.1982|
                  |L12.1478|
0005c6  d07d              BEQ      |L12.1732|
0005c8  2100              MOVS     r1,#0
                  |L12.1482|
0005ca  4208              TST      r0,r1
0005cc  d033              BEQ      |L12.1590|
;;;746    		{
;;;747    			
;;;748    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
0005ce  2200              MOVS     r2,#0
0005d0  f2405125          MOV      r1,#0x525
0005d4  4648              MOV      r0,r9
0005d6  f7fffffe          BL       USART_ITConfig
;;;749    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
0005da  2201              MOVS     r2,#1
0005dc  f2406126          MOV      r1,#0x626
0005e0  4648              MOV      r0,r9
0005e2  f7fffffe          BL       USART_ITConfig
;;;750    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
0005e6  2201              MOVS     r2,#1
0005e8  2108              MOVS     r1,#8
0005ea  48ad              LDR      r0,|L12.2208|
0005ec  f7fffffe          BL       GPIO_WriteBit
;;;751    			
;;;752    			TxBuffer[0]='r';
0005f0  2172              MOVS     r1,#0x72
0005f2  7039              STRB     r1,[r7,#0]
;;;753    			TxBuffer[1]='e';	
0005f4  2065              MOVS     r0,#0x65
0005f6  e003              B        |L12.1536|
                  |L12.1528|
0005f8  e0ee              B        |L12.2008|
                  |L12.1530|
0005fa  e0ef              B        |L12.2012|
                  |L12.1532|
0005fc  e0f0              B        |L12.2016|
                  |L12.1534|
0005fe  e0f1              B        |L12.2020|
                  |L12.1536|
000600  7078              STRB     r0,[r7,#1]
;;;754    			TxBuffer[2]='s';
000602  f8878002          STRB     r8,[r7,#2]
;;;755    			TxBuffer[3]='t';					
000606  2074              MOVS     r0,#0x74
000608  70f8              STRB     r0,[r7,#3]
;;;756    			TxBuffer[4]='a';		
00060a  f887b004          STRB     r11,[r7,#4]
;;;757    			TxBuffer[5]='r';	
00060e  7179              STRB     r1,[r7,#5]
;;;758    			TxBuffer[6]='t';	
000610  71b8              STRB     r0,[r7,#6]
;;;759    			TxBuffer[7]='_';	
000612  205f              MOVS     r0,#0x5f
000614  71f8              STRB     r0,[r7,#7]
;;;760    			TxBuffer[8]='o';	
000616  206f              MOVS     r0,#0x6f
000618  7238              STRB     r0,[r7,#8]
;;;761    			TxBuffer[9]='k';
00061a  206b              MOVS     r0,#0x6b
;;;762    	
;;;763    			txsize=10;
00061c  499e              LDR      r1,|L12.2200|
00061e  7278              STRB     r0,[r7,#9]            ;761
000620  200a              MOVS     r0,#0xa
000622  8008              STRH     r0,[r1,#0]
;;;764    			tekper=0;
000624  f8aa4000          STRH     r4,[r10,#0]
;;;765    			USART_SendData(USART2, 0x3A);
000628  213a              MOVS     r1,#0x3a
00062a  4648              MOV      r0,r9
00062c  f7fffffe          BL       USART_SendData
;;;766    			
;;;767    			SCB->AIRCR = 0x05FA0004;
000630  499d              LDR      r1,|L12.2216|
000632  489c              LDR      r0,|L12.2212|
000634  6008              STR      r0,[r1,#0]
                  |L12.1590|
;;;768    			
;;;769    			
;;;770    			
;;;771    			// need restart
;;;772    		}
;;;773    	
;;;774    		// set_time
;;;775    		if ((RxBuffer[2]=='s')&(RxBuffer[3]=='e')&(RxBuffer[4]=='t')&(RxBuffer[5]=='_')&(RxBuffer[6]=='t')&(RxBuffer[7]=='i')&(RxBuffer[8]=='m')&(RxBuffer[9]=='e'))
000636  78b0              LDRB     r0,[r6,#2]  ; RxBuffer
000638  2873              CMP      r0,#0x73
00063a  d07c              BEQ      |L12.1846|
00063c  2000              MOVS     r0,#0
                  |L12.1598|
00063e  78f1              LDRB     r1,[r6,#3]  ; RxBuffer
000640  2965              CMP      r1,#0x65
000642  d079              BEQ      |L12.1848|
000644  2100              MOVS     r1,#0
                  |L12.1606|
000646  4008              ANDS     r0,r0,r1
000648  7931              LDRB     r1,[r6,#4]  ; RxBuffer
00064a  2974              CMP      r1,#0x74
00064c  d075              BEQ      |L12.1850|
00064e  2100              MOVS     r1,#0
                  |L12.1616|
000650  4008              ANDS     r0,r0,r1
000652  7971              LDRB     r1,[r6,#5]  ; RxBuffer
000654  295f              CMP      r1,#0x5f
000656  d071              BEQ      |L12.1852|
000658  2100              MOVS     r1,#0
                  |L12.1626|
00065a  4008              ANDS     r0,r0,r1
00065c  79b1              LDRB     r1,[r6,#6]  ; RxBuffer
00065e  2974              CMP      r1,#0x74
000660  d06d              BEQ      |L12.1854|
000662  2100              MOVS     r1,#0
                  |L12.1636|
000664  4008              ANDS     r0,r0,r1
000666  79f1              LDRB     r1,[r6,#7]  ; RxBuffer
000668  2969              CMP      r1,#0x69
00066a  d069              BEQ      |L12.1856|
00066c  2100              MOVS     r1,#0
                  |L12.1646|
00066e  4008              ANDS     r0,r0,r1
000670  7a31              LDRB     r1,[r6,#8]  ; RxBuffer
000672  296d              CMP      r1,#0x6d
000674  d065              BEQ      |L12.1858|
000676  2100              MOVS     r1,#0
                  |L12.1656|
000678  4008              ANDS     r0,r0,r1
00067a  7a71              LDRB     r1,[r6,#9]  ; RxBuffer
00067c  2965              CMP      r1,#0x65
00067e  d07d              BEQ      |L12.1916|
000680  2100              MOVS     r1,#0
                  |L12.1666|
000682  4208              TST      r0,r1
000684  d07b              BEQ      |L12.1918|
;;;776    		{		
;;;777    			extern void rtc_SetDate(uint8_t Day, uint8_t Month, uint8_t Year, uint8_t DayOfWeek);
;;;778    			extern  void rtc_SetTime(uint8_t Hours, uint8_t Minutes, uint8_t Seconds);
;;;779    			extern  void rtc_Unlock(void);
;;;780    			extern void rtc_Lock(void);
;;;781    			
;;;782    			uint32_t Tens, Units;
;;;783          uint32_t TempReg = 0;
;;;784    			u8 i=0;
;;;785    			
;;;786    			
;;;787    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
000686  e005              B        |L12.1684|
                  |L12.1672|
000688  e0ae              B        |L12.2024|
                  |L12.1674|
00068a  e0af              B        |L12.2028|
                  |L12.1676|
00068c  e0b0              B        |L12.2032|
                  |L12.1678|
00068e  e0b1              B        |L12.2036|
                  |L12.1680|
000690  e0b2              B        |L12.2040|
                  |L12.1682|
000692  e0b3              B        |L12.2044|
                  |L12.1684|
000694  2200              MOVS     r2,#0
000696  f2405125          MOV      r1,#0x525
00069a  4648              MOV      r0,r9
00069c  f7fffffe          BL       USART_ITConfig
;;;788    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
0006a0  2201              MOVS     r2,#1
0006a2  f2406126          MOV      r1,#0x626
0006a6  4648              MOV      r0,r9
0006a8  f7fffffe          BL       USART_ITConfig
;;;789    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
0006ac  2201              MOVS     r2,#1
0006ae  2108              MOVS     r1,#8
0006b0  487b              LDR      r0,|L12.2208|
0006b2  f7fffffe          BL       GPIO_WriteBit
;;;790    
;;;791    
;;;792    			// set time
;;;793    		rtc_Unlock();
0006b6  f7fffffe          BL       rtc_Unlock
;;;794    		RTC->ISR |= RTC_ISR_INIT;
0006ba  487c              LDR      r0,|L12.2220|
0006bc  6801              LDR      r1,[r0,#0]
0006be  f0410180          ORR      r1,r1,#0x80
0006c2  e000              B        |L12.1734|
                  |L12.1732|
0006c4  e09c              B        |L12.2048|
                  |L12.1734|
0006c6  6001              STR      r1,[r0,#0]
0006c8  4683              MOV      r11,r0
                  |L12.1738|
;;;795    		while(!(RTC->ISR & RTC_ISR_INITF)) {}
0006ca  f8db0000          LDR      r0,[r11,#0]
0006ce  0640              LSLS     r0,r0,#25
0006d0  d5fb              BPL      |L12.1738|
;;;796    
;;;797    		RTC->PRER = 263; //Sync;         
0006d2  4876              LDR      r0,|L12.2220|
0006d4  f2401107          MOV      r1,#0x107
0006d8  1d00              ADDS     r0,r0,#4
0006da  6001              STR      r1,[r0,#0]
;;;798        RTC->PRER =263 | (127<<16); //Sync | (Async << 16);
0006dc  4974              LDR      r1,|L12.2224|
0006de  6001              STR      r1,[r0,#0]
;;;799    			
;;;800    			
;;;801    			TxBuffer[0]='s';
0006e0  f8878000          STRB     r8,[r7,#0]
;;;802    			TxBuffer[1]='e';	
0006e4  2165              MOVS     r1,#0x65
0006e6  7079              STRB     r1,[r7,#1]
;;;803    			TxBuffer[2]='t';
0006e8  2074              MOVS     r0,#0x74
0006ea  70b8              STRB     r0,[r7,#2]
;;;804    			TxBuffer[3]='_';					
0006ec  225f              MOVS     r2,#0x5f
0006ee  70fa              STRB     r2,[r7,#3]
;;;805    			TxBuffer[4]='t';		
0006f0  7138              STRB     r0,[r7,#4]
;;;806    			TxBuffer[5]='i';	
0006f2  2069              MOVS     r0,#0x69
0006f4  7178              STRB     r0,[r7,#5]
;;;807    			TxBuffer[6]='m';	
0006f6  206d              MOVS     r0,#0x6d
0006f8  71b8              STRB     r0,[r7,#6]
;;;808    			TxBuffer[7]='e';	
0006fa  71f9              STRB     r1,[r7,#7]
;;;809    			TxBuffer[8]='_';	
0006fc  723a              STRB     r2,[r7,#8]
;;;810    			TxBuffer[9]='o';
0006fe  206f              MOVS     r0,#0x6f
000700  7278              STRB     r0,[r7,#9]
;;;811    			TxBuffer[10]='k';
000702  206b              MOVS     r0,#0x6b
000704  72b8              STRB     r0,[r7,#0xa]
;;;812    			
;;;813    
;;;814        // set time
;;;815    rtc_SetTime((RxBuffer[16]-0x30)*10+(RxBuffer[17]-0x30), (RxBuffer[18]-0x30)*10+(RxBuffer[19]-0x30), (RxBuffer[20]-0x30)*10+(RxBuffer[21]-0x30));
000706  7d30              LDRB     r0,[r6,#0x14]  ; RxBuffer
000708  7d71              LDRB     r1,[r6,#0x15]  ; RxBuffer
00070a  3830              SUBS     r0,r0,#0x30
00070c  eb000280          ADD      r2,r0,r0,LSL #2
000710  f06f082f          MVN      r8,#0x2f
000714  eb080042          ADD      r0,r8,r2,LSL #1
000718  4408              ADD      r0,r0,r1
00071a  b2c2              UXTB     r2,r0
00071c  7cb0              LDRB     r0,[r6,#0x12]  ; RxBuffer
00071e  7cf1              LDRB     r1,[r6,#0x13]  ; RxBuffer
000720  3830              SUBS     r0,r0,#0x30
000722  eb000380          ADD      r3,r0,r0,LSL #2
000726  eb080043          ADD      r0,r8,r3,LSL #1
00072a  4408              ADD      r0,r0,r1
00072c  b2c1              UXTB     r1,r0
00072e  7c30              LDRB     r0,[r6,#0x10]  ; RxBuffer
000730  7c73              LDRB     r3,[r6,#0x11]  ; RxBuffer
000732  3830              SUBS     r0,r0,#0x30
000734  e006              B        |L12.1860|
                  |L12.1846|
000736  e065              B        |L12.2052|
                  |L12.1848|
000738  e066              B        |L12.2056|
                  |L12.1850|
00073a  e067              B        |L12.2060|
                  |L12.1852|
00073c  e068              B        |L12.2064|
                  |L12.1854|
00073e  e069              B        |L12.2068|
                  |L12.1856|
000740  e06a              B        |L12.2072|
                  |L12.1858|
000742  e06b              B        |L12.2076|
                  |L12.1860|
000744  eb000c80          ADD      r12,r0,r0,LSL #2
000748  eb08004c          ADD      r0,r8,r12,LSL #1
00074c  4418              ADD      r0,r0,r3
00074e  b2c0              UXTB     r0,r0
000750  f7fffffe          BL       rtc_SetTime
;;;816    
;;;817    rtc_SetDate((RxBuffer[10]-0x30)*10+(RxBuffer[11]-0x30), (RxBuffer[12]-0x30)*10+(RxBuffer[13]-0x30), (RxBuffer[14]-0x30)*10+(RxBuffer[15]-0x30),1);
000754  7bb0              LDRB     r0,[r6,#0xe]  ; RxBuffer
000756  7bf1              LDRB     r1,[r6,#0xf]  ; RxBuffer
000758  3830              SUBS     r0,r0,#0x30
00075a  eb000280          ADD      r2,r0,r0,LSL #2
00075e  eb080042          ADD      r0,r8,r2,LSL #1
000762  4408              ADD      r0,r0,r1
000764  b2c2              UXTB     r2,r0
000766  7b30              LDRB     r0,[r6,#0xc]  ; RxBuffer
000768  7b71              LDRB     r1,[r6,#0xd]  ; RxBuffer
00076a  3830              SUBS     r0,r0,#0x30
00076c  eb000380          ADD      r3,r0,r0,LSL #2
000770  eb080043          ADD      r0,r8,r3,LSL #1
000774  4408              ADD      r0,r0,r1
000776  b2c1              UXTB     r1,r0
000778  7af3              LDRB     r3,[r6,#0xb]  ; RxBuffer
00077a  e001              B        |L12.1920|
                  |L12.1916|
00077c  e050              B        |L12.2080|
                  |L12.1918|
00077e  e069              B        |L12.2132|
                  |L12.1920|
000780  7ab0              LDRB     r0,[r6,#0xa]  ; RxBuffer
000782  3830              SUBS     r0,r0,#0x30
000784  eb000c80          ADD      r12,r0,r0,LSL #2
000788  eb08004c          ADD      r0,r8,r12,LSL #1
00078c  4418              ADD      r0,r0,r3
00078e  b2c0              UXTB     r0,r0
000790  2301              MOVS     r3,#1
000792  f7fffffe          BL       rtc_SetDate
;;;818    /*
;;;819    if (1)
;;;820    {
;;;821    
;;;822        TempReg = 0;
;;;823        {
;;;824            Tens  = ((RxBuffer[10]-0x30) / 10) & 0x0f;          // ??????? ???
;;;825            Units = (RxBuffer[11]-0x30) & 0x0f; // ??????? ???
;;;826            
;;;827            TempReg |= (Tens  << 20); // YT, 20
;;;828            TempReg |= (Units << 16); // YU, 16
;;;829        }
;;;830        {
;;;831            Tens  = (RxBuffer[12]-0x30) & 0x01;          // ??????? ???????
;;;832            Units = (RxBuffer[13]-0x30) & 0x0f; // ??????? ???????
;;;833            
;;;834            TempReg |= (Tens  << 12); // MT, 12
;;;835            TempReg |= (Units << 8);  // MU, 8
;;;836        }
;;;837        {
;;;838            Tens  = (RxBuffer[14]-0x30) & 0x03;          // ??????? ????
;;;839            Units = (RxBuffer[15]-0x30) & 0x0f; // ??????? ????
;;;840            
;;;841            TempReg |= (Tens  << 4); // DT, 4
;;;842            TempReg |= (Units << 0);  // DU, 0
;;;843        }
;;;844        {
;;;845            TempReg |= ((1 & 0x07) << 13); // WDU, 13
;;;846        }
;;;847        RTC->DR = TempReg;	
;;;848    	}	
;;;849    */
;;;850    		RTC->CR |= RTC_CR_FMT;
000796  4845              LDR      r0,|L12.2220|
000798  1f00              SUBS     r0,r0,#4
00079a  6801              LDR      r1,[r0,#0]
00079c  f0410140          ORR      r1,r1,#0x40
0007a0  6001              STR      r1,[r0,#0]
;;;851        RTC->ISR &= ~RTC_ISR_INIT;
0007a2  f8db1000          LDR      r1,[r11,#0]
0007a6  f0210180          BIC      r1,r1,#0x80
0007aa  f8cb1000          STR      r1,[r11,#0]
;;;852    		rtc_Lock();
0007ae  f7fffffe          BL       rtc_Lock
;;;853    
;;;854    	
;;;855    		rtc_Get(&DT1);
0007b2  4840              LDR      r0,|L12.2228|
0007b4  f7fffffe          BL       rtc_Get
0007b8  f8dfb0f8          LDR      r11,|L12.2228|
;;;856    //			while (TempReg!=RTC->DR)
;;;857    		while (((RxBuffer[10]-0x30)*10+(RxBuffer[11]-0x30))!=DT1.Day)
0007bc  e035              B        |L12.2090|
                  |L12.1982|
0007be  2074              MOVS     r0,#0x74              ;689
0007c0  70b8              STRB     r0,[r7,#2]            ;689
0007c2  205f              MOVS     r0,#0x5f              ;690
0007c4  70f8              STRB     r0,[r7,#3]            ;690
0007c6  7139              STRB     r1,[r7,#4]            ;691
0007c8  216f              MOVS     r1,#0x6f              ;692
0007ca  7179              STRB     r1,[r7,#5]            ;692
0007cc  71ba              STRB     r2,[r7,#6]            ;693
0007ce  71fb              STRB     r3,[r7,#7]            ;694
0007d0  7238              STRB     r0,[r7,#8]            ;695
0007d2  7279              STRB     r1,[r7,#9]            ;696
0007d4  206b              MOVS     r0,#0x6b              ;697
0007d6  e683              B        |L12.1248|
                  |L12.2008|
0007d8  2001              MOVS     r0,#1                 ;720
0007da  e690              B        |L12.1278|
                  |L12.2012|
0007dc  2101              MOVS     r1,#1                 ;720
0007de  e692              B        |L12.1286|
                  |L12.2016|
0007e0  2101              MOVS     r1,#1                 ;720
0007e2  e695              B        |L12.1296|
                  |L12.2020|
0007e4  2101              MOVS     r1,#1                 ;720
0007e6  e698              B        |L12.1306|
                  |L12.2024|
0007e8  2001              MOVS     r0,#1                 ;745
0007ea  e6cf              B        |L12.1420|
                  |L12.2028|
0007ec  2101              MOVS     r1,#1                 ;745
0007ee  e6d1              B        |L12.1428|
                  |L12.2032|
0007f0  2101              MOVS     r1,#1                 ;745
0007f2  e6d4              B        |L12.1438|
                  |L12.2036|
0007f4  2101              MOVS     r1,#1                 ;745
0007f6  e6d7              B        |L12.1448|
                  |L12.2040|
0007f8  2101              MOVS     r1,#1                 ;745
0007fa  e6da              B        |L12.1458|
                  |L12.2044|
0007fc  2101              MOVS     r1,#1                 ;745
0007fe  e6dd              B        |L12.1468|
                  |L12.2048|
000800  2101              MOVS     r1,#1                 ;745
000802  e6e2              B        |L12.1482|
                  |L12.2052|
000804  2001              MOVS     r0,#1                 ;775
000806  e71a              B        |L12.1598|
                  |L12.2056|
000808  2101              MOVS     r1,#1                 ;775
00080a  e71c              B        |L12.1606|
                  |L12.2060|
00080c  2101              MOVS     r1,#1                 ;775
00080e  e71f              B        |L12.1616|
                  |L12.2064|
000810  2101              MOVS     r1,#1                 ;775
000812  e722              B        |L12.1626|
                  |L12.2068|
000814  2101              MOVS     r1,#1                 ;775
000816  e725              B        |L12.1636|
                  |L12.2072|
000818  2101              MOVS     r1,#1                 ;775
00081a  e728              B        |L12.1646|
                  |L12.2076|
00081c  2101              MOVS     r1,#1                 ;775
00081e  e72b              B        |L12.1656|
                  |L12.2080|
000820  2101              MOVS     r1,#1                 ;775
000822  e72e              B        |L12.1666|
                  |L12.2084|
;;;858    				rtc_Get(&DT1);
000824  4823              LDR      r0,|L12.2228|
000826  f7fffffe          BL       rtc_Get
                  |L12.2090|
00082a  7ab0              LDRB     r0,[r6,#0xa]          ;857  ; RxBuffer
00082c  7af1              LDRB     r1,[r6,#0xb]          ;857  ; RxBuffer
00082e  3830              SUBS     r0,r0,#0x30           ;857
000830  eb000280          ADD      r2,r0,r0,LSL #2       ;857
000834  eb080042          ADD      r0,r8,r2,LSL #1       ;857
000838  4401              ADD      r1,r1,r0              ;857
00083a  f89b0002          LDRB     r0,[r11,#2]           ;857  ; DT1
00083e  4281              CMP      r1,r0                 ;857
000840  d1f0              BNE      |L12.2084|
;;;859    
;;;860    				
;;;861    			txsize=11;
000842  4915              LDR      r1,|L12.2200|
000844  200b              MOVS     r0,#0xb
000846  8008              STRH     r0,[r1,#0]
;;;862    			tekper=0;
000848  f8aa4000          STRH     r4,[r10,#0]
;;;863    			USART_SendData(USART2, 0x3A);
00084c  213a              MOVS     r1,#0x3a
00084e  4648              MOV      r0,r9
000850  f7fffffe          BL       USART_SendData
                  |L12.2132|
;;;864    			
;;;865    			// need restart
;;;866    		}
;;;867    		
;;;868    		// read
;;;869    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='e')&(RxBuffer[4]=='a')&(RxBuffer[5]=='d'))
000854  78b0              LDRB     r0,[r6,#2]  ; RxBuffer
000856  2872              CMP      r0,#0x72
000858  d07e              BEQ      |L12.2392|
00085a  2000              MOVS     r0,#0
                  |L12.2140|
00085c  78f1              LDRB     r1,[r6,#3]  ; RxBuffer
00085e  2965              CMP      r1,#0x65
000860  d07b              BEQ      |L12.2394|
000862  2100              MOVS     r1,#0
                  |L12.2148|
000864  4008              ANDS     r0,r0,r1
000866  7931              LDRB     r1,[r6,#4]  ; RxBuffer
000868  2961              CMP      r1,#0x61
00086a  d077              BEQ      |L12.2396|
00086c  2100              MOVS     r1,#0
                  |L12.2158|
00086e  4008              ANDS     r0,r0,r1
000870  490a              LDR      r1,|L12.2204|
000872  7949              LDRB     r1,[r1,#5]  ; RxBuffer
000874  2964              CMP      r1,#0x64
000876  d072              BEQ      |L12.2398|
000878  2100              MOVS     r1,#0
                  |L12.2170|
00087a  4208              TST      r0,r1
00087c  d070              BEQ      |L12.2400|
;;;870    		{
;;;871    			
;;;872    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
00087e  2200              MOVS     r2,#0
000880  f2405125          MOV      r1,#0x525
000884  4648              MOV      r0,r9
000886  f7fffffe          BL       USART_ITConfig
;;;873    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
00088a  2201              MOVS     r2,#1
00088c  e014              B        |L12.2232|
00088e  0000              DCW      0x0000
                  |L12.2192|
                          DCD      0x0800c000
                  |L12.2196|
                          DCD      rxsize
                  |L12.2200|
                          DCD      txsize
                  |L12.2204|
                          DCD      RxBuffer
                  |L12.2208|
                          DCD      0x40020c00
                  |L12.2212|
                          DCD      0x05fa0004
                  |L12.2216|
                          DCD      0xe000ed0c
                  |L12.2220|
                          DCD      0x4000280c
                  |L12.2224|
                          DCD      0x007f0107
                  |L12.2228|
                          DCD      ||.data||+0xc
                  |L12.2232|
0008b8  f2406126          MOV      r1,#0x626
0008bc  4648              MOV      r0,r9
0008be  f7fffffe          BL       USART_ITConfig
;;;874    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
0008c2  2201              MOVS     r2,#1
0008c4  2108              MOVS     r1,#8
0008c6  48b4              LDR      r0,|L12.2968|
0008c8  f7fffffe          BL       GPIO_WriteBit
;;;875    			
;;;876    			// test zapis for controlling time on fleshka
;;;877    			tmp=por;
0008cc  48b3              LDR      r0,|L12.2972|
;;;878    			TxBuffer[0]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
0008ce  f44f717a          MOV      r1,#0x3e8
;;;879    			tmp%=1000;
;;;880    			TxBuffer[1]=(uint8_t)(tmp/100)+(uint8_t)0x30;
;;;881    			tmp%=100;		
;;;882    			TxBuffer[2]=(uint8_t)(tmp/10)+(uint8_t)0x30;
;;;883    			tmp%=10;	
;;;884    			TxBuffer[3]=(uint8_t)(tmp)+(uint8_t)0x30;		
;;;885    				
;;;886    			TxBuffer[4]=0x20;	
;;;887    
;;;888    			// date
;;;889    			TxBuffer[5]=(uint8_t)(DT1.Year/10)+(uint8_t)0x30;	
0008d2  f8df82cc          LDR      r8,|L12.2976|
0008d6  8800              LDRH     r0,[r0,#0]            ;877  ; por
0008d8  fbb0f2f1          UDIV     r2,r0,r1              ;878
0008dc  f1020330          ADD      r3,r2,#0x30           ;878
0008e0  703b              STRB     r3,[r7,#0]            ;878
0008e2  fb010012          MLS      r0,r1,r2,r0           ;879
0008e6  2364              MOVS     r3,#0x64              ;880
0008e8  fbb0f2f3          UDIV     r2,r0,r3              ;880
0008ec  f1020630          ADD      r6,r2,#0x30           ;880
0008f0  fb030212          MLS      r2,r3,r2,r0           ;881
0008f4  707e              STRB     r6,[r7,#1]            ;880
0008f6  200a              MOVS     r0,#0xa               ;882
0008f8  fbb2f6f0          UDIV     r6,r2,r0              ;882
0008fc  fb002216          MLS      r2,r0,r6,r2           ;883
000900  f1060c30          ADD      r12,r6,#0x30          ;882
000904  f887c002          STRB     r12,[r7,#2]           ;882
000908  3230              ADDS     r2,r2,#0x30           ;884
00090a  70fa              STRB     r2,[r7,#3]            ;884
00090c  2220              MOVS     r2,#0x20              ;886
00090e  713a              STRB     r2,[r7,#4]            ;886
000910  f898c000          LDRB     r12,[r8,#0]  ; DT1
000914  fbbcfbf0          UDIV     r11,r12,r0
000918  f10b0630          ADD      r6,r11,#0x30
00091c  717e              STRB     r6,[r7,#5]
;;;890    			TxBuffer[6]=(uint8_t)(DT1.Year%10)+(uint8_t)0x30;	
00091e  fb00c61b          MLS      r6,r0,r11,r12
000922  3630              ADDS     r6,r6,#0x30
000924  71be              STRB     r6,[r7,#6]
;;;891    			TxBuffer[7]=(uint8_t)(DT1.Month/10)+(uint8_t)0x30;	
000926  f898c001          LDRB     r12,[r8,#1]  ; DT1
00092a  fbbcfbf0          UDIV     r11,r12,r0
00092e  f10b0630          ADD      r6,r11,#0x30
000932  71fe              STRB     r6,[r7,#7]
;;;892    			TxBuffer[8]=(uint8_t)(DT1.Month%10)+(uint8_t)0x30;	
000934  fb00c61b          MLS      r6,r0,r11,r12
000938  3630              ADDS     r6,r6,#0x30
00093a  723e              STRB     r6,[r7,#8]
;;;893    			TxBuffer[9]=(uint8_t)(DT1.Day/10)+(uint8_t)0x30;	
00093c  f8986002          LDRB     r6,[r8,#2]  ; DT1
000940  fbb6fbf0          UDIV     r11,r6,r0
;;;894    			TxBuffer[10]=(uint8_t)(DT1.Day%10)+(uint8_t)0x30;	
000944  fb00661b          MLS      r6,r0,r11,r6
000948  f10b0c30          ADD      r12,r11,#0x30         ;893
00094c  f887c009          STRB     r12,[r7,#9]           ;893
000950  3630              ADDS     r6,r6,#0x30
000952  72be              STRB     r6,[r7,#0xa]
;;;895    			TxBuffer[11]=0x20;				
000954  72fa              STRB     r2,[r7,#0xb]
;;;896    			
;;;897    			// time
;;;898    			TxBuffer[12]=(uint8_t)(DT1.Hours/10)+(uint8_t)0x30;	
000956  e004              B        |L12.2402|
                  |L12.2392|
000958  e0f0              B        |L12.2876|
                  |L12.2394|
00095a  e0f2              B        |L12.2882|
                  |L12.2396|
00095c  e0f3              B        |L12.2886|
                  |L12.2398|
00095e  e0f4              B        |L12.2890|
                  |L12.2400|
000960  e0a8              B        |L12.2740|
                  |L12.2402|
000962  f898c004          LDRB     r12,[r8,#4]  ; DT1
000966  fbbcfbf0          UDIV     r11,r12,r0
00096a  f10b0630          ADD      r6,r11,#0x30
00096e  733e              STRB     r6,[r7,#0xc]
;;;899    			TxBuffer[13]=(uint8_t)(DT1.Hours%10)+(uint8_t)0x30;			
000970  fb00c61b          MLS      r6,r0,r11,r12
000974  3630              ADDS     r6,r6,#0x30
000976  737e              STRB     r6,[r7,#0xd]
;;;900    			TxBuffer[14]=(uint8_t)(DT1.Minutes/10)+(uint8_t)0x30;	
000978  f898c005          LDRB     r12,[r8,#5]  ; DT1
00097c  fbbcfbf0          UDIV     r11,r12,r0
000980  f10b0630          ADD      r6,r11,#0x30
000984  73be              STRB     r6,[r7,#0xe]
;;;901    			TxBuffer[15]=(uint8_t)(DT1.Minutes%10)+(uint8_t)0x30;	
000986  fb00c61b          MLS      r6,r0,r11,r12
00098a  3630              ADDS     r6,r6,#0x30
00098c  73fe              STRB     r6,[r7,#0xf]
;;;902    			TxBuffer[16]=(uint8_t)(DT1.Seconds/10)+(uint8_t)0x30;	
00098e  f898c006          LDRB     r12,[r8,#6]  ; DT1
000992  fbbcf8f0          UDIV     r8,r12,r0
000996  f1080630          ADD      r6,r8,#0x30
00099a  743e              STRB     r6,[r7,#0x10]
;;;903    			TxBuffer[17]=(uint8_t)(DT1.Seconds%10)+(uint8_t)0x30;	
00099c  fb00c618          MLS      r6,r0,r8,r12
0009a0  3630              ADDS     r6,r6,#0x30
0009a2  747e              STRB     r6,[r7,#0x11]
;;;904    			TxBuffer[18]=0x20;
0009a4  74ba              STRB     r2,[r7,#0x12]
;;;905    			
;;;906    			// dat pribl
;;;907    			TxBuffer[19]=sost_pribl+0x30;
0009a6  782d              LDRB     r5,[r5,#0]  ; sost_pribl
0009a8  3530              ADDS     r5,r5,#0x30
0009aa  74fd              STRB     r5,[r7,#0x13]
;;;908    			TxBuffer[20]=0x20;
;;;909    			
;;;910    			
;;;911    			// zn from adc with calibr and averaging
;;;912    			tmp=ADC3ConvertedValue%10000;
0009ac  4d7d              LDR      r5,|L12.2980|
0009ae  753a              STRB     r2,[r7,#0x14]         ;908
0009b0  882d              LDRH     r5,[r5,#0]  ; ADC3ConvertedValue
0009b2  f2427610          MOV      r6,#0x2710
0009b6  fbb5fcf6          UDIV     r12,r5,r6
0009ba  fb06551c          MLS      r5,r6,r12,r5
;;;913    			TxBuffer[21]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
0009be  fbb5f6f1          UDIV     r6,r5,r1
0009c2  f1060c30          ADD      r12,r6,#0x30
;;;914    			tmp%=1000;
0009c6  fb015516          MLS      r5,r1,r6,r5
;;;915    			TxBuffer[22]=(uint8_t)(tmp/100)+(uint8_t)0x30;
0009ca  fbb5f6f3          UDIV     r6,r5,r3
0009ce  f887c015          STRB     r12,[r7,#0x15]        ;913
0009d2  f1060c30          ADD      r12,r6,#0x30
;;;916    			tmp%=100;		
0009d6  fb035516          MLS      r5,r3,r6,r5
;;;917    			TxBuffer[23]=(uint8_t)(tmp/10)+(uint8_t)0x30;
0009da  fbb5f6f0          UDIV     r6,r5,r0
0009de  f887c016          STRB     r12,[r7,#0x16]        ;915
;;;918    			tmp%=10;	
0009e2  fb005516          MLS      r5,r0,r6,r5
0009e6  f1060c30          ADD      r12,r6,#0x30          ;917
0009ea  f887c017          STRB     r12,[r7,#0x17]        ;917
;;;919    			TxBuffer[24]=(uint8_t)(tmp)+(uint8_t)0x30;
0009ee  3530              ADDS     r5,r5,#0x30
0009f0  763d              STRB     r5,[r7,#0x18]
;;;920    			TxBuffer[25]=0x20;		
;;;921    			
;;;922    			tmp=fz_average[0]%1000;
0009f2  4d6d              LDR      r5,|L12.2984|
0009f4  767a              STRB     r2,[r7,#0x19]         ;920
0009f6  882d              LDRH     r5,[r5,#0]  ; fz_average
0009f8  fbb5f6f1          UDIV     r6,r5,r1
0009fc  fb015516          MLS      r5,r1,r6,r5
;;;923    			TxBuffer[26]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
000a00  fbb5f6f1          UDIV     r6,r5,r1
000a04  f1060c30          ADD      r12,r6,#0x30
;;;924    			tmp%=1000;
000a08  fb015516          MLS      r5,r1,r6,r5
;;;925    			TxBuffer[27]=(uint8_t)(tmp/100)+(uint8_t)0x30;
000a0c  fbb5f6f3          UDIV     r6,r5,r3
000a10  f887c01a          STRB     r12,[r7,#0x1a]        ;923
000a14  f1060c30          ADD      r12,r6,#0x30
;;;926    			tmp%=100;		
000a18  fb035516          MLS      r5,r3,r6,r5
;;;927    			TxBuffer[28]=(uint8_t)(tmp/10)+(uint8_t)0x30;
000a1c  fbb5f6f0          UDIV     r6,r5,r0
000a20  f887c01b          STRB     r12,[r7,#0x1b]        ;925
;;;928    			tmp%=10;	
000a24  fb005516          MLS      r5,r0,r6,r5
000a28  f1060c30          ADD      r12,r6,#0x30          ;927
000a2c  f887c01c          STRB     r12,[r7,#0x1c]        ;927
;;;929    			TxBuffer[29]=(uint8_t)(tmp)+(uint8_t)0x30;		
000a30  3530              ADDS     r5,r5,#0x30
000a32  777d              STRB     r5,[r7,#0x1d]
;;;930    			TxBuffer[30]=0x20;
;;;931    			
;;;932    			tmp=max[0]%1000;
000a34  4d5d              LDR      r5,|L12.2988|
000a36  77ba              STRB     r2,[r7,#0x1e]         ;930
000a38  882d              LDRH     r5,[r5,#0]  ; max
000a3a  fbb5f6f1          UDIV     r6,r5,r1
000a3e  fb015516          MLS      r5,r1,r6,r5
;;;933    			TxBuffer[31]=(uint8_t)(tmp/1000)+(uint8_t)0x30;
000a42  fbb5f6f1          UDIV     r6,r5,r1
;;;934    			tmp%=1000;
000a46  fb015116          MLS      r1,r1,r6,r5
;;;935    			TxBuffer[32]=(uint8_t)(tmp/100)+(uint8_t)0x30;
000a4a  fbb1f5f3          UDIV     r5,r1,r3
;;;936    			tmp%=100;		
000a4e  fb031115          MLS      r1,r3,r5,r1
;;;937    			TxBuffer[33]=(uint8_t)(tmp/10)+(uint8_t)0x30;
000a52  fbb1f3f0          UDIV     r3,r1,r0
000a56  f1060c30          ADD      r12,r6,#0x30          ;933
000a5a  f1050630          ADD      r6,r5,#0x30           ;935
000a5e  f887c01f          STRB     r12,[r7,#0x1f]        ;933
;;;938    			tmp%=10;	
000a62  fb001013          MLS      r0,r0,r3,r1
000a66  f8876020          STRB     r6,[r7,#0x20]         ;935
000a6a  f1030530          ADD      r5,r3,#0x30           ;937
000a6e  f8875021          STRB     r5,[r7,#0x21]         ;937
;;;939    			TxBuffer[34]=(uint8_t)(tmp)+(uint8_t)0x30;		
000a72  3030              ADDS     r0,r0,#0x30
000a74  f8870022          STRB     r0,[r7,#0x22]
;;;940    
;;;941    			TxBuffer[35]=0x20;
;;;942    			TxBuffer[36]=(uint8_t)(avariya)+(uint8_t)0x30;	
000a78  484d              LDR      r0,|L12.2992|
000a7a  f8872023          STRB     r2,[r7,#0x23]         ;941
;;;943    
;;;944    			TxBuffer[37]=0x20;
;;;945    			TxBuffer[38]=(uint8_t)(sost_flesh)+(uint8_t)0x30;
;;;946    			
;;;947    			TxBuffer[39]=0x20;
;;;948    			TxBuffer[40]=(uint8_t)(conf.tek_gr_kal)+(uint8_t)0x30;
;;;949    		/*
;;;950         + need:
;;;951    			1 avariya   
;;;952    			2 zapis norm or error  
;;;953    			3 tek gr kal
;;;954    */
;;;955    			txsize=41;
000a7e  2129              MOVS     r1,#0x29
000a80  7800              LDRB     r0,[r0,#0]            ;942  ; avariya
000a82  3030              ADDS     r0,r0,#0x30           ;942
000a84  f8870024          STRB     r0,[r7,#0x24]         ;942
000a88  484a              LDR      r0,|L12.2996|
000a8a  f8872025          STRB     r2,[r7,#0x25]         ;944
000a8e  7800              LDRB     r0,[r0,#0]            ;945  ; sost_flesh
000a90  3030              ADDS     r0,r0,#0x30           ;945
000a92  f8870026          STRB     r0,[r7,#0x26]         ;945
000a96  4848              LDR      r0,|L12.3000|
000a98  f8872027          STRB     r2,[r7,#0x27]         ;947
000a9c  78c0              LDRB     r0,[r0,#3]            ;948  ; conf
000a9e  3030              ADDS     r0,r0,#0x30           ;948
000aa0  f8870028          STRB     r0,[r7,#0x28]         ;948
000aa4  4845              LDR      r0,|L12.3004|
000aa6  8001              STRH     r1,[r0,#0]
;;;956    			tekper=0;
000aa8  f8aa4000          STRH     r4,[r10,#0]
;;;957    			USART_SendData(USART2, 0x3A);
000aac  213a              MOVS     r1,#0x3a
000aae  4648              MOV      r0,r9
000ab0  f7fffffe          BL       USART_SendData
                  |L12.2740|
;;;958    		}		
;;;959    		
;;;960    		// read_conf
;;;961    		if ((RxBuffer[2]=='r')&(RxBuffer[3]=='d')&(RxBuffer[4]=='_')&(RxBuffer[5]=='c')&(RxBuffer[6]=='o')&(RxBuffer[7]=='n')&(RxBuffer[8]=='f'))
000ab4  4a42              LDR      r2,|L12.3008|
000ab6  7890              LDRB     r0,[r2,#2]  ; RxBuffer
000ab8  2872              CMP      r0,#0x72
000aba  d048              BEQ      |L12.2894|
000abc  2000              MOVS     r0,#0
                  |L12.2750|
000abe  78d1              LDRB     r1,[r2,#3]  ; RxBuffer
000ac0  2964              CMP      r1,#0x64
000ac2  d046              BEQ      |L12.2898|
000ac4  2100              MOVS     r1,#0
                  |L12.2758|
000ac6  4008              ANDS     r0,r0,r1
000ac8  7911              LDRB     r1,[r2,#4]  ; RxBuffer
000aca  295f              CMP      r1,#0x5f
000acc  d043              BEQ      |L12.2902|
000ace  2100              MOVS     r1,#0
                  |L12.2768|
000ad0  4008              ANDS     r0,r0,r1
000ad2  7951              LDRB     r1,[r2,#5]  ; RxBuffer
000ad4  2963              CMP      r1,#0x63
000ad6  d040              BEQ      |L12.2906|
000ad8  2100              MOVS     r1,#0
                  |L12.2778|
000ada  4008              ANDS     r0,r0,r1
000adc  7991              LDRB     r1,[r2,#6]  ; RxBuffer
000ade  296f              CMP      r1,#0x6f
000ae0  d03d              BEQ      |L12.2910|
000ae2  2100              MOVS     r1,#0
                  |L12.2788|
000ae4  4008              ANDS     r0,r0,r1
000ae6  79d1              LDRB     r1,[r2,#7]  ; RxBuffer
000ae8  296e              CMP      r1,#0x6e
000aea  d03a              BEQ      |L12.2914|
000aec  2100              MOVS     r1,#0
                  |L12.2798|
000aee  4008              ANDS     r0,r0,r1
000af0  7a11              LDRB     r1,[r2,#8]  ; RxBuffer
000af2  2966              CMP      r1,#0x66
000af4  d037              BEQ      |L12.2918|
000af6  2100              MOVS     r1,#0
                  |L12.2808|
000af8  4208              TST      r0,r1
000afa  d049              BEQ      |L12.2960|
;;;962    		{
;;;963    			u16 i=0;
000afc  2500              MOVS     r5,#0
;;;964    			extern st_conf conf;		
;;;965    			
;;;966    			USART_ITConfig(USART2, USART_IT_RXNE, DISABLE);		
000afe  462a              MOV      r2,r5
000b00  f2405125          MOV      r1,#0x525
000b04  464e              MOV      r6,r9
000b06  4648              MOV      r0,r9
000b08  f7fffffe          BL       USART_ITConfig
;;;967    			USART_ITConfig(USART2, USART_IT_TC, ENABLE);
000b0c  2201              MOVS     r2,#1
000b0e  f2406126          MOV      r1,#0x626
000b12  4630              MOV      r0,r6
000b14  f7fffffe          BL       USART_ITConfig
;;;968    			GPIO_WriteBit(GPIOD, rx_pin_en, Bit_SET); 
000b18  2201              MOVS     r2,#1
000b1a  2108              MOVS     r1,#8
000b1c  481e              LDR      r0,|L12.2968|
000b1e  f7fffffe          BL       GPIO_WriteBit
;;;969    /*
;;;970    		u8 address;
;;;971    		u8 ver_po_st;
;;;972    		u8 ver_po_ml;
;;;973    	  u8 tek_gr_kal; 
;;;974    	  u8 tm_antidreb;
;;;975    		u8 revers_group_select;
;;;976    		u8 revers_peredacha_select;
;;;977    		u8 rez8;
;;;978    	
;;;979    		u16	per_usr;
;;;980    		u16	time_max;
;;;981    		u16 por_rele;
;;;982    		u16 tm_rele_on;
;;;983    		u16 tm_rele_off;
;;;984    		u16 rez16;
;;;985    	*/	
;;;986    /*
;;;987    			conf.address=1;
;;;988    			conf.ver_po_st=2;
;;;989    			conf.ver_po_ml=3;
;;;990    			conf.tek_gr_kal=4;
;;;991    			conf.tm_antidreb=5;
;;;992    			conf.revers_group_select=6;
;;;993    			conf.revers_peredacha_select=7;
;;;994    			conf.rez8=8;
;;;995    			conf.per_usr=9;
;;;996    			conf.time_max=10;
;;;997    			conf.por_rele=11;
;;;998    			conf.tm_rele_on=12;
;;;999    			conf.tm_rele_off=13;
;;;1000   			conf.rez16=14;
;;;1001   			
;;;1002   		conf.lin.kol_st=15;
;;;1003   		conf.lin.max1=16;	
;;;1004   		conf.lin.max2=17;
;;;1005   		conf.lin.max3=18;
;;;1006   		conf.lin.max4=19;
;;;1007   		*/
;;;1008   			/*
;;;1009   			conf.indicators[0].numb=15;
;;;1010   			conf.indicators[0].kol_cifr=16;
;;;1011   			conf.indicators[0].type_ind=17;
;;;1012   			conf.indicators[0].yark=18;
;;;1013   			conf.indicators[0].rez_viv=19;
;;;1014   			conf.indicators[0].pol_zap=20;
;;;1015   			conf.indicators[0].r1=21;
;;;1016   			conf.indicators[0].r2=22;
;;;1017   			conf.indicators[0].chislo=23;
;;;1018   			conf.indicators[0].porog=24;
;;;1019   
;;;1020   			conf.indicators[1].numb=25;
;;;1021   			conf.indicators[1].kol_cifr=26;
;;;1022   			conf.indicators[1].type_ind=27;
;;;1023   			conf.indicators[1].yark=28;
;;;1024   			conf.indicators[1].rez_viv=29;
;;;1025   			conf.indicators[1].pol_zap=30;
;;;1026   			conf.indicators[1].r1=31;
;;;1027   			conf.indicators[1].r2=32;
;;;1028   			conf.indicators[1].chislo=33;
;;;1029   			conf.indicators[1].porog=34;
;;;1030   		
;;;1031   
;;;1032   		
;;;1033   
;;;1034   		
;;;1035   			conf.indicators[2].numb=35;
;;;1036   			conf.indicators[2].kol_cifr=36;
;;;1037   			conf.indicators[2].type_ind=37;
;;;1038   			conf.indicators[2].yark=38;
;;;1039   			conf.indicators[2].rez_viv=39;
;;;1040   			conf.indicators[2].pol_zap=40;
;;;1041   			conf.indicators[2].r1=41;
;;;1042   			conf.indicators[2].r2=42;
;;;1043   			conf.indicators[2].chislo=43;
;;;1044   			conf.indicators[2].porog=44;
;;;1045   			
;;;1046   			conf.indicators[3].numb=45;
;;;1047   			conf.indicators[3].kol_cifr=46;
;;;1048   			conf.indicators[3].type_ind=47;
;;;1049   			conf.indicators[3].yark=48;
;;;1050   			conf.indicators[3].rez_viv=49;
;;;1051   			conf.indicators[3].pol_zap=50;
;;;1052   			conf.indicators[3].r1=51;
;;;1053   			conf.indicators[3].r2=52;
;;;1054   			conf.indicators[3].chislo=53;
;;;1055   			conf.indicators[3].porog=54;
;;;1056   				*/
;;;1057   		/*		
;;;1058   			conf.gr_kal1.tabl1.fz[0]=55;
;;;1059   			conf.gr_kal1.tabl1.fz[1]=56;
;;;1060   			conf.gr_kal1.tabl1.fz[2]=57;
;;;1061   			conf.gr_kal1.tabl1.fz[3]=58;
;;;1062   			conf.gr_kal1.tabl1.fz[4]=59;
;;;1063   			conf.gr_kal1.tabl1.fz[5]=60;
;;;1064   			conf.gr_kal1.tabl1.fz[6]=61;
;;;1065   			conf.gr_kal1.tabl1.fz[7]=62;
;;;1066   			conf.gr_kal1.tabl1.fz[8]=63;
;;;1067   			conf.gr_kal1.tabl1.fz[9]=64;
;;;1068   
;;;1069   			conf.gr_kal1.tabl1.kod[0]=65;
;;;1070   			conf.gr_kal1.tabl1.kod[1]=66;
;;;1071   			conf.gr_kal1.tabl1.kod[2]=67;
;;;1072   			conf.gr_kal1.tabl1.kod[3]=68;
;;;1073   			conf.gr_kal1.tabl1.kod[4]=69;
;;;1074   			conf.gr_kal1.tabl1.kod[5]=70;
;;;1075   			conf.gr_kal1.tabl1.kod[6]=71;
;;;1076   			conf.gr_kal1.tabl1.kod[7]=72;
;;;1077   			conf.gr_kal1.tabl1.kod[8]=73;
;;;1078   			conf.gr_kal1.tabl1.kod[9]=74;
;;;1079   	
;;;1080   			conf.gr_kal1.tabl2.fz[0]=75;
;;;1081   			conf.gr_kal1.tabl2.fz[1]=76;
;;;1082   			conf.gr_kal1.tabl2.fz[2]=77;
;;;1083   			conf.gr_kal1.tabl2.fz[3]=78;
;;;1084   			conf.gr_kal1.tabl2.fz[4]=79;
;;;1085   			conf.gr_kal1.tabl2.fz[5]=80;
;;;1086   			conf.gr_kal1.tabl2.fz[6]=81;
;;;1087   			conf.gr_kal1.tabl2.fz[7]=82;
;;;1088   			conf.gr_kal1.tabl2.fz[8]=83;
;;;1089   			conf.gr_kal1.tabl2.fz[9]=84;
;;;1090   
;;;1091   			conf.gr_kal1.tabl2.kod[0]=85;
;;;1092   			conf.gr_kal1.tabl2.kod[1]=86;
;;;1093   			conf.gr_kal1.tabl2.kod[2]=87;
;;;1094   			conf.gr_kal1.tabl2.kod[3]=88;
;;;1095   			conf.gr_kal1.tabl2.kod[4]=89;
;;;1096   			conf.gr_kal1.tabl2.kod[5]=90;
;;;1097   			conf.gr_kal1.tabl2.kod[6]=91;
;;;1098   			conf.gr_kal1.tabl2.kod[7]=92;
;;;1099   			conf.gr_kal1.tabl2.kod[8]=93;
;;;1100   			conf.gr_kal1.tabl2.kod[9]=94;	
;;;1101   			
;;;1102   			// dr2
;;;1103   			conf.gr_kal2.tabl1.fz[0]=95;
;;;1104   			conf.gr_kal2.tabl1.fz[1]=96;
;;;1105   			conf.gr_kal2.tabl1.fz[2]=97;
;;;1106   			conf.gr_kal2.tabl1.fz[3]=98;
;;;1107   			conf.gr_kal2.tabl1.fz[4]=99;
;;;1108   			conf.gr_kal2.tabl1.fz[5]=100;
;;;1109   			conf.gr_kal2.tabl1.fz[6]=101;
;;;1110   			conf.gr_kal2.tabl1.fz[7]=102;
;;;1111   			conf.gr_kal2.tabl1.fz[8]=103;
;;;1112   			conf.gr_kal2.tabl1.fz[9]=104;
;;;1113   
;;;1114   			conf.gr_kal2.tabl1.kod[0]=105;
;;;1115   			conf.gr_kal2.tabl1.kod[1]=106;
;;;1116   			conf.gr_kal2.tabl1.kod[2]=107;
;;;1117   			conf.gr_kal2.tabl1.kod[3]=108;
;;;1118   			conf.gr_kal2.tabl1.kod[4]=109;
;;;1119   			conf.gr_kal2.tabl1.kod[5]=100;
;;;1120   			conf.gr_kal2.tabl1.kod[6]=111;
;;;1121   			conf.gr_kal2.tabl1.kod[7]=112;
;;;1122   			conf.gr_kal2.tabl1.kod[8]=113;
;;;1123   			conf.gr_kal2.tabl1.kod[9]=114;
;;;1124   	
;;;1125   			conf.gr_kal2.tabl2.fz[0]=115;
;;;1126   			conf.gr_kal2.tabl2.fz[1]=116;
;;;1127   			conf.gr_kal2.tabl2.fz[2]=117;
;;;1128   			conf.gr_kal2.tabl2.fz[3]=118;
;;;1129   			conf.gr_kal2.tabl2.fz[4]=119;
;;;1130   			conf.gr_kal2.tabl2.fz[5]=120;
;;;1131   			conf.gr_kal2.tabl2.fz[6]=121;
;;;1132   			conf.gr_kal2.tabl2.fz[7]=122;
;;;1133   			conf.gr_kal2.tabl2.fz[8]=123;
;;;1134   			conf.gr_kal2.tabl2.fz[9]=124;
;;;1135   
;;;1136   			conf.gr_kal2.tabl2.kod[0]=125;
;;;1137   			conf.gr_kal2.tabl2.kod[1]=126;
;;;1138   			conf.gr_kal2.tabl2.kod[2]=127;
;;;1139   			conf.gr_kal2.tabl2.kod[3]=128;
;;;1140   			conf.gr_kal2.tabl2.kod[4]=129;
;;;1141   			conf.gr_kal2.tabl2.kod[5]=130;
;;;1142   			conf.gr_kal2.tabl2.kod[6]=131;
;;;1143   			conf.gr_kal2.tabl2.kod[7]=132;
;;;1144   			conf.gr_kal2.tabl2.kod[8]=133;
;;;1145   			conf.gr_kal2.tabl2.kod[9]=134;	
;;;1146   */		
;;;1147   		/*
;;;1148   			txsize=sizeof(st_conf)<<1;
;;;1149   	
;;;1150   			for (i = 0; i < (txsize); i += 1)
;;;1151   			{
;;;1152   				u16 tmp=0;
;;;1153   	//			TxBuffer[i]=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1154   				tmp=(*(__IO uint8_t *) ((__IO uint8_t *) (&conf) + i));
;;;1155   				TxBuffer[i<<1]=(tmp>>8)+0x30;
;;;1156   				TxBuffer[(i<<1)+1]=tmp+0x30;
;;;1157   			}	
;;;1158   */
;;;1159   
;;;1160   			txsize=sizeof(st_conf);  // dl = 228
000b22  4826              LDR      r0,|L12.3004|
000b24  23be              MOVS     r3,#0xbe
000b26  8003              STRH     r3,[r0,#0]
000b28  4826              LDR      r0,|L12.3012|
                  |L12.2858|
;;;1161   	
;;;1162   			for (i = 0; i < (txsize); i += 1)
;;;1163   			{
;;;1164   				TxBuffer[i]=(*(__IO uint8_t *) (BKPSRAM_BASE + i));
000b2a  5c29              LDRB     r1,[r5,r0]
000b2c  5579              STRB     r1,[r7,r5]
000b2e  1c6d              ADDS     r5,r5,#1              ;1162
000b30  b2ad              UXTH     r5,r5                 ;1162
000b32  429d              CMP      r5,r3                 ;1162
000b34  d3f9              BCC      |L12.2858|
;;;1165   			}	
;;;1166   	
;;;1167   			for (i = 0; i < (txsize); i += 4)
000b36  2000              MOVS     r0,#0
000b38  4d23              LDR      r5,|L12.3016|
000b3a  e021              B        |L12.2944|
                  |L12.2876|
000b3c  2001              MOVS     r0,#1                 ;869
000b3e  e68d              B        |L12.2140|
                  |L12.2880|
000b40  e028              B        |L12.2964|
                  |L12.2882|
000b42  2101              MOVS     r1,#1                 ;869
000b44  e68e              B        |L12.2148|
                  |L12.2886|
000b46  2101              MOVS     r1,#1                 ;869
000b48  e691              B        |L12.2158|
                  |L12.2890|
000b4a  2101              MOVS     r1,#1                 ;869
000b4c  e695              B        |L12.2170|
                  |L12.2894|
000b4e  2001              MOVS     r0,#1                 ;961
000b50  e7b5              B        |L12.2750|
                  |L12.2898|
000b52  2101              MOVS     r1,#1                 ;961
000b54  e7b7              B        |L12.2758|
                  |L12.2902|
000b56  2101              MOVS     r1,#1                 ;961
000b58  e7ba              B        |L12.2768|
                  |L12.2906|
000b5a  2101              MOVS     r1,#1                 ;961
000b5c  e7bd              B        |L12.2778|
                  |L12.2910|
000b5e  2101              MOVS     r1,#1                 ;961
000b60  e7c0              B        |L12.2788|
                  |L12.2914|
000b62  2101              MOVS     r1,#1                 ;961
000b64  e7c3              B        |L12.2798|
                  |L12.2918|
000b66  2101              MOVS     r1,#1                 ;961
000b68  e7c6              B        |L12.2808|
                  |L12.2922|
;;;1168   			{
;;;1169   				uint32_t data;				
;;;1170   				data= *(__IO uint32_t*) (ADDR_FLASH+i);
000b6a  5941              LDR      r1,[r0,r5]
;;;1171   				
;;;1172   				
;;;1173   				TxBuffer[i]=(u8) (data>>24);
000b6c  0e0a              LSRS     r2,r1,#24
000b6e  543a              STRB     r2,[r7,r0]
;;;1174   				TxBuffer[i+1]=(u8) (data>>16);
000b70  183a              ADDS     r2,r7,r0
000b72  0c0e              LSRS     r6,r1,#16
000b74  7056              STRB     r6,[r2,#1]
;;;1175   				TxBuffer[i+2]=(u8) (data>>8);
000b76  0a0e              LSRS     r6,r1,#8
000b78  7096              STRB     r6,[r2,#2]
000b7a  1d00              ADDS     r0,r0,#4              ;1167
;;;1176   				TxBuffer[i+3]=(u8) data;
000b7c  70d1              STRB     r1,[r2,#3]
000b7e  b280              UXTH     r0,r0                 ;1167
                  |L12.2944|
000b80  4298              CMP      r0,r3                 ;1167
000b82  d3f2              BCC      |L12.2922|
;;;1177   			}	
;;;1178   
;;;1179   //}
;;;1180   
;;;1181   			tekper=0;
000b84  f8aa4000          STRH     r4,[r10,#0]
;;;1182   			USART_SendData(USART2, 0x3A);
000b88  213a              MOVS     r1,#0x3a
000b8a  4648              MOV      r0,r9
000b8c  f7fffffe          BL       USART_SendData
                  |L12.2960|
;;;1183   		}		
;;;1184   		
;;;1185   		new_komand=0;
000b90  480e              LDR      r0,|L12.3020|
000b92  7004              STRB     r4,[r0,#0]
                  |L12.2964|
;;;1186   	}
;;;1187   	
;;;1188   
;;;1189   	
;;;1190   				//	indicators[0].chislo=1234;
;;;1191   		//		indicators[1].chislo=1234;
;;;1192   		//		indicate (0);
;;;1193   		//		indicate (1);
;;;1194   				
;;;1195   }
000b94  e8bd9ff0          POP      {r4-r12,pc}
;;;1196   
                          ENDP

                  |L12.2968|
                          DCD      0x40020c00
                  |L12.2972|
                          DCD      por
                  |L12.2976|
                          DCD      ||.data||+0xc
                  |L12.2980|
                          DCD      ADC3ConvertedValue
                  |L12.2984|
                          DCD      fz_average
                  |L12.2988|
                          DCD      max
                  |L12.2992|
                          DCD      avariya
                  |L12.2996|
                          DCD      sost_flesh
                  |L12.3000|
                          DCD      conf
                  |L12.3004|
                          DCD      txsize
                  |L12.3008|
                          DCD      RxBuffer
                  |L12.3012|
                          DCD      0x40024000
                  |L12.3016|
                          DCD      0x0800c000
                  |L12.3020|
                          DCD      new_komand

                          AREA ||i.TIM2_IRQHandler||, CODE, READONLY, ALIGN=1

                  TIM2_IRQHandler PROC
;;;1329     */
;;;1330   void TIM2_IRQHandler(void)
000000  f7ffbffe          B.W      USB_OTG_BSP_TimerIRQ
;;;1331   {
;;;1332     USB_OTG_BSP_TimerIRQ();
;;;1333   }
;;;1334   
                          ENDP


                          AREA ||i.TIM4_IRQHandler||, CODE, READONLY, ALIGN=2

                  TIM4_IRQHandler PROC
;;;1235     */
;;;1236   void TIM4_IRQHandler(void)
000000  b510              PUSH     {r4,lr}
;;;1237   {
;;;1238      uint8_t clickreg = 0;
;;;1239   
;;;1240   	
;;;1241     /* Checks whether the TIM interrupt has occurred */
;;;1242     if (TIM_GetITStatus(TIM4, TIM_IT_CC1) != RESET)
000002  4c0d              LDR      r4,|L14.56|
000004  2102              MOVS     r1,#2
000006  4620              MOV      r0,r4
000008  f7fffffe          BL       TIM_GetITStatus
00000c  2800              CMP      r0,#0
00000e  d011              BEQ      |L14.52|
;;;1243     {
;;;1244       TIM_ClearITPendingBit(TIM4, TIM_IT_CC1);
000010  2102              MOVS     r1,#2
000012  4620              MOV      r0,r4
000014  f7fffffe          BL       TIM_ClearITPendingBit
;;;1245   		/*
;;;1246       if( LED_Toggle == 3)
;;;1247       {
;;;1248         // LED3 Orange toggling 
;;;1249         STM_EVAL_LEDToggle(LED3);
;;;1250         STM_EVAL_LEDOff(LED6);
;;;1251         STM_EVAL_LEDOff(LED4);
;;;1252       }
;;;1253       else if( LED_Toggle == 4)
;;;1254       {
;;;1255         // LED4 Green toggling 
;;;1256         STM_EVAL_LEDToggle(LED4);
;;;1257         STM_EVAL_LEDOff(LED6);
;;;1258         STM_EVAL_LEDOff(LED3);
;;;1259       }
;;;1260       else if( LED_Toggle == 6)
;;;1261       {
;;;1262         // LED6 Blue toggling 
;;;1263         STM_EVAL_LEDOff(LED3);
;;;1264         STM_EVAL_LEDOff(LED4);
;;;1265         STM_EVAL_LEDToggle(LED6);
;;;1266       }
;;;1267       else if (LED_Toggle ==0)
;;;1268       {
;;;1269         // LED6 Blue On to signal Pause 
;;;1270         STM_EVAL_LEDOn(LED6);
;;;1271       }
;;;1272       else if (LED_Toggle == 7)
;;;1273       {
;;;1274         // LED4 toggling with frequency = 439.4 Hz 
;;;1275         STM_EVAL_LEDOff(LED3);
;;;1276         STM_EVAL_LEDOff(LED4);
;;;1277         STM_EVAL_LEDOff(LED5);
;;;1278         STM_EVAL_LEDOff(LED6);
;;;1279       }
;;;1280   		*/
;;;1281   	
;;;1282   
;;;1283       capture = TIM_GetCapture1(TIM4);
000018  4620              MOV      r0,r4
00001a  f7fffffe          BL       TIM_GetCapture1
00001e  b281              UXTH     r1,r0
000020  4806              LDR      r0,|L14.60|
000022  8141              STRH     r1,[r0,#0xa]
;;;1284       TIM_SetCompare1(TIM4, capture + CCR_Val);
000024  4806              LDR      r0,|L14.64|
000026  8800              LDRH     r0,[r0,#0]  ; CCR_Val
000028  4401              ADD      r1,r1,r0
00002a  4620              MOV      r0,r4
00002c  e8bd4010          POP      {r4,lr}
000030  f7ffbffe          B.W      TIM_SetCompare1
                  |L14.52|
;;;1285     }
;;;1286   }
000034  bd10              POP      {r4,pc}
;;;1287   
                          ENDP

000036  0000              DCW      0x0000
                  |L14.56|
                          DCD      0x40000800
                  |L14.60|
                          DCD      ||.data||
                  |L14.64|
                          DCD      CCR_Val

                          AREA ||i.UsageFault_Handler||, CODE, READONLY, ALIGN=1

                  UsageFault_Handler PROC
                  |L15.0|
;;;213      */
;;;214    void UsageFault_Handler(void)
000000  e7fe              B        |L15.0|
;;;215    {
;;;216      /* Go to infinite loop when Usage Fault exception occurs */
;;;217      while (1)
;;;218      {
;;;219      }
;;;220    }
;;;221    
                          ENDP


                          AREA ||i.fiz_vel||, CODE, READONLY, ALIGN=2

                  fiz_vel PROC
;;;248    
;;;249    u16 fiz_vel(u16 kod, st_tab_kal* tk)
000000  b570              PUSH     {r4-r6,lr}
;;;250    {
;;;251    	u8 i=0, nul=0;
;;;252    	st_tab_kal *tab = tk;
;;;253    //	tab_kal
;;;254    	/*
;;;255    	    
;;;256           
;;;257                    
;;;258                    if kod[1:]==[0,0,0,0,0,0,0,0,0]:
;;;259                        print 'no tabl' 
;;;260                        return kodadc
;;;261                        
;;;262                    if kodadc<kod[0]:
;;;263                        return fz[0]
;;;264                    
;;;265                    for i in range(1,10):
;;;266                        
;;;267                        if kodadc<kod[i]:
;;;268                            if i==0:
;;;269                                print 'i=0',fz[0]
;;;270                                return fz[0]
;;;271                            else:
;;;272                                if kod[i]==0:
;;;273                                    print 'kod=0',fz[i-1]
;;;274                                    return fz[i-1]
;;;275                                else:
;;;276                                    print 'norm',
;;;277                                    return (fz[i]-fz[i-1])*(kodadc-kod[i-1])/(kod[i]-kod[i-1])+fz[i-1]
;;;278                                    
;;;279                        if  kod[i-1]>0 and kod[i]==0:
;;;280                            return fz[i-1]
;;;281                    
;;;282                    return fz[9]
;;;283    
;;;284    	*/
;;;285    	
;;;286    	
;;;287    	/*	
;;;288    	conf.gr_kal1.tabl1.fz[0]
;;;289    	conf.gr_kal1.tabl1.kod[0]=65;
;;;290      conf.tek_gr_kal=4;
;;;291      sost_pribl	
;;;292    	tk
;;;293    	*/
;;;294    		tk_null=0;
000002  4c24              LDR      r4,|L16.148|
000004  2300              MOVS     r3,#0                 ;251
;;;295    		for (i = 1; i < 10; i += 1)
000006  2201              MOVS     r2,#1
000008  7023              STRB     r3,[r4,#0]            ;294
                  |L16.10|
;;;296    			if (tk->kod[i]==0) 
00000a  f8315012          LDRH     r5,[r1,r2,LSL #1]
00000e  b90d              CBNZ     r5,|L16.20|
;;;297    					nul++;	
000010  1c5b              ADDS     r3,r3,#1
000012  b2db              UXTB     r3,r3
                  |L16.20|
000014  1c52              ADDS     r2,r2,#1              ;295
000016  b2d2              UXTB     r2,r2                 ;295
000018  2a0a              CMP      r2,#0xa               ;295
00001a  d3f6              BCC      |L16.10|
;;;298    	  if (nul==9)
00001c  2b09              CMP      r3,#9
00001e  d024              BEQ      |L16.106|
;;;299    		{		tk_null=1;
;;;300    				return kod; }
;;;301    		
;;;302    		if (kod<tk->kod[0])
000020  880a              LDRH     r2,[r1,#0]
000022  4282              CMP      r2,r0
000024  d824              BHI      |L16.112|
;;;303            return tk->fz[0];
;;;304    		
;;;305    		for (i = 1; i < 10; i += 1)	
000026  2201              MOVS     r2,#1
                  |L16.40|
;;;306    		{
;;;307    			float tmp=0;
;;;308    			if (kod<tk->kod[i]) {
000028  f8313012          LDRH     r3,[r1,r2,LSL #1]
00002c  4283              CMP      r3,r0
00002e  d921              BLS      |L16.116|
;;;309    					if (i==0)
000030  b1f2              CBZ      r2,|L16.112|
;;;310    							return tk->fz[0];
;;;311    					else  {
;;;312    							if (tk->kod[i]==0)
000032  041c              LSLS     r4,r3,#16
000034  0c24              LSRS     r4,r4,#16
000036  d029              BEQ      |L16.140|
;;;313    									return tk->fz[i-1];
;;;314    							else  {
;;;315    								  tmp=(tk->fz[i]-tk->fz[i-1])*(kod-tk->kod[i-1])/(tk->kod[i]-tk->kod[i-1])+tk->fz[i-1]+0.5;
000038  eb010142          ADD      r1,r1,r2,LSL #1
00003c  8a8c              LDRH     r4,[r1,#0x14]
00003e  8a4a              LDRH     r2,[r1,#0x12]
000040  f8311c02          LDRH     r1,[r1,#-2]
000044  1aa4              SUBS     r4,r4,r2
000046  1a40              SUBS     r0,r0,r1
000048  4344              MULS     r4,r0,r4
00004a  1a58              SUBS     r0,r3,r1
00004c  fb94f0f0          SDIV     r0,r4,r0
000050  4410              ADD      r0,r0,r2
000052  f7fffffe          BL       __aeabi_i2d
000056  2200              MOVS     r2,#0
000058  4b0f              LDR      r3,|L16.152|
00005a  f7fffffe          BL       __aeabi_dadd
00005e  f7fffffe          BL       __aeabi_d2f
;;;316    									return (u16) tmp;  } } }
000062  f7fffffe          BL       __aeabi_f2uiz
000066  b280              UXTH     r0,r0
;;;317    									
;;;318    			if  ((tk->kod[i-1]>0)&(tk->kod[i]==0))
;;;319    					return tk->fz[i-1];
;;;320      	}	
;;;321        
;;;322    		return tk->fz[9];		
;;;323    }
000068  bd70              POP      {r4-r6,pc}
                  |L16.106|
00006a  2101              MOVS     r1,#1                 ;299
00006c  7021              STRB     r1,[r4,#0]            ;299
00006e  bd70              POP      {r4-r6,pc}
                  |L16.112|
000070  8a88              LDRH     r0,[r1,#0x14]         ;310
000072  bd70              POP      {r4-r6,pc}
                  |L16.116|
000074  eb010442          ADD      r4,r1,r2,LSL #1       ;318
000078  f8344c02          LDRH     r4,[r4,#-2]           ;318
00007c  b104              CBZ      r4,|L16.128|
00007e  b12b              CBZ      r3,|L16.140|
                  |L16.128|
000080  1c52              ADDS     r2,r2,#1              ;305
000082  b2d2              UXTB     r2,r2                 ;305
000084  2a0a              CMP      r2,#0xa               ;305
000086  d3cf              BCC      |L16.40|
000088  8cc8              LDRH     r0,[r1,#0x26]         ;322
00008a  bd70              POP      {r4-r6,pc}
                  |L16.140|
00008c  eb010042          ADD      r0,r1,r2,LSL #1       ;319
000090  8a40              LDRH     r0,[r0,#0x12]         ;319
000092  bd70              POP      {r4-r6,pc}
;;;324    
                          ENDP

                  |L16.148|
                          DCD      ||.data||
                  |L16.152|
                          DCD      0x3fe00000

                          AREA ||i.moving_average||, CODE, READONLY, ALIGN=2

                  moving_average PROC
;;;325    
;;;326    u16 moving_average(u16 kod, u8 numb)
000000  b570              PUSH     {r4-r6,lr}
;;;327    {
;;;328    	extern u16 tek_kol;
;;;329    	extern u16 kol_usr;
;;;330    	extern u32 buf_sum;
;;;331    	u16 tmp=0;
;;;332    	
;;;333    	if (kol_usr==0)
000002  4916              LDR      r1,|L17.92|
000004  880a              LDRH     r2,[r1,#0]  ; kol_usr
000006  2a00              CMP      r2,#0                 ;327
000008  d018              BEQ      |L17.60|
;;;334    		return kod;
;;;335    
;;;336    	if (kol_usr==1)
00000a  2a01              CMP      r2,#1
00000c  d016              BEQ      |L17.60|
;;;337    		return kod;
;;;338    	
;;;339    	if (tek_kol<kol_usr)
00000e  4b14              LDR      r3,|L17.96|
;;;340    	{
;;;341    		buf_sum+=kod;
000010  4d14              LDR      r5,|L17.100|
;;;342    		tek_kol++;
;;;343    		return (u16)((buf_sum/tek_kol)+0.5);
000012  4e15              LDR      r6,|L17.104|
000014  8819              LDRH     r1,[r3,#0]            ;339  ; tek_kol
000016  682c              LDR      r4,[r5,#0]            ;341
000018  4291              CMP      r1,r2                 ;339
00001a  4404              ADD      r4,r4,r0              ;341
00001c  d20f              BCS      |L17.62|
00001e  1c49              ADDS     r1,r1,#1              ;342
000020  b288              UXTH     r0,r1                 ;342
000022  602c              STR      r4,[r5,#0]            ;342  ; buf_sum
000024  8018              STRH     r0,[r3,#0]            ;342
000026  fbb4f0f0          UDIV     r0,r4,r0
00002a  f7fffffe          BL       __aeabi_ui2d
00002e  2200              MOVS     r2,#0
000030  4633              MOV      r3,r6
000032  f7fffffe          BL       __aeabi_dadd
000036  f7fffffe          BL       __aeabi_d2uiz
00003a  b280              UXTH     r0,r0
                  |L17.60|
;;;344    	}
;;;345    	else
;;;346    	{
;;;347    		buf_sum+=kod;
;;;348    		tmp=(u16) ((buf_sum/tek_kol)+0.5);
;;;349    		buf_sum-=tmp;
;;;350    		return  tmp;
;;;351    	}
;;;352    }
00003c  bd70              POP      {r4-r6,pc}
                  |L17.62|
00003e  fbb4f0f1          UDIV     r0,r4,r1              ;348
000042  f7fffffe          BL       __aeabi_ui2d
000046  2200              MOVS     r2,#0                 ;348
000048  4633              MOV      r3,r6                 ;348
00004a  f7fffffe          BL       __aeabi_dadd
00004e  f7fffffe          BL       __aeabi_d2uiz
000052  b280              UXTH     r0,r0                 ;348
000054  1a21              SUBS     r1,r4,r0              ;349
000056  6029              STR      r1,[r5,#0]            ;349  ; buf_sum
000058  bd70              POP      {r4-r6,pc}
;;;353    
                          ENDP

00005a  0000              DCW      0x0000
                  |L17.92|
                          DCD      kol_usr
                  |L17.96|
                          DCD      tek_kol
                  |L17.100|
                          DCD      buf_sum
                  |L17.104|
                          DCD      0x3fe00000

                          AREA ||i.test_rele||, CODE, READONLY, ALIGN=2

                  test_rele PROC
;;;353    
;;;354    u8 test_rele(u16 fz, u8 numb)
000000  b5f0              PUSH     {r4-r7,lr}
;;;355    {
;;;356    	extern st_conf conf;
;;;357    	
;;;358    	if (fz>conf.por_rele)
000002  4e13              LDR      r6,|L18.80|
;;;359    			kol_rele_on++;			
000004  4913              LDR      r1,|L18.84|
000006  89b2              LDRH     r2,[r6,#0xc]          ;358  ; conf
000008  4282              CMP      r2,r0                 ;358
00000a  d203              BCS      |L18.20|
00000c  8888              LDRH     r0,[r1,#4]  ; kol_rele_on
00000e  1c40              ADDS     r0,r0,#1
000010  8088              STRH     r0,[r1,#4]
000012  e002              B        |L18.26|
                  |L18.20|
;;;360    	else
;;;361    			kol_rele_off++;
000014  88c8              LDRH     r0,[r1,#6]  ; kol_rele_off
000016  1c40              ADDS     r0,r0,#1
000018  80c8              STRH     r0,[r1,#6]
                  |L18.26|
;;;362    		
;;;363    	if (kol_rele_on>=conf.tm_rele_on)
00001a  89f7              LDRH     r7,[r6,#0xe]  ; conf
00001c  f8b1c004          LDRH     r12,[r1,#4]  ; kol_rele_on
000020  2000              MOVS     r0,#0
;;;364    	{
;;;365    		kol_rele_on=0;
;;;366    		kol_rele_off=0;
;;;367    		avariya=1;
000022  4b0d              LDR      r3,|L18.88|
;;;368    		PORT_AVARIYA->BSRRL = PIN_AVARIYA;	// on PIN_AVARIYA		
000024  4a0d              LDR      r2,|L18.92|
;;;369    		PORT_RELE->BSRRL = PIN_RELE;	// on PIN_RELE		
000026  2510              MOVS     r5,#0x10
000028  f44f4400          MOV      r4,#0x8000            ;368
00002c  4567              CMP      r7,r12                ;363
00002e  d805              BHI      |L18.60|
000030  8088              STRH     r0,[r1,#4]            ;365
000032  80c8              STRH     r0,[r1,#6]            ;366
000034  2701              MOVS     r7,#1                 ;367
000036  701f              STRB     r7,[r3,#0]            ;367
000038  8314              STRH     r4,[r2,#0x18]         ;368
00003a  8315              STRH     r5,[r2,#0x18]
                  |L18.60|
;;;370    	}
;;;371    	
;;;372    	if (kol_rele_off>=conf.tm_rele_off)
00003c  8a36              LDRH     r6,[r6,#0x10]  ; conf
00003e  88cf              LDRH     r7,[r1,#6]  ; kol_rele_off
000040  42be              CMP      r6,r7
000042  d804              BHI      |L18.78|
;;;373    	{
;;;374    		kol_rele_on=0;
000044  8088              STRH     r0,[r1,#4]
;;;375    		kol_rele_off=0;
000046  80c8              STRH     r0,[r1,#6]
;;;376    		avariya=0;
000048  7018              STRB     r0,[r3,#0]
;;;377    		PORT_AVARIYA->BSRRH = PIN_AVARIYA;  	// off  PIN_AVARIYA
00004a  8354              STRH     r4,[r2,#0x1a]
;;;378    		PORT_RELE->BSRRH = PIN_RELE;  	// off  PIN_RELE		
00004c  8355              STRH     r5,[r2,#0x1a]
                  |L18.78|
;;;379    	}
;;;380    }
00004e  bdf0              POP      {r4-r7,pc}
;;;381    
                          ENDP

                  |L18.80|
                          DCD      conf
                  |L18.84|
                          DCD      ||.data||
                  |L18.88|
                          DCD      avariya
                  |L18.92|
                          DCD      0x40020000

                          AREA ||.data||, DATA, ALIGN=1

                  tk_null
000000  00                DCB      0x00
                  PauseResumeStatus
000001  02                DCB      0x02
                  Count
000002  0000              DCB      0x00,0x00
                  kol_rele_on
000004  0000              DCW      0x0000
                  kol_rele_off
000006  0000              DCW      0x0000
                  time_max
000008  0000              DCW      0x0000
                  capture
00000a  0000              DCW      0x0000
                  ||DT1||
                          DCDU     0x00000000
000010  000000            DCB      0x00,0x00,0x00

                          AREA ||area_number.22||, DATA, ALIGN=0

                          EXPORTAS ||area_number.22||, ||.data||
                  LED_Toggle
000000  00                DCB      0x00

                          AREA ||area_number.23||, DATA, ALIGN=1

                          EXPORTAS ||area_number.23||, ||.data||
                  Time_Rec_Base
000000  0000              DCW      0x0000

;*** Start embedded assembler ***

#line 1 "src\\stm32f4xx_it.c"
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_stm32f4xx_it_c_52b4fc9b____REV16|
#line 114 ".\\Libraries\\CMSIS\\core_cmInstr.h"
|__asm___14_stm32f4xx_it_c_52b4fc9b____REV16| PROC
#line 115

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.emb_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_stm32f4xx_it_c_52b4fc9b____REVSH|
#line 128
|__asm___14_stm32f4xx_it_c_52b4fc9b____REVSH| PROC
#line 129

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
